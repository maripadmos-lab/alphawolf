;/*FB_PKG_DELIM*/

__d("ArmadilloCutoverClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("699"),s=o("FalcoLoggerInternal").create("armadillo_cutover_client",e),u=s;l.default=u}),98);
__d("LSCleanupSession",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][cleanupSession] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.i64.eq(e[1],t.i64.cast([0,0]))?r[2]=t.i64.cast([0,21]):(t.i64.eq(e[1],t.i64.cast([0,1]))?r[10]=t.i64.cast([0,20]):r[10]=t.i64.cast([0,20]),r[2]=r[10]),t.filter(t.db.table(258).fetch(),function(n){return(n.initiatorId===e[0]||n.responderId===e[0])&&t.i64.eq(n.clientType,e[2])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.clientType,e[2])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.db.table(258).add({sessionId:t.i64.cast([-1,4294967295]),responderId:e[0],initiatorId:e[0],messageType:r[2],clientType:e[2]}):(a=l.item,t.sequence([function(e){return r[19]=a.sessionId,r[20]=a.responderId,r[21]=a.initiatorId,r[17]=a.responderUserId,r[18]=a.initiatorUserId,t.forEach(t.db.table(258).fetch([[[r[19]]]]),function(e){var t=e.update,n=e.item;return t({messageType:r[2]})})},function(o){return e[0]===r[21]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[22]=r[17]:r[22]=void 0,r[11]=r[22]):(e[0]===r[20]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[23]=r[18]:r[23]=void 0,r[22]=r[23]):r[22]=void 0,r[11]=r[22]),t.i64.eq(e[2],t.i64.cast([0,1]))?r[12]=r[17]:r[12]=void 0,t.i64.eq(e[2],t.i64.cast([0,1]))?r[13]=r[18]:r[13]=void 0,r[14]=new t.Map,r[14].set("session_id",r[19]),r[14].set("responder_id",r[20]),r[14].set("initiator_id",r[21]),r[14].set("message_payload",a.messagePayload),r[14].set("pake_secret",a.pakeSecret),r[14].set("sender_id",e[0]),r[14].set("message_type",r[2]),r[14].set("client_type",e[2]),r[14].set("message_recipient_id",r[11]),r[14].set("initiator_user_id",r[13]),r[14].set("responder_user_id",r[12]),r[15]=t.toJSON(r[14]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[15],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[16]=t[0],t})}]))}):(a=l.item,r[13]=a.sessionId,r[14]=a.responderId,r[15]=a.initiatorId,r[10]=a.messageType,r[11]=a.responderUserId,r[12]=a.initiatorUserId,t.i64.eq(r[10],t.i64.cast([0,15]))||t.i64.eq(r[10],t.i64.cast([0,21]))||t.i64.eq(r[10],t.i64.cast([0,20]))?t.resolve(0):t.sequence([function(e){return t.forEach(t.db.table(258).fetch([[[r[13]]]]),function(e){var t=e.update,n=e.item;return t({messageType:r[2]})})},function(o){return e[0]===r[15]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[22]=r[11]:r[22]=void 0,r[16]=r[22]):(e[0]===r[14]?(t.i64.eq(e[2],t.i64.cast([0,1]))?r[23]=r[12]:r[23]=void 0,r[22]=r[23]):r[22]=void 0,r[16]=r[22]),t.i64.eq(e[2],t.i64.cast([0,1]))?r[17]=r[11]:r[17]=void 0,t.i64.eq(e[2],t.i64.cast([0,1]))?r[18]=r[12]:r[18]=void 0,r[19]=new t.Map,r[19].set("session_id",r[13]),r[19].set("responder_id",r[14]),r[19].set("initiator_id",r[15]),r[19].set("message_payload",a.messagePayload),r[19].set("pake_secret",a.pakeSecret),r[19].set("sender_id",e[0]),r[19].set("message_type",r[2]),r[19].set("client_type",e[2]),r[19].set("message_recipient_id",r[16]),r[19].set("initiator_user_id",r[18]),r[19].set("responder_user_id",r[17]),r[20]=t.toJSON(r[19]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[20],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[21]=t[0],t})}]))})},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][cleanupSession] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"cleanupSession",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesCleanupSessionStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSCleanupSessionStoredProcedure",["LSCleanupSession","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCleanupSession"),a.deviceId,a.cleanupReason,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("CleanupPakeSession",["LSCleanupSessionStoredProcedure","LSFactory","LSIntEnum","MAWOneTimeCodeGating","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=t.cleanupReason,l=t.clientType,u=t.deviceId,c=t.storage;return o("MAWOneTimeCodeGating").isOneTimeCodeEnabled()?c.runInTransaction(function(t){return r("LSCleanupSessionStoredProcedure")(r("LSFactory")(t),{cleanupReason:(e||(e=o("LSIntEnum"))).ofNumber(a),clientType:e.ofNumber(l),deviceId:u})},"readwrite",void 0,void 0,i.id+":41"):(s||(s=n("Promise"))).resolve()}l.default=u}),98);
__d("CometBatchNotificationsStateChangeSubscription_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="30300156509571373"}),null);
__d("CometBatchNotificationsStateChangeSubscription.graphql",["CometBatchNotificationsStateChangeSubscription_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"environment"},t={defaultValue:null,kind:"LocalArgument",name:"input"},r=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"BatchNotificationStateChangeSubscribeResponsePayload",kind:"LinkedField",name:"batch_notification_state_change_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"aggregated_notifications",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"seen_state",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"environment",variableName:"environment"}],kind:"ScalarField",name:"notifications_unseen_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_update_timestamp",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"CometBatchNotificationsStateChangeSubscription",selections:r,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"CometBatchNotificationsStateChangeSubscription",selections:r},params:{id:n("CometBatchNotificationsStateChangeSubscription_facebookRelayOperation"),metadata:{subscriptionName:"batch_notification_state_change_subscribe"},name:"CometBatchNotificationsStateChangeSubscription",operationKind:"subscription",text:null}}})();a.exports=e}),null);
__d("CometBatchNotificationsStateChangeSubscription",["CometBatchNotificationsStateChangeSubscription.graphql","CometRelay"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("CometBatchNotificationsStateChangeSubscription.graphql");function u(e){return o("CometRelay").requestSubscription(e,{subscription:s,variables:{environment:"MAIN_SURFACE",input:{environment:"MAIN_SURFACE",query_flags:["INCLUDE_WA_P2B_NOTIFS"]}}})}l.subscription=s,l.batchSubscribe=u}),98);
__d("CometNotificationsReceiveLiveQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="26250231724669886"}),null);
__d("CometNotificationsReceiveLiveQuery.graphql",["CometTextWithEntitiesRelay_textWithEntities$normalization.graphql","CometNotificationsReceiveLiveQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"count"},t={defaultValue:null,kind:"LocalArgument",name:"environment"},r={defaultValue:null,kind:"LocalArgument",name:"filter_tokens"},o={defaultValue:null,kind:"LocalArgument",name:"notif_cache_ids"},a={defaultValue:null,kind:"LocalArgument",name:"refresh_num"},i={defaultValue:null,kind:"LocalArgument",name:"scale"},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},u=[s],c=[{kind:"Variable",name:"environment_alias_override",variableName:"environment"},{kind:"Variable",name:"filter_tokens",variableName:"filter_tokens"},{kind:"Variable",name:"first",variableName:"count"},{kind:"Variable",name:"notif_cache_ids",variableName:"notif_cache_ids"},{kind:"Literal",name:"notif_query_flags",value:["IS_COMET","INCLUDE_WA_P2B_NOTIFS"]},{kind:"Literal",name:"source",value:"unknown"}],d={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},m=[d],p={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title",plural:!1,selections:m,storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"tracking",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"prefetch_score",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"notif_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"notif_cache_id",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"seen_state",storageKey:null},C={alias:"creation_time",args:null,concreteType:"CreationTimeWithRelativeText",kind:"LinkedField",name:"creation_time_with_relative_text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"notif_type",storageKey:null};return{fragment:{argumentDefinitions:[e,t,r,o,a,i],kind:"Fragment",metadata:null,name:"CometNotificationsReceiveLiveQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometNotificationsReceiveLiveQuery_notificationsListViewer"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,r,i,o,e,a],kind:"Operation",name:"CometNotificationsReceiveLiveQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isActor"},s,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"environment",value:"COMET"},{kind:"Literal",name:"query_ego_units",value:!1},{kind:"Variable",name:"refresh_num",variableName:"refresh_num"}],concreteType:"SideFeedConnection",kind:"LinkedField",name:"side_feed",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{args:null,documentName:"CometRightSideHeaderCards_viewerSideFeed",fragmentName:"PagesCometHomeAdminContainer_pagesPanel",fragmentPropName:"pagesPanel",kind:"ModuleImport"}],type:"PagesSideFeedUnit",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometRightSideHeaderCards_viewerSideFeed",fragmentName:"FriendingCometHomeInlineRHCContainer_friendsPanel",fragmentPropName:"friendsPanel",kind:"ModuleImport"}],type:"FriendingRequestsSideFeedUnit",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometRightSideHeaderCards_viewerSideFeed",fragmentName:"CometHomeRemindersContainer_reminderPanel",fragmentPropName:"reminderPanel",kind:"ModuleImport"}],type:"RemindersSideFeedUnit",abstractKey:null},{kind:"InlineFragment",selections:u,type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:u,type:"AdsSideFeedUnitItem",abstractKey:null}],storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"environment",variableName:"environment"}],kind:"ScalarField",name:"notifications_unseen_count",storageKey:null},{alias:null,args:c,concreteType:"ViewerNotificationsPageConnection",kind:"LinkedField",name:"notifications_page",plural:!1,selections:[{alias:null,args:null,concreteType:"NotifPageFilterConfig",kind:"LinkedField",name:"filter_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"selected_filter_tokens",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"filters",plural:!0,selections:[l,{kind:"InlineFragment",selections:[p,{alias:null,args:null,kind:"ScalarField",name:"notif_filter_token",storageKey:null}],type:"NotifPageSingleFilter",abstractKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"query_id",storageKey:null},{alias:null,args:null,concreteType:"ViewerNotificationsPageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"row_type",storageKey:null},_,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"bucket_type",storageKey:null},{alias:null,args:null,concreteType:"NotifPageBucketHeaderLink",kind:"LinkedField",name:"header_link",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},p],type:"NotifPageBucketHeaderRow",abstractKey:null},{kind:"InlineFragment",selections:[f,{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[g,s,h,y,C,_],storageKey:null}],type:"NotifPageCachedNotificationRow",abstractKey:null},{kind:"InlineFragment",selections:[f,{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[g,y,s,h,{alias:null,args:null,kind:"ScalarField",name:"notif_tags",storageKey:null},_,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"notif_attachments",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sound_urls",storageKey:null}],type:"NotifSoundAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemFriendRequestAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"FriendRequestNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemInlineCTAAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"InlineCTACometNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemPageInviteAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"PageInviteNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemQuickPromotionAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"QuickPromotionNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemInlineSurveyAttachment_attachment",fragmentPropName:"attachment",kind:"ModuleImport"},{alias:null,args:null,concreteType:"StructuredSurveySession",kind:"LinkedField",name:"inline_survey",plural:!1,selections:[l],storageKey:null}],type:"InlineSurveyNotifAttachment",abstractKey:null}],storageKey:null},C,b,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:[{args:null,fragment:n("CometTextWithEntitiesRelay_textWithEntities$normalization.graphql"),kind:"FragmentSpread"},d],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:56},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:56}],concreteType:"Image",kind:"LinkedField",name:"notif_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"site",value:"comet"}],kind:"ScalarField",name:"url",storageKey:'url(site:"comet")'},{alias:null,args:null,kind:"ScalarField",name:"cache_timestamp",storageKey:null},{alias:null,args:null,concreteType:"GlyphIconData",kind:"LinkedField",name:"icon_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"reaction_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_icon_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"NotificationContextInfo",kind:"LinkedField",name:"context_info",plural:!1,selections:[{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"short_text",plural:!1,selections:m,storageKey:null},{alias:null,args:null,concreteType:"XFBUfiIconsAndCounts",kind:"LinkedField",name:"ufi_icons_and_counts",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"ufi_counts",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ufi_icon_name",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"NotifNavigationEndpoint",kind:"LinkedField",name:"navigation_endpoint",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"supported",value:"44kVfU"}],concreteType:null,kind:"LinkedField",name:"comet_custom_renderer",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometTopFansFanNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"TopFansFanNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometRisingFanNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"RisingFanNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometCrossProfileNotificationsListItem_cpnInfo",fragmentPropName:"cpnInfo",kind:"ModuleImport"}],type:"CrossProfileNotificationInfo",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometBusinessMessageNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"BusinessMessageNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometGroupsNotificationsListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"GroupsNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometXIPaidexNotificationsListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XIPaidexNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometAPPlusPostWaitlistNotificationsListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"APPlusPostWaitlistNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometCustomBadgeNameIsLiveNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"CreatorCustomBadgeNameIsLiveNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometCreatorCustomBadgeUserUpgradeNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"CreatorCustomBadgeUserUpgradeNotificationRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsList_viewerConnection",fragmentName:"CometFXFetaUpgradeSuccessNotificationListItem_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"FXFetaUpgradeSuccessNotificationRenderer",abstractKey:null}],storageKey:'comet_custom_renderer(supported:"44kVfU")'}],storageKey:null},{kind:"ClientExtension",selections:[{alias:"id_for_entrypoint",args:null,kind:"ScalarField",name:"__id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null}]}],storageKey:null}],type:"NotifPageNotificationRow",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invalidation_reason",storageKey:null},{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[g,b,s],storageKey:null}],type:"NotifPageDebugInvalidationRow",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"see_previous_text",storageKey:null}],type:"NotifPageSeePreviousButtonRow",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null},{alias:null,args:c,filters:["environment_alias_override"],handle:"comet_notifications_thin_client",key:"CometNotificationsList_notifications_page",kind:"LinkedHandle",name:"notifications_page"},{alias:null,args:null,kind:"ScalarField",name:"last_update_timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"notifications_sound_path",storageKey:null},{alias:null,args:[{kind:"Literal",name:"promptType",value:"FOOTER"},{kind:"Literal",name:"surface",value:"JEWEL_COMET"}],concreteType:"XFBCometPushTurnOnStatus",kind:"LinkedField",name:"comet_push_turn_on_status",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_comet_push_turn_on_eligible",storageKey:null}],storageKey:'comet_push_turn_on_status(promptType:"FOOTER",surface:"JEWEL_COMET")'},{alias:null,args:null,concreteType:"BrowserPushConfig",kind:"LinkedField",name:"browser_push_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"browser_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"service_worker_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"app_id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("CometNotificationsReceiveLiveQuery_facebookRelayOperation"),metadata:{live:{config_id:""}},name:"CometNotificationsReceiveLiveQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("CometNotificationsReceiveLiveQuery_notificationsListViewer.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[{kind:"RootArgument",name:"count"},{kind:"RootArgument",name:"environment"},{kind:"RootArgument",name:"filter_tokens"},{kind:"RootArgument",name:"notif_cache_ids"}],kind:"Fragment",metadata:null,name:"CometNotificationsReceiveLiveQuery_notificationsListViewer",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometToastNotification_actor"}],storageKey:null},{args:null,kind:"FragmentSpread",name:"CometRightSideHeaderCards_viewerSideFeed"},{alias:null,args:[{kind:"Variable",name:"environment",variableName:"environment"}],kind:"ScalarField",name:"notifications_unseen_count",storageKey:null},{args:[{kind:"Variable",name:"count",variableName:"count"},{kind:"Variable",name:"filter_tokens",variableName:"filter_tokens"},{kind:"Variable",name:"notif_cache_ids",variableName:"notif_cache_ids"}],kind:"FragmentSpread",name:"CometNotificationsList_viewerConnection"},{args:null,kind:"FragmentSpread",name:"CometNotificationsList_viewerData"},{alias:null,args:null,kind:"ScalarField",name:"last_update_timestamp",storageKey:null}],type:"Viewer",abstractKey:null};a.exports=e}),null);
__d("requestLiveQueryExperimental",["invariant","LiveQueryEventsLoggingResolver","ODS","RelayAPIConfig","RelayGraphQLRequestUtils","makeGraphQLLiveQueryRequest","nullthrows","promiseDone","relay-runtime","relay-runtime/store/RelayConcreteVariables"],(function(t,n,r,o,a,i,l,s){"use strict";var e;function u(e,t){var n={access_token:r("RelayAPIConfig").accessToken,actor_id:r("RelayAPIConfig").actorID,config_id:r("nullthrows")(e.params.metadata.live.config_id,"config_id should not be null")},a={doc_id:r("nullthrows")(e.params.id,"id in request params should not be null"),operation_name:e.params.name,config_id:n.config_id,actor_id:n.actor_id,variables:t};n.access_token!==""&&(a=babelHelpers.extends({},a,{access_token:n.access_token}));var i=o("LiveQueryEventsLoggingResolver").tempResolveLoggingContext();return i!=null&&(a=babelHelpers.extends({},a,{logging_context:i})),a}function c(t,n){var a=n.query,i=n.variables,l=o("relay-runtime").getRequest(a),c=d(l,i),m=u(l,c),p,_=c,f=o("relay-runtime").createOperationDescriptor(l,i),g=o("relay-runtime").Observable.create(function(t){return p=r("makeGraphQLLiveQueryRequest")(m).onResponse(function(n){var a;try{a=r("RelayGraphQLRequestUtils").parsePayload(n),typeof a=="object"||s(0,12937)}catch(n){return(e||(e=o("ODS"))).bumpEntityKey(97,"comet_notifications.new_notification","lq.receive_invalid_payload"),t.error(n)}if(!("errors"in a)&&!("data"in a))return(e||(e=o("ODS"))).bumpEntityKey(97,"comet_notifications.new_notification","lq.receive_empty_response"),t.error(o("relay-runtime").RelayError.createWarning("EmptyResponseError","Parsed network response is empty"));if(a.errors){for(var i of a.errors)if(i.severity==="CRITICAL"){var u=r("RelayGraphQLRequestUtils").createErrorFromPayload(i,l.operation.name);return(e||(e=o("ODS"))).bumpEntityKey(97,"comet_notifications.new_notification","lq.receive_critical_error"),t.error(u)}}t.closed||((e||(e=o("ODS"))).bumpEntityKey(97,"comet_notifications.new_notification","lq.receive_notification"),t.next(a))}).onRetryUpdateRequestBody(function(){return JSON.stringify({variables:_})}).send(),function(){r("promiseDone")(p,function(e){e.cancel()})}});t.executeWithSource({operation:f,source:g}).subscribe({});var h=!1,y;return{dispose:function(){!h&&p!=null&&(r("promiseDone")(p,function(e){e.cancel()}),h=!0)},updateVariables:function(t){return!h&&p!=null?(y=t,r("promiseDone")(p,function(e){if(y!=null&&!h){var t=d(l,y);e.amendExperimental({new_variables:t}),_=t,y=null}}),!0):!1}}}function d(e,t){return o("relay-runtime/store/RelayConcreteVariables").getOperationVariables(e.operation,e.params.providedVariables,t)}l.default=c}),98);
__d("CometNotificationsReceiveLiveQuery",["CometNotificationsReceiveLiveQuery.graphql","CometNotificationsReceiveLiveQuery_notificationsListViewer.graphql","requestLiveQueryExperimental"],(function(t,n,r,o,a,i,l){"use strict";var e,s;e!==void 0||(e=n("CometNotificationsReceiveLiveQuery_notificationsListViewer.graphql"));var u=s!==void 0?s:s=n("CometNotificationsReceiveLiveQuery.graphql");function c(e,t){return r("requestLiveQueryExperimental")(e,{query:u,variables:t})}l.subscribeToNotificationUpdates=c}),98);
__d("CometNotificationsStateChangeSubscription_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="23864641996495578"}),null);
__d("CometNotificationsStateChangeSubscription.graphql",["CometNotificationsStateChangeSubscription_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"environment"},t={defaultValue:null,kind:"LocalArgument",name:"input"},r=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"NotificationStateChangeSubscribeResponsePayload",kind:"LinkedField",name:"notification_state_change_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notification",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"notif_cache_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cache_timestamp",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"seen_state",storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"environment",variableName:"environment"}],kind:"ScalarField",name:"notifications_unseen_count",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"CometNotificationsStateChangeSubscription",selections:r,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"CometNotificationsStateChangeSubscription",selections:r},params:{id:n("CometNotificationsStateChangeSubscription_facebookRelayOperation"),metadata:{subscriptionName:"notification_state_change_subscribe"},name:"CometNotificationsStateChangeSubscription",operationKind:"subscription",text:null}}})();a.exports=e}),null);
__d("CometNotificationsStateChangeSubscription",["CometNotificationsStateChangeSubscription.graphql","CometRelay"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("CometNotificationsStateChangeSubscription.graphql");function u(e){return o("CometRelay").requestSubscription(e,{subscription:s,updater:function(t,n){if(n){var e=n.notification_state_change_subscribe;if(e){var r=e==null?void 0:e.notification,o=e==null?void 0:e.seen_state;if(!(!r||!o)&&r.id!=null&&r.id!==""){var a=t.get(r.id);a&&a.setValue(o,"seen_state")}}}},variables:{environment:"MAIN_SURFACE",input:{environment:"MAIN_SURFACE",query_flags:["INCLUDE_WA_P2B_NOTIFS"]}}})}var c={subscribe:u,subscription:s};l.default=c}),98);
__d("DedupMiThreadCreationCache",["justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set,s=function(n){var t=r("justknobx")._("4749");t&&e.add(n)};l.DedupMiThreadCreationCache=e,l.addToDedupMiThreadCreationCache=s}),98);
__d("E2EEBackupCommon",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ALREADY_REGISTERED","BACKUP_KEY_PAIR_SERIALIZATION_ERROR","CLIENT_PARAMS_ERROR","NETWORK_PROVIDER_ERROR","NOT_REGISTERED","VESTA_CLIENT_ERROR","VESTA_SERVER_ERROR","ISLAND_PUB_RSA_KEY_INVALID","ISLAND_PUB_ED25519_KEY_INVALID","MISSING_PIN_INPUT","GENERAL_ERROR","INVALID_PASSWORD"]),l=(function(e){function t(t,n){var r;return r=e.call(this,n==null?void 0:n.message)||this,r.name="BackupError",r.errorType=t,r.detailedError=n,r.message=t+((n==null?void 0:n.message)!=null?": "+(n==null?void 0:n.message):""),r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.BackupErrorType=e,i.BackupError=l}),66);
__d("VestaClientError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.default=e}),66);
__d("VestaGetWasm",["WAWasmModuleCache","bx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("72238")),s=function(){return o("WAWasmModuleCache").loadWasmModule(e)};l.getVestaWasm=s}),98);
__d("VestaWasm.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={},c={},d={},m={},p={},_={},f={},g={},h={},y={},C={},b={},v={};s.name="ValidateHsmKeyRequest",s.internalSpec={hsmKey:[1,(e=o("WAProtoConst")).FLAGS.REQUIRED|e.TYPES.BYTES],signature:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},u.name="ValidateHsmKeyResponse",u.internalSpec={isValid:[1,e.FLAGS.REQUIRED|e.TYPES.BOOL]},c.name="BeginRegisterRequest",c.internalSpec={password:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},d.name="BeginRegisterResponse",d.internalSpec={r1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},m.name="FinishRegisterRequest",m.internalSpec={r1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],r2Message:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],r2MessageSig:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],islandEd25519Pub:[4,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[5,e.FLAGS.REQUIRED|e.TYPES.BYTES],userSecret:[6,e.FLAGS.REQUIRED|e.TYPES.BYTES],registrationChallenge:[7,e.FLAGS.REQUIRED|e.TYPES.BYTES],hsmRsaPublicKey:[8,e.FLAGS.REQUIRED|e.TYPES.BYTES],loginAttempts:[9,e.TYPES.UINT32],useProtobufMode:[10,e.FLAGS.REQUIRED|e.TYPES.BOOL]},p.name="FinishRegisterResponse",p.internalSpec={registrationPayloadEncrypted:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],registrationIdentifier:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},_.name="BeginLoginRequest",_.internalSpec={password:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},f.name="BeginLoginResponse",f.internalSpec={l1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},g.name="FinishLoginRequest",g.internalSpec={l2Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],l2MessageSig:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],islandEd25519Pub:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[4,e.FLAGS.REQUIRED|e.TYPES.BYTES]},h.name="FinishLoginResponse",h.internalSpec={l3Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],sessionKey:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],exportKey:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES]},y.name="UnpackLoginPayloadRequest",y.internalSpec={loginPayload:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],sessionKey:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],exportKey:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],useProtobufMode:[4,e.FLAGS.REQUIRED|e.TYPES.BOOL]},C.name="UnpackLoginPayloadResponse",C.internalSpec={userSecret:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},b.name="CliCommand",b.internalSpec={validateHsmKey:[1,e.TYPES.MESSAGE,s],beginRegister:[2,e.TYPES.MESSAGE,c],finishRegister:[3,e.TYPES.MESSAGE,m],beginLogin:[4,e.TYPES.MESSAGE,_],finishLogin:[5,e.TYPES.MESSAGE,g],unpackLoginPayload:[6,e.TYPES.MESSAGE,y],__oneofs__:{command:["validateHsmKey","beginRegister","finishRegister","beginLogin","finishLogin","unpackLoginPayload"]}},v.name="CliResponse",v.internalSpec={errorCode:[1,e.FLAGS.REQUIRED|e.TYPES.INT32],validateHsmKey:[2,e.TYPES.MESSAGE,u],beginRegister:[3,e.TYPES.MESSAGE,d],finishRegister:[4,e.TYPES.MESSAGE,p],beginLogin:[5,e.TYPES.MESSAGE,f],finishLogin:[6,e.TYPES.MESSAGE,h],unpackLoginPayload:[7,e.TYPES.MESSAGE,C],__oneofs__:{response:["validateHsmKey","beginRegister","finishRegister","beginLogin","finishLogin","unpackLoginPayload"]}},l.ValidateHsmKeyRequestSpec=s,l.ValidateHsmKeyResponseSpec=u,l.BeginRegisterRequestSpec=c,l.BeginRegisterResponseSpec=d,l.FinishRegisterRequestSpec=m,l.FinishRegisterResponseSpec=p,l.BeginLoginRequestSpec=_,l.BeginLoginResponseSpec=f,l.FinishLoginRequestSpec=g,l.FinishLoginResponseSpec=h,l.UnpackLoginPayloadRequestSpec=y,l.UnpackLoginPayloadResponseSpec=C,l.CliCommandSpec=b,l.CliResponseSpec=v}),98);
__d("mapVestaClientError",["VestaClientError"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){switch(e){case 1:return new u;case 2:return new c;case 3:return new d;case 4:return new m;case 5:return new p;case 6:return new _;case 7:return new f;case 8:return new g;case 9:return new h;case 10:return new y;case 11:return new C;case 12:return new b;default:return new v}}var u=(function(e){function t(t){var n;return t===void 0&&(t="Buffer supplied to WASM for response is too small"),n=e.call(this,t)||this,n.name="InsufficientResultBuffer",n}return babelHelpers.inheritsLoose(t,e),t})(e=r("VestaClientError")),c=(function(e){function t(t){var n;return t===void 0&&(t="Incorrect user password supplied during login"),n=e.call(this,t)||this,n.name="InvalidUserPassword",n}return babelHelpers.inheritsLoose(t,e),t})(e),d=(function(e){function t(t){var n;return t===void 0&&(t="Invalid input from server"),n=e.call(this,t)||this,n.name="MalformedServerResponse",n}return babelHelpers.inheritsLoose(t,e),t})(e),m=(function(e){function t(t){var n;return t===void 0&&(t="Invalid input from client"),n=e.call(this,t)||this,n.name="MalformedClientInput",n}return babelHelpers.inheritsLoose(t,e),t})(e),p=(function(e){function t(t){var n;return t===void 0&&(t="Error during encryption operation"),n=e.call(this,t)||this,n.name="EncryptionFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),_=(function(e){function t(t){var n;return t===void 0&&(t="Error during decryption operation"),n=e.call(this,t)||this,n.name="DecryptionFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),f=(function(e){function t(t){var n;return t===void 0&&(t="Error during serialization operation."),n=e.call(this,t)||this,n.name="SerializationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),g=(function(e){function t(t){var n;return t===void 0&&(t="Error deserializing inputs, likely due to malformed input"),n=e.call(this,t)||this,n.name="DeserializationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),h=(function(e){function t(t){var n;return t===void 0&&(t="Passed RSA public key is in an invalid format."),n=e.call(this,t)||this,n.name="RsaInvalidKey",n}return babelHelpers.inheritsLoose(t,e),t})(e),y=(function(e){function t(t){var n;return t===void 0&&(t="Unable to verify RSA signature"),n=e.call(this,t)||this,n.name="RsaVerificationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),C=(function(e){function t(t){var n;return t===void 0&&(t="Passed Ed25519 public key is in an invalid format."),n=e.call(this,t)||this,n.name="Ed25519InvalidKey",n}return babelHelpers.inheritsLoose(t,e),t})(e),b=(function(e){function t(t){var n;return t===void 0&&(t="Unable to verify Ed25519 signature"),n=e.call(this,t)||this,n.name="Ed25519VerificationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),v=(function(e){function t(t){var n;return t===void 0&&(t="Unknown error code received from WASM binary"),n=e.call(this,t)||this,n.name="UnknownErrorCode",n}return babelHelpers.inheritsLoose(t,e),t})(e);l.mapErrorCode=s,l.DeserializationFailure=g}),98);
__d("VestaClient",["$InternalEnum","VestaClientError","VestaGetWasm","VestaWasm.pb","WAByteArray","WAResultOrError","WATagsLogger","WAWasmReactor","err","mapVestaClientError"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("WATagsLogger").TAGS(["VestaClient"]),u=0,c="VestaClientV2_REPL",d=(function(){function e(){if(!e.$2){var t=o("WAWasmReactor").createWasmInstance(o("VestaGetWasm").getVestaWasm,c);e.$1=t;return}throw r("err")("VestaWasmReactorSingleton is already initialized")}e.getInstance=function(){if(!e.$2){var t=new e;e.$2=t;var n=o("WAWasmReactor").createWasmInstance(o("VestaGetWasm").getVestaWasm,c);e.$1=n}return e.$2};var t=e.prototype;return t.createWasmReactorCommand=async function(n){var t=n.InputSpec,o=n.ResultSpec,a=n.validateResult,i=await e.$1;if(!i)throw r("err")("wasmReactor is not initialized");return i.DEPRECATED_createWasmCommand({InputSpec:t,ResultSpec:o,validateResult:a})},e})();d.$1=null,d.$2=null;var m=function(t){var e=d.getInstance();if(!e)throw r("err")("VestaWasmReactorSingleton is not initialized");return e.createWasmReactorCommand(t)};function p(t){var n=t.processResult;function a(t){var a=t.errorCode;if(a!==u)return s.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Vesta error: ",""])),a),o("WAResultOrError").makeError(o("mapVestaClientError").mapErrorCode(a));try{return o("WAResultOrError").makeResult(n(t))}catch(e){if(e instanceof r("VestaClientError"))return o("WAResultOrError").makeError(e);throw e}}return m({InputSpec:o("VestaWasm.pb").CliCommandSpec,ResultSpec:o("VestaWasm.pb").CliResponseSpec,validateResult:a})}function _(e,t){var n=p({processResult:function(t){if(t.validateHsmKey)return t.validateHsmKey.isValid;throw new(o("mapVestaClientError")).DeserializationFailure}}),r={validateHsmKey:{hsmKey:o("WAByteArray").uint8ArrayToBuffer(e),signature:o("WAByteArray").uint8ArrayToBuffer(t)}};return n.then(function(e){return e(r)})}function f(e){var t=p({processResult:function(t){if(t.beginRegister){var e=t.beginRegister;return{clientState:new Uint8Array(e.clientState),r1Message:new Uint8Array(e.r1Message)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),n={beginRegister:{password:o("WAByteArray").uint8ArrayToBuffer(e)}};return t.then(function(e){return e(n)})}var g=n("$InternalEnum").Mirrored(["WaBackupKeyData","Raw"]);function h(e,t,n,r,a,i,l,s,u,c){u===void 0&&(u=0),c===void 0&&(c=g.WaBackupKeyData);var d=p({processResult:function(t){if(t.finishRegister){var e=t.finishRegister;return{registerIdentifier:new Uint8Array(e.registrationIdentifier),registerPayload:new Uint8Array(e.registrationPayloadEncrypted)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),m={finishRegister:{clientState:o("WAByteArray").uint8ArrayToBuffer(a),hsmRsaPublicKey:o("WAByteArray").uint8ArrayToBuffer(s),islandEd25519Pub:o("WAByteArray").uint8ArrayToBuffer(r),loginAttempts:u>0?u:void 0,r1Message:o("WAByteArray").uint8ArrayToBuffer(e),r2Message:o("WAByteArray").uint8ArrayToBuffer(t),r2MessageSig:o("WAByteArray").uint8ArrayToBuffer(n),registrationChallenge:o("WAByteArray").uint8ArrayToBuffer(l),useProtobufMode:c===g.WaBackupKeyData,userSecret:o("WAByteArray").uint8ArrayToBuffer(i)}};return d.then(function(e){return e(m)})}function y(e){var t=p({processResult:function(t){if(t.beginLogin){var e=t.beginLogin;return{clientState:new Uint8Array(e.clientState),l1Message:new Uint8Array(e.l1Message)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),n={beginLogin:{password:o("WAByteArray").uint8ArrayToBuffer(e)}};return t.then(function(e){return e(n)})}function C(e,t,n,r){var a,i=p({processResult:function(t){if(t.finishLogin){var e=t.finishLogin;return{exportKey:new Uint8Array(e.exportKey),l3Message:new Uint8Array(e.l3Message),sessionKey:new Uint8Array(e.sessionKey)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),l={finishLogin:{clientState:(a=o("WAByteArray")).uint8ArrayToBuffer(r),islandEd25519Pub:a.uint8ArrayToBuffer(n),l2Message:a.uint8ArrayToBuffer(e),l2MessageSig:a.uint8ArrayToBuffer(t)}};return i.then(function(e){return e(l)})}function b(e,t,n,r){r===void 0&&(r=g.WaBackupKeyData);var a=p({processResult:function(t){if(t.unpackLoginPayload){var e=t.unpackLoginPayload;return{userSecret:new Uint8Array(e.userSecret)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),i={unpackLoginPayload:{exportKey:o("WAByteArray").uint8ArrayToBuffer(n),loginPayload:o("WAByteArray").uint8ArrayToBuffer(e),sessionKey:o("WAByteArray").uint8ArrayToBuffer(t),useProtobufMode:r===g.WaBackupKeyData}};return a.then(function(e){return e(i)})}l.validateHsmKey=_,l.beginRegister=f,l.SerializationMode=g,l.finishRegister=h,l.beginLogin=y,l.finishLogin=C,l.unpackLoginPayload=b}),98);
__d("E2EEBackupSecretRestoreModule",["E2EEBackupCommon","QuickPerformanceLogger","Random","VestaClient","VestaClientError","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("qpl")._(235874858,"168");function u(){return o("Random").uint32()}async function c(t,n,a){var i=u();(e||(e=r("QuickPerformanceLogger"))).markerStart(s,i),e.markerAnnotate(s,{string:{product_use_case:n.productUseCase}},{instanceKey:i});try{var l=await t.initLogin({clientId:n.clientId,productUseCase:n.productUseCase},a),c=l.islandEd25519Pub,d=l.islandEd25519PubSig,m=l.islandRsaPub,p=l.islandRsaPubSig,_=l.isRegistered;if((e||(e=r("QuickPerformanceLogger"))).markerPoint(s,"init_login_network_end",{instanceKey:i}),!_)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"NOT_REGISTERED"}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.NOT_REGISTERED);var f=await Promise.all([o("VestaClient").validateHsmKey(m,p),o("VestaClient").validateHsmKey(c,d)]),g=f[0],h=f[1];if(!g.success)throw g.error;if(!h.success)throw h.error;var y=g.value,C=h.value;if(!y)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"ISLAND_PUB_RSA_KEY_INVALID"}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_RSA_KEY_INVALID);if(!C)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"ISLAND_PUB_ED25519_KEY_INVALID"}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_ED25519_KEY_INVALID);e.markerPoint(s,"validate_hsm_keys_client_end",{instanceKey:i});var b=n.vestaAccountPin;if(b==null)throw new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.MISSING_PIN_INPUT);var v=new TextEncoder,S=await o("VestaClient").beginLogin(v.encode(b));if(!S.success)throw S.error;var R=S.value,L=R.clientState,E=R.l1Message;(e||(e=r("QuickPerformanceLogger"))).markerPoint(s,"begin_login_client_end",{instanceKey:i});var k=await t.beginLogin({clientId:n.clientId,productUseCase:n.productUseCase,opaqueL1:E},a),I=k.opaqueL2,T=k.opaqueL2Sig;e.markerPoint(s,"begin_login_network_end",{instanceKey:i});var D=await o("VestaClient").finishLogin(I,T,c,L);if(!D.success)throw D.error;var x=D.value,$=x.exportKey,P=x.l3Message,N=x.sessionKey;e.markerPoint(s,"finish_login_client_end",{instanceKey:i});var M=await t.finishLogin({clientId:n.clientId,productUseCase:n.productUseCase,opaqueL3:P},a),w=M.loginPayload,A=M.loginSuccess;if(e.markerPoint(s,"finish_login_network_end",{instanceKey:i}),!A)throw(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"VESTA_SERVER_ERROR"}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR);if(w!=null){var F=await o("VestaClient").unpackLoginPayload(w,N,$);if(!F.success)throw F.error;var O=F.value.userSecret;return(e||(e=r("QuickPerformanceLogger"))).markerPoint(s,"unpack_login_payload",{instanceKey:i}),e.markerEnd(s,2,i),O}throw e.markerAnnotate(s,{string:{failure_reason:"VESTA_SERVER_ERROR"}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}catch(t){throw t instanceof o("E2EEBackupCommon").BackupError?t:t instanceof r("VestaClientError")?((e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:"VestaClientException: "+t.name}},{instanceKey:i}),e.markerEnd(s,3,i),t.name==="InvalidUserPassword"?new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD,t):new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.VESTA_CLIENT_ERROR,t)):((e||(e=r("QuickPerformanceLogger"))).markerAnnotate(s,{string:{failure_reason:t.message}},{instanceKey:i}),e.markerEnd(s,3,i),new(o("E2EEBackupCommon")).BackupError(o("E2EEBackupCommon").BackupErrorType.NETWORK_PROVIDER_ERROR,t))}}l.restoreBackupSecret=c}),98);
__d("E2EEBackupUtil",["tweetnacl-util"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("tweetnacl-util").encodeBase64(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function s(e){var t=e.replace(/-/g,"+").replace(/_/g,"/"),n=e.length%4;if(n>0){if(n===1)throw new Error("Invalid length, couldn't decode input string");t=t.padEnd(t.length+(4-n),"=")}return r("tweetnacl-util").decodeBase64(t)}l.encodeBase64Url=e,l.decodeBase64Url=s}),98);
__d("EBFetchBackupIdsSharedFragmentQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25164225499885252"}),null);
__d("EBFetchBackupIdsSharedFragmentQuery.graphql",["EBFetchBackupIdsSharedFragmentQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EBFetchBackupIdsSharedFragmentQuery",selections:[{args:null,kind:"FragmentSpread",name:"EBFetchBackupIdsSharedFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EBFetchBackupIdsSharedFragmentQuery",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[e],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null},e],storageKey:null}]},params:{id:n("EBFetchBackupIdsSharedFragmentQuery_facebookRelayOperation"),metadata:{},name:"EBFetchBackupIdsSharedFragmentQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("EBFetchBackupIdsSharedFragment.graphql",["EBFetchBackupIdsSharedFragmentQuery.graphql"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:n("EBFetchBackupIdsSharedFragmentQuery.graphql")}},name:"EBFetchBackupIdsSharedFragment",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[e],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();a.exports=e}),null);
__d("EBFetchBackupIdsSharedQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25051902717827282"}),null);
__d("EBFetchBackupIdsSharedQuery.graphql",["EBFetchBackupIdsSharedQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EBFetchBackupIdsSharedQuery",selections:[{args:null,kind:"FragmentSpread",name:"EBFetchBackupIdsSharedFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EBFetchBackupIdsSharedQuery",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[e],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null},e],storageKey:null}]},params:{id:n("EBFetchBackupIdsSharedQuery_facebookRelayOperation"),metadata:{},name:"EBFetchBackupIdsSharedQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("LSEncryptedBackupsOnboardingDecision",[],(function(t,n,r,o,a,i){var e=Object.freeze({FAILURE:-1,NO_DECISION_MADE:0,BACKUP_CREATED:1,STORE_ON_DEVICE_ONLY:2});i.default=e}),66);
__d("LSEncryptedBackupsVirtualDeviceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OFFLINE:1,HSM:2,BLOCK_STORE:3,KEYCHAIN:5,ICLOUD_KVS:6,GOOGLE_DRIVE:7,CLOUDKIT:8,ICLOUD_DRIVE:9,PASSKEY:10,ICLOUD_KEYCHAIN:11,GOOGLE_ONE_AUTO_BACKUP:12,SECURITY_QUESTION_HSM:13,TRUSTED_CONTACT:14,META_OWNED:15,AUTOMATIC_EB:16,META_PRELOADS:17,GOOGLE_KEY_VALUE_BACKUP:18});i.default=e}),66);
__d("EBFetchBackupIdsShared",["Base64Utils","EBDeps","EBFetchBackupIdsSharedFragment.graphql","EBFetchBackupIdsSharedQuery.graphql","FBLogger","I64","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsOnboardingDecision","LSEncryptedBackupsVirtualDeviceType","LSIntEnum","LSShape","LSVec","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=r("requireDeferred")("mwEBUpdateBackupsTable").__setRef("EBFetchBackupIdsShared"),m=e!==void 0?e:e=n("EBFetchBackupIdsSharedFragment.graphql"),p=s!==void 0?s:s=n("EBFetchBackupIdsSharedQuery.graphql");function _(e){if(e!=null){var t=e;if(t in r("LSEncryptedBackupsOnboardingDecision"))return r("LSEncryptedBackupsOnboardingDecision")[t]}}function f(e){if(e!=null){var t=e;if(t in r("LSEncryptedBackupsBackupTenancy")){var n=r("LSEncryptedBackupsBackupTenancy")[t];return(u||(u=o("LSIntEnum"))).ofNumber(n)}}}function g(e){var t=e.xfb_backup,n=t==null?void 0:t.id;if(t!=null&&n!=null){var a,i,l=!1;(t==null?void 0:t.has_otc_eligible_devices)!=null?l=t==null?void 0:t.has_otc_eligible_devices:r("FBLogger")("wmi_eb").mustfix("failed to retrieve has_otc_eligible_devices. defaulting to false");var s=f(t.backup_tenancy),d=[o("LSShape").ofRecord(s!=null?{backup_id:(c||(c=o("I64"))).of_string(n),backup_tenancy:s}:{backup_id:(c||(c=o("I64"))).of_string(n)})],m=[];t.virtual_devices.forEach(function(e){var t,a,i=e==null?void 0:e.client_generated_id;if(n==null||i==null||(e==null?void 0:e.device_type)==null){r("FBLogger")("wmi_eb").warn("Invalid virtual device fetched in fetchBackupIdsGraphQL.");return}var l="REQUIRES_MIGRATION",s=(e==null?void 0:e.migration_status)===l,d=e.device_type;if(!(d in r("LSEncryptedBackupsVirtualDeviceType"))){r("FBLogger")("wmi_eb").warn("Invalid virtual device type fetched in fetchBackupIdsGraphQL.");return}var p=r("LSEncryptedBackupsVirtualDeviceType")[d];m.push(o("LSShape").ofRecord({backup_id:(c||(c=o("I64"))).of_string(n),virtual_device_ids:r("LSVec").ofArray([o("LSShape").ofRecord({virtual_device_id:o("Base64Utils").toArrayBuffer(i)})]),virtual_devices:r("LSVec").ofArray([o("LSShape").ofRecord({creation_time:(t=e==null?void 0:e.creation_time)!=null?t:void 0,device_created_on:(a=e==null?void 0:e.device_created_on)!=null?a:void 0,requires_hsm_migration:s,virtual_device_id:o("Base64Utils").toArrayBuffer(i),virtual_device_type:(u||(u=o("LSIntEnum"))).ofNumber(p)})])}))});var p=[];(a=t.devices)==null||a.edges.forEach(function(e){var t;(e==null||(t=e.node)==null?void 0:t.id)!=null&&p.push(o("LSShape").ofRecord({device_id:(c||(c=o("I64"))).of_string(e.node.id)}))});var g=t.encryption_management_delegator_id!=null?(c||(c=o("I64"))).of_string(t.encryption_management_delegator_id):void 0;return{backupIds:d,deviceIds:p,encryptionManagementDelegatorId:g,hasOtcEligibleDevices:l,isUserOptedOut:(i=t.is_user_opted_out)!=null?i:void 0,virtualDevices:m}}else{var h,y=_((h=e.xfb_eb_user_preferences)==null?void 0:h.onboarding_decision)===r("LSEncryptedBackupsOnboardingDecision").STORE_ON_DEVICE_ONLY;return{backupIds:[],deviceIds:[],hasOtcEligibleDevices:!1,isUserOptedOut:y,virtualDevices:[]}}}async function h(e){var t=e.storage,n=e.transformedData,o=await d.load();await o({backupIds:r("LSVec").ofArray(n.backupIds),deviceIds:r("LSVec").ofArray(n.deviceIds),encryptionManagementDelegatorId:n.encryptionManagementDelegatorId,hasOtcEligibleDevices:n.hasOtcEligibleDevices,isSuccess:!0,isUserOptedOut:n.isUserOptedOut,storage:t,virtualDevices:r("LSVec").ofArray(n.virtualDevices)})}async function y(e){var t=e.data,n=e.qplFlow;n.addPoint("eb_fetch_backup_ids_gql_transform_data_start");var r=g(t);n.addPoint("eb_fetch_backup_ids_gql_transform_data_end"),n.addPoint("eb_fetch_backup_ids_gql_update_table_start");var a=await o("EBDeps").getDeps().getLSDB();await h({storage:a,transformedData:r}),n.addPoint("eb_fetch_backup_ids_gql_update_table_end")}l.fetchBackupIdsRefetchableFragment=m,l.fetchBackupIdsQuery=p,l.onboardingDecisionTypeToEnum=_,l.backupTenancyTypeToEnum=f,l.transformBackupDataForLS=g,l.updateBackupsTableWithTransformedData=h,l.processBackupDataGraphQL=y}),98);
__d("EBSMMainthreadAPI",["EBDeps","EBMainThreadEBDBApiDeferred","EBSMWorkerThreadAPI","I64","IGDWebUtils","LSIntEnum","MAWBridgeSendAndReceive","MAWWaitForBackendSetup","MWChatEncryptedBackupsQPLEvents","QPLFlow","ReQL","justknobx","qpl","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("EBAddDeviceWithRecoveryCode").__setRef("EBSMMainthreadAPI"),c=r("requireDeferred")("EBOtcAddDevice").__setRef("EBSMMainthreadAPI"),d=babelHelpers.extends({},r("EBSMWorkerThreadAPI"),{addDeviceWithRecoveryCode:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length===0||t[0]==null)return Promise.reject("Missing args");if(o("EBMainThreadEBDBApiDeferred").trackOverprompting(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent),!o("IGDWebUtils").isOnInstagramWeb()&&t.length>0&&t[0]!=null)return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","addDeviceWithRecoveryCodeInWorker",{recoveryCode:t[0].recoveryCode,userId:t[0].userId});var a=o("QPLFlow").startQPLFlow(r("qpl")._(521473756,"2768"),{annotations:{bool:{isBackendSetupOnStart:o("MAWWaitForBackendSetup").isBackendSetupSuccessful(),isEBAddDeviceWithKeys:!1,isInWorker:!1}},timeoutInMs:r("justknobx")._("2444")});return u.load().then(function(e){return e.addDeviceWithRecoveryCode(babelHelpers.extends({},t[0],{qplFlow:a}))})},addVirtualDevice:async function(t){var e=t.actionType,n=await m();return n==null?Promise.reject("Missing recovery code data for addVirtualDevice"):o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","addVirtualDeviceInWorker",{actionType:e,recoveryCodeData:n})},deleteEncryptedBackup:function(t){var e=t.reason;return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","ebDeleteEncryptedBackupInWorker",{reason:e})},ebOptOut:function(){return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","ebOptOutInWorker",{})},fetchBackupIds:function(t,n){return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","fetchBackupIdsInWorker",{source:t})},initializeBackup:async function(n){var t=n.virtualDeviceType,r=(e||(e=o("I64"))).equal(t,(s||(s=o("LSIntEnum"))).ofNumber(16)),a=r?null:await m();return a==null&&!r?Promise.reject("Missing recovery code data for initializeBackup"):(a!=null&&p(),o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","initializeBackupInWorker",{recoveryCodeData:a,virtualDeviceType:t}))},otcAddDevice:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>0&&t[0]!=null)return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","addDeviceWithOtcInWorker",{initiatorId:t[0].initiatorId,secrets:t[0].secrets});var a=o("QPLFlow").startQPLFlow(r("qpl")._(521473756,"2768"),{annotations:{bool:{isBackendSetupOnStart:o("EBDeps").getDeps().isBackendSetupSuccessful(),isEBAddDeviceWithKeys:!1,isInWorker:!1,isOtc:!0}},timeoutInMs:r("justknobx")._("2444")});return c.load().then(function(e){return e.otcAddDevice(babelHelpers.extends({},t[0],{qplFlow:a}))})},revokeVirtualDevice:function(t){var e=t.virtualDeviceId;return o("MAWBridgeSendAndReceive").sendAndReceive("ebsmapi","revokeVirtualDeviceInWorker",{virtualDeviceId:e})}});async function m(){var e=await o("EBDeps").getDeps().getLSDB(),t=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.tables.secure_encrypted_backups_generated_recovery_code));if(t.length===0)return Promise.resolve(null);var n=t[0];return Promise.resolve({cloud_service_account:n.cloudServiceAccount,hsm_pin_normalization_status:n.hsmPinNormalizationStatus,recovery_code:n.recoveryCode,security_question_type:null,trusted_contact_id:null,virtual_device_type:n.virtualDeviceType})}async function p(){var e=await o("EBDeps").getDeps().getLSDB();return e.runInTransaction(async function(e){for(var t=e.secure_encrypted_backups_generated_recovery_code,n=t.entries(new WeakMap),r=await n.next();!r.done;)await t.delete.apply(t,r.value[0]),r=await n.next()},"readwrite")}var _=d;l.default=_}),98);
__d("EBWorkerODSEntityName.enum",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({MW_EBSM_HYDRATION:"mw_ebsm_hydration",MW_EBSM_IDB:"mw_eb_ebsm_idb",MW_EBSM_CORRUPTION:"mw_ebsm_corruption",MW_EBSM_RESTORE_PERSISTENCE_ERROR:"mw_ebsm_restore_persistence",MW_EBSM_IDB_TABLE_DELETION:"mw_ebsm_idb_table_deletion",MW_EB_AUTO_RESTORE_MAIN_THREAD:"mw_eb_auto_restore_main_thread",MW_EB_AUTO_RESTORE_WORKER:"mw_eb_auto_restore_worker",MW_EB_DEVICE_MIGRATION_WORKER:"mw_eb_device_migration_worker",MW_EB_OTC_MAIN_THREAD:"mw_eb_otc_main_thread",EB_WORKER_ADD_DEVICE_WITH_KEYS:"eb_worker_add_device_with_keys",EB_WORKER_ADD_DEVICE_WITH_RC:"eb_worker_add_device_with_rc",EB_WORKER_OPT_OUT:"eb_worker_opt_out"}),l=e;i.default=l}),66);
__d("EbFetchTimeoutMsForMLv2",["justknobx"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("justknobx")._("3074")}l.default=e}),98);
__d("EncryptedBackupdDYIFileSaver",["requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("file-saver").__setRef("EncryptedBackupdDYIFileSaver");function s(t,n){e.onReadyImmediately(function(e){var r=e.saveAs;r(n,t)})}l.saveFile=s}),98);
__d("FBNucleusArrowsCircleFilled24Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"M2.75 12a9.25 9.25 0 0 1 16.07-6.25H18a1.25 1.25 0 1 0 0 2.5h3.5a1.75 1.75 0 0 0 1.75-1.75V3a1.25 1.25 0 1 0-2.5 0v1.158A11.722 11.722 0 0 0 12 .25C5.51.25.25 5.51.25 12a1.25 1.25 0 1 0 2.5 0zm21 0a1.25 1.25 0 1 0-2.5 0 9.25 9.25 0 0 1-16.07 6.25H6a1.25 1.25 0 1 0 0-2.5H2.5A1.75 1.75 0 0 0 .75 17.5V21a1.25 1.25 0 1 0 2.5 0v-1.158A11.722 11.722 0 0 0 12 23.75c6.49 0 11.75-5.26 11.75-11.75z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=24,u._isSVG=!0;var c=u;l.default=c}),98);
__d("FBNucleusDots3HorizontalFilled20Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"M2.25 10a1.75 1.75 0 1 1 3.5 0 1.75 1.75 0 0 1-3.5 0zM10 8.25a1.75 1.75 0 1 0 0 3.5 1.75 1.75 0 0 0 0-3.5zm6 0a1.75 1.75 0 1 0 0 3.5 1.75 1.75 0 0 0 0-3.5z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=20,u._isSVG=!0;var c=u;l.default=c}),98);
__d("FBNucleusTextFilled20Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"m8.635 12.75 1.19 2.882a1 1 0 0 0 1.849-.764L7.386 4.487c-.51-1.237-2.262-1.237-2.773 0L.326 14.868a1 1 0 1 0 1.848.764l1.19-2.882h5.271zm-.826-2H4.19L6 6.37l1.81 4.38zm10.941-2.5a1 1 0 0 1 1 1v6a1 1 0 0 1-1.911.412 4 4 0 1 1 0-6.824 1 1 0 0 1 .911-.588zm-1 4a2 2 0 1 0-4 0 2 2 0 0 0 4 0z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=20,u._isSVG=!0;var c=u;l.default=c}),98);
__d("FDSArrowsCircleFilled24PNGIcon.react",["ix","fbicon"],(function(t,n,r,o,a,i,l,s){"use strict";var e=o("fbicon")._(s("538038"),24),u=e;l.default=u}),98);
__d("FDSDots3HorizontalFilled20Icon",["cr:14854"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:14854")}),98);
__d("FDSDots3HorizontalFilled20PNGIcon.react",["ix","fbicon"],(function(t,n,r,o,a,i,l,s){"use strict";var e=o("fbicon")._(s("484387"),20),u=e;l.default=u}),98);
__d("FDSTextFilled20Icon",["cr:15777"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:15777")}),98);
__d("FDSTextFilled20PNGIcon.react",["ix","fbicon"],(function(t,n,r,o,a,i,l,s){"use strict";var e=o("fbicon")._(s("486064"),20),u=e;l.default=u}),98);
__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=new t.Map,r[0].set("bump_timestamp_ms",e[1]),r[0].set("thread_key",e[0]),r[0].set("bumped_by_local_device_send",e[2]),r[0].set("tam_thread_subtype",t.i64.cast([0,0])),r[0].set("wa_jid",void 0),r[0].set("message_ephemeral_duration_in_sec",t.i64.cast([0,0])),r[0].set("message_product_type",void 0),r[0].set("is_message_deletion",!1),r[0].set("is_unbump",e[3]),r[1]=r[0].get("thread_key"),t.storedProcedure(n("LSCancelTaskByQueueName"),t.i64.to_string(r[1]),t.i64.cast([0,389]))},function(o){return r[2]=new t.Map,r[2].set("bump_timestamp_ms",e[1]),r[2].set("thread_key",e[0]),r[2].set("bumped_by_local_device_send",e[2]),r[2].set("tam_thread_subtype",t.i64.cast([0,0])),r[2].set("wa_jid",void 0),r[2].set("message_ephemeral_duration_in_sec",t.i64.cast([0,0])),r[2].set("message_product_type",void 0),r[2].set("is_message_deletion",!1),r[2].set("is_unbump",e[3]),r[3]=r[2].get("thread_key"),r[4]=t.toJSON(r[2]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[3]),t.i64.cast([0,389]),r[4],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSE2EEMessagingMetadataMailboxBumpE2EEMetadataThreadStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSBumpE2EEMetadataThreadStoredProcedure",["LSBumpE2EEMetadataThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSBumpE2EEMetadataThread"),a.threadKey,a.serverAuthoritativeTimestampMs,a.bumpedByLocalDeviceSend,a.isUnbump);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSCreateE2EEMetadataThread",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsEncryptionVersionSecure","LSIssueNewTask","LSLogMebClientEvent.nop","LSQplAnnotateInt.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][createE2EEMetadataThread] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[19]=new t.Map,r[19].set("error_msg","Expected a nonempty query result"),r[19].set("code",t.i64.cast([0,3])),r[19].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[20]=t.createArray(),r[21]=(r[20].push(r[19]),r[20]),o=[void 0,r[20]],r[2]=o[0],r[3]=o[1]):(n=l.item,r[19]=new t.Map,r[19].set("backup_id",n.backupId),r[19].set("device_public_key_blob",n.devicePublicKeyBlob),r[19].set("device_private_key_blob",n.devicePrivateKeyBlob),r[19].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[19].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[19].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[19].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[19].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[19].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[19].set("orf_client_state_v2_blob",void 0),r[19].set("orf_v2_authority_level",void 0),r[19].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[19].set("device_id",n.deviceId),r[19].set("backup_tenancy",n.backupTenancy),r[19].set("encryption_version",n.encryptionVersion),r[19].set("revision_version",n.revisionVersion),r[19].set("initialize_restore_result",void 0),r[19].set("device_creation_timestamp_sec",void 0),r[19].set("authority_level",n.authorityLevel),a=[r[19],void 0],r[2]=a[0],r[3]=a[1])})},function(e){return r[5]=new t.Map,r[5].set("value",r[2]),r[5].set("errors",r[3]),r[6]=r[5].get("value"),r[6]!==void 0?t.sequence([function(e){return r[19]=r[6].get("backup_id"),r[20]=r[6].get("device_public_key_blob"),r[21]=r[6].get("device_private_key_blob"),r[22]=r[6].get("epoch_storage_public_key_blob"),r[23]=r[6].get("epoch_storage_private_key_blob"),r[24]=r[6].get("epoch_auth_public_key_blob"),r[25]=r[6].get("epoch_auth_private_key_blob"),r[26]=r[6].get("mailbox_root_key_blob"),r[27]=r[6].get("ocmf_client_state_blob"),r[28]=r[6].get("orf_client_state_v2_blob"),r[29]=r[6].get("orf_v2_authority_level"),r[30]=r[6].get("oblivious_validation_token_blob"),r[31]=r[6].get("device_id"),r[32]=r[6].get("backup_tenancy"),r[33]=r[6].get("encryption_version"),r[34]=r[6].get("revision_version"),r[35]=r[6].get("initialize_restore_result"),r[36]=r[6].get("device_creation_timestamp_sec"),r[37]=r[6].get("authority_level"),t.i64.neq(r[31],void 0)?t.sequence([function(e){return r[39]=void 0,t.i64.neq(r[39],void 0)?t.resolve(r[40]=r[39]):t.sequence([function(e){return r[52]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[53]=t[0],t})},function(e){return r[53]&&(r[62]=(r[52].push(t.i64.cast([0,0])),r[52])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[54]=t[0],t})},function(e){return r[54]&&(r[62]=(r[52].push(t.i64.cast([0,2])),r[52])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[55]=t[0],t})},function(e){return r[55]&&(r[62]=(r[52].push(t.i64.cast([0,3])),r[52])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[56]=t[0],t})},function(e){return r[56]&&(r[62]=(r[52].push(t.i64.cast([0,4])),r[52])),r[57]=t.createArray(),r[58]=t.i64.of_int32(r[52].length),t.i64.gt(r[58],t.i64.cast([0,0]))?t.loopAsync(r[58],function(e){return r[62]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[52],r[62]).then(function(e){var t;return t=e,r[63]=t[0],r[64]=t[1],t})},function(e){return r[65]=(r[57].push(r[63]),r[57])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[62]=t.createArray(),r[63]=t.i64.of_int32(r[57].length),t.i64.gt(r[63],t.i64.cast([0,0]))?t.loopAsync(r[63],function(e){return r[65]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[57],r[65]).then(function(e){var t;return t=e,r[66]=t[0],r[67]=t[1],t})},function(e){return r[68]=(r[62].push(t.i64.to_string(r[66])),r[62])}])}):t.resolve()},function(e){return r[64]=r[62].join(","),r[59]=r[64]}])},function(e){return r[57].some(function(e){return t.i64.eq(r[33],e)})?r[60]=r[33]:r[60]=void 0,t.i64.neq(r[60],void 0)?r[61]=r[60]:r[61]=void 0,r[40]=r[61]}])},function(e){return t.i64.neq(r[40],void 0)?r[41]=r[40]:r[41]=t.i64.cast([0,0]),t.i64.neq(r[32],void 0)?r[42]=r[32]:r[42]=t.i64.cast([0,1]),t.nativeOperation(n("LSBase64Encode.nop"),r[27]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[26]).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return r[45]=new t.Map,r[45].set("ocmf_client_state_blob",r[43]==null?"":r[43]),r[45].set("mailbox_root_key",r[44]==null?"":r[44]),r[46]=t.createArray(),t.forEach(t.filter(t.db.table(169).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}),function(e){var t=e.item;return r[52]=(r[46].push(t.epochId),r[46])})},function(e){return r[50]="Queried locally available epochs. Count: ",r[47]=t.i64.of_int32(r[46].length),r[51]=t.i64.to_string(r[47]),r[48]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochClientUtils] ",r[48],r[50],r[48],r[51]].join("")),t.resolve()},function(e){return r[49]=new t.Map,r[49].set("device_id",r[31]),r[49].set("raw_tokens",r[45]),r[49].set("locally_available_epochs",r[46]),r[38]=r[49]}]):t.resolve(r[38]=void 0)},function(e){return r[7]=r[38]}]):t.resolve((r[19]=r[5].get("errors"),r[20]=r[5].get("errors"),r[7]=void 0))},function(e){return r[8]=t.i64.random(),r[9]=t.i64.to_string(r[8]),r[9]!==void 0?t.nativeOperation(n("LSQplStartTrace.nop"),t.i64.cast([0,679677570]),r[9],!0,void 0):t.resolve()},function(e){return r[9]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679677570]),r[9],"issue_task"):t.resolve()},function(e){return r[9]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679677570]),r[9],"request_type","THREAD_POINT_QUERY"):t.resolve()},function(e){return r[9]!==void 0?t.nativeOperation(n("LSQplAnnotateInt.nop"),t.i64.cast([0,679677570]),r[9],"task_creation_source",t.i64.cast([0,76])==null?t.i64.cast([-1,4294967295]):t.i64.cast([0,76])):t.resolve()},function(o){return r[10]=new t.Map,r[10].set("wa_jid",e[0]),r[10].set("offline_thread_key",e[1]),r[10].set("thread_type",e[2]),r[10].set("folder_type",e[3]),r[10].set("bump_timestamp_ms",e[4]),r[10].set("tam_thread_subtype",t.i64.cast([0,0])),r[10].set("created_by_local_device",e[5]),r[10].set("device_context",r[7]),r[10].set("qpl_instance_key",r[9]),r[10].set("should_run_privacy_and_folder_checks",!1),r[10].set("should_only_create_server_thread",!1),r[11]=r[10].get("offline_thread_key"),r[12]=t.toJSON(r[10]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[11]),t.i64.cast([0,388]),r[12],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))},function(e){return r[13]=t.i64.of_float(Date.now()),r[14]=t.i64.random(),r[16]="Finishing execution. Execution time: ",r[17]=t.i64.to_string(t.i64.sub(r[13],r[0])),r[18]=" ms",r[15]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][createE2EEMetadataThread] ",r[15],r[16],r[15],r[17],r[15],r[18]].join("")),t.i64.eq(t.i64.mod_(r[14],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[19]=",",r[20]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"createE2EEMetadataThread",[r[16],r[19],r[17],r[19],r[18]].join(""),r[20],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSE2EEMessagingMetadataMailboxCreateE2EEMetadataThreadStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSCreateE2EEMetadataThreadStoredProcedure",["LSCreateE2EEMetadataThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCreateE2EEMetadataThread"),a.waJid,a.offlineThreadKey,a.threadType,a.folderType,a.bumpTimestampMs,a.createdByLocalDevice);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSCreateOfflineThreadingIDStoredProcedure",["LSCreateOfflineThreadingID","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCreateOfflineThreadingID"),a.timestampMs);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSDataUseConsentState",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNSET:0,CONSENTED:1,WITHDRAWN:2,NOT_APPLICABLE:3,SEEN:4});i.default=e}),66);
__d("LSDecryptPakeSecret",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][decryptPakeSecret] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NO_SESSION_ONGOING_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[12]="PAKE: Failed to decrypt PAKE secrets as no session was ongoing.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,7]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[12]].join("")),r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[12]].join(""),r[13],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[2]=n[0],r[3]=n[1],n}]):(a=l.item,t.sequence([function(o){return r[13]=a.responderId,r[14]=a.initiatorId,r[15]=a.pakeSecret,r[13]!==void 0?t.sequence([function(o){return r[14]!==void 0?t.sequence([function(o){return r[15]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_GENERATE_PAKE_AAD_START",t.i64.cast([0,0]),void 0)},function(e){return r[20]="_",t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NATIVE_OP_START",t.i64.cast([0,0]),void 0)},function(o){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[1],t.blobs.of_string(["v1",r[20],t.i64.to_string(e[0]),r[20],r[13],r[20],r[14],r[20],t.i64.to_string(a.clientType)].join("")),r[15]).then(function(e){var t;return t=e,r[21]=t[0],t})},function(o){var a;return r[21]!==void 0?t.resolve((a=[r[21],t.i64.cast([0,0])],r[22]=a[0],r[23]=a[1],a)):t.sequence([function(e){return r[25]="PAKE: Failed to decrypt PAKE secrets as key was incorrect.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,10]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,10]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,10])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[25]].join("")),r[26]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[25]].join(""),r[26],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967295])],r[22]=n[0],r[23]=n[1],n}])},function(e){var t;return t=[r[22],r[23]],r[18]=t[0],r[19]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_PAKE_SECRET_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[21]="PAKE: Failed to decrypt PAKE secrets as there was no secret to decrypt.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[21]].join("")),r[22]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[21]].join(""),r[22],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[18]=n[0],r[19]=n[1],n}])},function(e){var t;return t=[r[18],r[19]],r[16]=t[0],r[17]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_INITIATOR_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[19]="PAKE: Failed to decrypt PAKE secrets as initiator id was null.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[19]].join("")),r[20]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[19]].join(""),r[20],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[16]=n[0],r[17]=n[1],n}])},function(e){var t;return t=[r[16],r[17]],r[11]=t[0],r[12]=t[1],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_RESPONDER_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return r[17]="PAKE: Failed to decrypt PAKE secrets as responder id was null.",t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[2])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[2]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})},function(e){return(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",r[17]].join("")),r[18]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[r[17]].join(""),r[18],t.i64.cast([0,3]))},function(e){var n;return n=[void 0,t.i64.cast([-1,4294967294])],r[11]=n[0],r[12]=n[1],n}])},function(e){var t;return t=[r[11],r[12]],r[2]=t[0],r[3]=t[1],t}]))})},function(e){return r[5]=t.i64.of_float(Date.now()),r[6]=t.i64.random(),r[8]="Finishing execution. Execution time: ",r[9]=t.i64.to_string(t.i64.sub(r[5],r[0])),r[10]=" ms",r[7]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][decryptPakeSecret] ",r[7],r[8],r[7],r[9],r[7],r[10]].join("")),t.i64.eq(t.i64.mod_(r[6],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[11]=",",r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"decryptPakeSecret",[r[8],r[11],r[9],r[11],r[10]].join(""),r[12],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesDecryptPakeSecretStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSDecryptPakeSecretStoredProcedure",["LSDecryptPakeSecret","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSDecryptPakeSecret"),a.sessionId,a.encryptionKey,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSFetchAccountSyncedFields",["LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return r[0]=new t.Map,r[1]=t.toJSON(r[0]),t.storedProcedure(n("LSIssueNewTask"),"fetch_account_synced_fields",t.i64.cast([0,160021]),r[1],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))},function(e){return t.resolve(o)}])}e.__sproc_name__="LSAccountSettingsFetchAccountSyncedFieldsStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSFetchAccountSyncedFieldsStoredProcedure",["LSFetchAccountSyncedFields","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t){var a=t.storedProcedure(r("LSFetchAccountSyncedFields"));return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}l.default=s}),98);
__d("LSFetchBackupsMetadata",["LSAppendDataTraceAddon","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(e){return t.sequence([function(e){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] Beginning execution."),r("justknobx")._("1101")?t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[9]=t[0],t})},function(e){return o[9]?o[10]=!0:o[10]=!1,o[10]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[12]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[12]].join("")),o[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[12],o[11],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.forEach(t.db.table(196).fetch(),function(e){return e.delete()})},function(e){return t.db.table(172).fetch([[[t.i64.cast([0,1])]]]).next().then(function(e,t){var n=e.done,r=e.value;return n?o[7]=void 0:(t=r.item,o[7]=t.backupId)})},function(e){return t.i64.neq(o[7],void 0)?t.sequence([function(e){return t.forEach(t.filter(t.db.table(196).fetch([[[o[7]]]]),function(e){return t.i64.eq(e.backupId,o[7])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(196).add({backupId:o[7],authorityLevel:t.i64.cast([0,20]),backupSize:t.i64.cast([0,0]),creationTime:t.i64.cast([0,0]),lastSyncTime:t.i64.cast([0,0])})},function(e){return o[9]=new t.Map,o[9].set("trace_id",void 0),o[10]=t.toJSON(o[9]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50022]),o[10],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[11]=t[0],t})}]):t.sequence([function(e){return o[9]="Backup is not initialized",o[9]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] ","",o[9]].join("")),o[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupsMetadataStoredProcedure",o[9],o[10],t.i64.cast([0,3]))):t.resolve()},function(e){return t.forEach(t.db.table(196).fetch(),function(e){return e.delete()})},function(e){return t.forEach(t.filter(t.db.table(196).fetch([[[t.i64.cast([-1,4294967295])]]]),function(e){return t.i64.eq(e.backupId,t.i64.cast([-1,4294967295]))&&t.i64.lt(e.authorityLevel,t.i64.cast([0,80]))}),function(e){return e.delete()})},function(e){return t.db.table(196).add({backupId:t.i64.cast([-1,4294967295]),authorityLevel:t.i64.cast([0,80]),backupSize:t.i64.cast([-1,4294967295]),creationTime:t.i64.cast([-1,4294967295]),lastSyncTime:t.i64.cast([-1,4294967295])})}])}]):t.resolve((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] is_backup_metadata_enabled is disabled"))},function(e){return o[1]=t.i64.of_float(Date.now()),o[2]=t.i64.random(),o[4]="Finishing execution. Execution time: ",o[5]=t.i64.to_string(t.i64.sub(o[1],o[0])),o[6]=" ms",o[3]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] ",o[3],o[4],o[3],o[5],o[3],o[6]].join("")),t.i64.eq(t.i64.mod_(o[2],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[7]=",",o[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupsMetadataStoredProcedure",[o[4],o[7],o[5],o[7],o[6]].join(""),o[8],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsFetchBackupsMetadataStoredProcedure",e.__tables__=["encrypted_backups_metadata","encrypted_backups"];var s=e;l.default=s}),98);
__d("LSFetchBackupsMetadataStoredProcedure",["LSFetchBackupsMetadata","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){a===void 0&&(a={});var i=t.storedProcedure(r("LSFetchBackupsMetadata"),a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSFetchOTCEligibleEBDevicesV2",["LSIssueNewEbTaskAndGetTaskIDV2"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return t.forEach(t.db.table(261).fetch(),function(e){return e.delete()})},function(e){return r[0]="",t.forEach(t.filter(t.db.table(261).fetch([[[r[0]]]]),function(e){return e.deviceId===r[0]&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(261).add({deviceId:r[0],authorityLevel:t.i64.cast([0,20])})},function(e){return r[1]=new t.Map,r[2]=t.toJSON(r[1]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_fetch_otc_eligible_devices",t.i64.cast([0,50028]),r[2],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[3]=t[0],t})}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsFetchOTCEligibleEBDevicesV2StoredProcedure",e.__tables__=["encrypted_backups_otc_devices"],a.exports=e}),null);
__d("LSFetchOTCEligibleEBDevicesV2StoredProcedure",["LSFetchOTCEligibleEBDevicesV2","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t){var a=t.storedProcedure(r("LSFetchOTCEligibleEBDevicesV2"));return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}l.default=s}),98);
__d("LSGetActiveSession",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][getActiveSession] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.count(t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.messageType,t.i64.cast([0,0]))&&t.i64.eq(n.clientType,e[1])&&n.initiatorId===void 0||t.i64.eq(n.clientType,e[1])&&n.initiatorId===e[0]&&![t.i64.cast([0,1]),t.i64.cast([0,2]),t.i64.cast([0,3]),t.i64.cast([0,4]),t.i64.cast([0,21]),t.i64.cast([0,15]),t.i64.cast([0,23])].some(function(e){return t.i64.eq(n.messageType,e)})&&t.i64.neq(n.sessionId,t.i64.cast([-1,4294967295]))})).then(function(e){return r[2]=e})},function(o){return t.i64.le(r[2],t.i64.cast([0,1]))?t.sequence([function(o){return t.filter(t.db.table(258).fetch(),function(n){return t.i64.eq(n.messageType,t.i64.cast([0,0]))&&t.i64.eq(n.clientType,e[1])&&n.initiatorId===void 0||t.i64.eq(n.clientType,e[1])&&n.initiatorId===e[0]&&![t.i64.cast([0,1]),t.i64.cast([0,2]),t.i64.cast([0,3]),t.i64.cast([0,4]),t.i64.cast([0,21]),t.i64.cast([0,15]),t.i64.cast([0,23])].some(function(e){return t.i64.eq(n.messageType,e)})&&t.i64.neq(n.sessionId,t.i64.cast([-1,4294967295]))}).next().then(function(e,o){var a=e.done,i=e.value;return a?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,17]))},function(e){var n;return n=[t.i64.cast([-1,4294967295]),void 0,void 0],r[12]=n[0],r[13]=n[1],r[14]=n[2],n}]):(o=i.item,t.sequence([function(e){var a;return r[19]=o.responderId,r[19]!==void 0?t.resolve((a=[t.i64.cast([0,0]),o.sessionId,r[19]],r[16]=a[0],r[17]=a[1],r[18]=a[2],a)):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"PAKE_DS_SESSION_ONGOING_RESPONDER_ID_NULL_FAILURE",t.i64.cast([0,0]),void 0)},function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(e){var n;return n=[t.i64.cast([-1,4294967294]),void 0,void 0],r[16]=n[0],r[17]=n[1],r[18]=n[2],n}])},function(e){var t;return t=[r[16],r[17],r[18]],r[12]=t[0],r[13]=t[1],r[14]=t[2],t}]))})},function(e){var t;return t=[r[12],r[13],r[14]],r[3]=t[0],r[4]=t[1],r[5]=t[2],t}]):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,18]))},function(e){var n;return n=[t.i64.cast([-1,4294967294]),void 0,void 0],r[3]=n[0],r[4]=n[1],r[5]=n[2],n}])},function(e){return r[6]=t.i64.of_float(Date.now()),r[7]=t.i64.random(),r[9]="Finishing execution. Execution time: ",r[10]=t.i64.to_string(t.i64.sub(r[6],r[0])),r[11]=" ms",r[8]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][getActiveSession] ",r[8],r[9],r[8],r[10],r[8],r[11]].join("")),t.i64.eq(t.i64.mod_(r[7],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[12]=",",r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"getActiveSession",[r[9],r[12],r[10],r[12],r[11]].join(""),r[13],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[3],r[4],r[5]],o[0]=t[0],o[1]=t[1],o[2]=t[2],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesGetActiveSessionStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSGetActiveSessionStoredProcedure",["LSGetActiveSession","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSGetActiveSession"),a.initiatorId,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSIssueAttachmentRestoreTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSBinaryToHex.nop","LSCreateDerivedKeys.nop","LSFindBackup","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIssueNewTask","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSQplAnnotateString.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop","LSTruncateSortKey.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] Beginning execution."),e[7]!==void 0?t.resolve(r[1]=e[7]):t.sequence([function(e){return r[28]=t.i64.random(),r[29]=t.i64.to_string(r[28]),r[29]!==void 0?t.nativeOperation(n("LSQplStartTrace.nop"),t.i64.cast([0,679684335]),r[29],!0,void 0):t.resolve()},function(e){return r[1]=r[29]}])},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,679684335]),r[1],"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure_start"):t.resolve()},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,o){var a,i=e.done,l=e.value;return i?(a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,20]),void 0,void 0],r[2]=a[0],r[3]=a[1],r[4]=a[2],r[5]=a[3],r[6]=a[4],r[7]=a[5],r[8]=a[6],r[9]=a[7],r[10]=a[8],r[11]=a[9],r[12]=a[10],r[13]=a[11],r[14]=a[12],r[15]=a[13],r[16]=a[14],r[17]=a[15],r[18]=a[16],r[19]=a[17],a):(o=l.item,t.sequence([function(e){return r[33]=o.backupTenancy,r[32]=o.encryptionVersion,r[28]=void 0,t.i64.neq(r[28],void 0)?t.resolve(r[29]=r[28]):t.sequence([function(e){return r[34]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[35]=t[0],t})},function(e){return r[35]&&(r[44]=(r[34].push(t.i64.cast([0,0])),r[34])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[36]=t[0],t})},function(e){return r[36]&&(r[44]=(r[34].push(t.i64.cast([0,2])),r[34])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[37]=t[0],t})},function(e){return r[37]&&(r[44]=(r[34].push(t.i64.cast([0,3])),r[34])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[38]=t[0],t})},function(e){return r[38]&&(r[44]=(r[34].push(t.i64.cast([0,4])),r[34])),r[39]=t.createArray(),r[40]=t.i64.of_int32(r[34].length),t.i64.gt(r[40],t.i64.cast([0,0]))?t.loopAsync(r[40],function(e){return r[44]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[34],r[44]).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return r[47]=(r[39].push(r[45]),r[39])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[44]=t.createArray(),r[45]=t.i64.of_int32(r[39].length),t.i64.gt(r[45],t.i64.cast([0,0]))?t.loopAsync(r[45],function(e){return r[47]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[39],r[47]).then(function(e){var t;return t=e,r[48]=t[0],r[49]=t[1],t})},function(e){return r[50]=(r[44].push(t.i64.to_string(r[48])),r[44])}])}):t.resolve()},function(e){return r[46]=r[44].join(","),r[41]=r[46]}])},function(e){return r[39].some(function(e){return t.i64.eq(r[32],e)})?r[42]=r[32]:r[42]=void 0,t.i64.neq(r[42],void 0)?r[43]=r[42]:r[43]=void 0,r[29]=r[43]}])},function(e){var n;return t.i64.neq(r[29],void 0)?r[30]=r[29]:r[30]=t.i64.cast([0,0]),t.i64.neq(r[33],void 0)?r[31]=r[33]:r[31]=t.i64.cast([0,1]),n=[o.backupId,o.deviceId,o.mailboxRootKeyBlob,o.ocmfClientStateBlob,void 0,void 0,r[30],r[31],o.epochAuthPublicKeyBlob,o.epochAuthPrivateKeyBlob,o.devicePublicKeyBlob,o.devicePrivateKeyBlob,o.epochStoragePublicKeyBlob,o.epochStoragePrivateKeyBlob,o.obliviousValidationTokenBlob,o.authorityLevel,void 0,void 0],r[2]=n[0],r[3]=n[1],r[4]=n[2],r[5]=n[3],r[6]=n[4],r[7]=n[5],r[8]=n[6],r[9]=n[7],r[10]=n[8],r[11]=n[9],r[12]=n[10],r[13]=n[11],r[14]=n[12],r[15]=n[13],r[16]=n[14],r[17]=n[15],r[18]=n[16],r[19]=n[17]}]))})},function(e){return t.storedProcedure(n("LSFindBackup")).then(function(e){var t;return t=e,r[21]=t[0],t})},function(o){return t.blobs.neq(r[5],void 0)?t.i64.neq(r[3],void 0)?r[21]!==void 0?t.blobs.neq(r[4],void 0)?t.sequence([function(o){return r[28]=t.createArray(),r[35]=(r[28].push(r[21]),r[28]),r[35]=(r[28].push(e[1]),r[28]),r[29]=t.toJSON(r[28]),r[30]=t.createArray(),r[35]=(r[30].push(t.i64.cast([0,32])),r[30]),t.nativeOperation(n("LSGetBlobFromString.nop"),["thread_ope_key","_",e[5]].join("")).then(function(e){var t;return t=e,r[31]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[31],void 0,r[4],r[30]).then(function(e){var t;return t=e,r[32]=t[0],t})},function(e){return r[32]?r[33]=!1:r[33]=!0,r[33]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),r[36]="Got null keys while deriving message list OPE key. Returning null blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[36]].join("")),r[35]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[36],r[35],t.i64.cast([0,3]))},function(e){return r[34]=void 0}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[32],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[35]=t[0],r[36]=t[1],t})},function(e){return r[34]=r[35]}])},function(o){return t.blobs.neq(r[34],void 0)?t.sequence([function(o){return t.i64.neq(e[9],void 0)?r[35]=e[9]:r[35]=t.i64.cast([-1,4294967295]),t.nativeOperation(n("LSGetBlobFromInt64BE.nop"),e[6]).then(function(e){var t;return t=e,r[36]=t[0],t})},function(e){return t.nativeOperation(n("LSTruncateSortKey.nop"),r[36]).then(function(e){var t;return t=e,r[37]=t[0],t})},function(e){return t.nativeOperation(n("LSOpeEncrypt.nop"),r[34],r[37],t.i64.cast([0,16])).then(function(e){var t;return t=e,r[38]=t[0],t})},function(e){return t.nativeOperation(n("LSBinaryToHex.nop"),r[38]).then(function(e){var t;return t=e,r[39]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),r[29]).then(function(e){var t;return t=e,r[40]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("YXR0YWNobWVudF9rZXlfc2NvcGU="),r[40]).then(function(e){var t;return t=e,r[41]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[41]).then(function(e){var t;return t=e,r[42]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[42]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),r[21]).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWFpbGJveF9pZF9zY29wZQ=="),r[44]).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[45]).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[46]).then(function(e){var t;return t=e,r[47]=t[0],t})},function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),e[4]).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWVzc2FnZV9pZF9zY29wZQ=="),r[48]).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[49]).then(function(e){var t;return t=e,r[50]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[50]).then(function(e){var t;return t=e,r[51]=t[0],t})},function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),e[4]).then(function(e){var t;return t=e,r[52]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),r[52]).then(function(e){var t;return t=e,r[53]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[53]).then(function(e){var t;return t=e,r[54]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[54]).then(function(e){var t;return t=e,r[55]=t[0],t})},function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),e[5]).then(function(e){var t;return t=e,r[56]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("dGhyZWFkX2lkX3Njb3Bl"),r[56]).then(function(e){var t;return t=e,r[57]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[57]).then(function(e){var t;return t=e,r[58]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[58]).then(function(e){var t;return t=e,r[59]=t[0],t})},function(o){return r[60]=new t.Map,r[60].set("attachment_index_key",r[43]==null?"":r[43]),r[60].set("backup_ent_fbid",e[0]),r[60].set("delivery_object_id",e[1]),r[60].set("device_id",r[3]),r[60].set("mailbox_partial_id",r[47]==null?"":r[47]),r[60].set("media_type",e[3]),r[60].set("message_partial_id",r[51]==null?"":r[51]),r[60].set("product_type",e[2]),r[60].set("salt_partial_id",r[55]==null?"":r[55]),r[60].set("sort_key",r[39]==null?"":r[39]),r[60].set("thread_partial_id",r[59]==null?"":r[59]),r[60].set("trace_id",r[1]),r[60].set("source",r[35]),r[61]=new t.Map,r[61].set("otid",e[4]),r[61].set("server_thread_key",e[8]),r[61].set("timestamp",t.i64.to_string(e[6])),t.nativeOperation(n("LSBase64Encode.nop"),r[5]).then(function(e){var t;return t=e,r[62]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[4]).then(function(e){var t;return t=e,r[63]=t[0],t})},function(o){return r[64]=new t.Map,r[64].set("ocmf_client_state_blob",r[62]==null?"":r[62]),r[64].set("mailbox_root_key",r[63]==null?"":r[63]),r[65]=t.createArray(),r[76]=(r[65].push(e[4]),r[65]),r[76]=(r[65].push(e[1]),r[65]),r[66]=t.toJSON(r[65]),r[60].set("raw_identifiers",r[61]),r[60].set("backup_id",r[21]),r[60].set("thread_id",e[5]),t.nativeOperation(n("LSGetBlobFromString.nop"),r[66]).then(function(e){var t;return t=e,r[67]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),r[67]).then(function(e){var t;return t=e,r[68]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[68]).then(function(e){var t;return t=e,r[69]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[69]).then(function(e){var t;return t=e,r[70]=t[0],t})},function(e){return r[60].set("salt_partial_access_token",r[70]==null?"":r[70]),t.nativeOperation(n("LSGetBlobFromString.nop"),r[29]).then(function(e){var t;return t=e,r[71]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("YXR0YWNobWVudF9rZXlfc2FsdF9zY29wZQ=="),r[71]).then(function(e){var t;return t=e,r[72]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[5],r[72]).then(function(e){var t;return t=e,r[73]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[73]).then(function(e){var t;return t=e,r[74]=t[0],t})},function(e){return r[60].set("salt_partial_attachment_index_key",r[74]==null?"":r[74]),r[60].set("raw_tokens",r[64]),r[75]=t.toJSON(r[60]),t.storedProcedure(n("LSIssueNewTask"),"encrypted_backups_attachment_restore",t.i64.cast([0,50020]),r[75],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}]):t.sequence([function(e){return r[37]=["LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",".","OPE_key_is_null"].join(""),r[1]!==void 0&&r[37]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679684335]),r[1],"error",r[37]):t.resolve()},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679684335]),r[1],!1):t.resolve()},function(e){return r[36]="OPE key is null for IssueAttachmentRestoreTask",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",r[36]].join("")),r[35]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",r[36],r[35],t.i64.cast([0,3]))}])}]):t.sequence([function(e){return r[30]=["LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",".","missing_mailbox_root_key"].join(""),r[1]!==void 0&&r[30]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679684335]),r[1],"error",r[30]):t.resolve()},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679684335]),r[1],!1):t.resolve()},function(e){return r[29]="Missing mailbox_root_key for IssueAttachmentRestoreTask",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",r[29]].join("")),r[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",r[29],r[28],t.i64.cast([0,3]))}]):t.sequence([function(e){return r[30]=["LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",".","missing_backup_id"].join(""),r[1]!==void 0&&r[30]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679684335]),r[1],"error",r[30]):t.resolve()},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679684335]),r[1],!1):t.resolve()},function(e){return r[29]="Missing backup_id for IssueAttachmentRestoreTask",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",r[29]].join("")),r[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",r[29],r[28],t.i64.cast([0,3]))}]):t.sequence([function(e){return r[30]=["LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",".","missing_device_id"].join(""),r[1]!==void 0&&r[30]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679684335]),r[1],"error",r[30]):t.resolve()},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679684335]),r[1],!1):t.resolve()},function(e){return r[29]="Missing device_id for IssueAttachmentRestoreTask",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",r[29]].join("")),r[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",r[29],r[28],t.i64.cast([0,3]))}]):t.sequence([function(e){return r[30]=["LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",".","missing_ocmf_client_state_blob"].join(""),r[1]!==void 0&&r[30]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,679684335]),r[1],"error",r[30]):t.resolve()},function(e){return r[1]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,679684335]),r[1],!1):t.resolve()},function(e){return r[29]="Missing ocmf_client_state_blob for IssueAttachmentRestoreTask",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",r[29]].join("")),r[28]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",r[29],r[28],t.i64.cast([0,3]))}])},function(e){return r[22]=t.i64.of_float(Date.now()),r[23]=t.i64.random(),r[25]="Finishing execution. Execution time: ",r[26]=t.i64.to_string(t.i64.sub(r[22],r[0])),r[27]=" ms",r[24]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ",r[24],r[25],r[24],r[26],r[24],r[27]].join("")),t.i64.eq(t.i64.mod_(r[23],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[28]=",",r[29]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",[r[25],r[28],r[26],r[28],r[27]].join(""),r[29],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state"],a.exports=e}),null);
__d("LSIssueAttachmentRestoreTaskStoredProcedure",["LSIssueAttachmentRestoreTask","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSIssueAttachmentRestoreTask"),a.backupEntFbid,a.deliveryObjectId,a.productType,a.mediaType,a.messageId,a.threadId,a.sortOrder,a.traceId,a.serverThreadKey,a.source);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSIssueThreadRemove",["LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][issueThreadRemove] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[15]=new t.Map,r[15].set("error_msg","Expected a nonempty query result"),r[15].set("code",t.i64.cast([0,3])),r[15].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[16]=t.createArray(),r[17]=(r[16].push(r[15]),r[16]),o=[void 0,r[16]],r[2]=o[0],r[3]=o[1]):(n=l.item,r[15]=new t.Map,r[15].set("backup_id",n.backupId),r[15].set("device_public_key_blob",n.devicePublicKeyBlob),r[15].set("device_private_key_blob",n.devicePrivateKeyBlob),r[15].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[15].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[15].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[15].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[15].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[15].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[15].set("orf_client_state_v2_blob",void 0),r[15].set("orf_v2_authority_level",void 0),r[15].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[15].set("device_id",n.deviceId),r[15].set("backup_tenancy",n.backupTenancy),r[15].set("encryption_version",n.encryptionVersion),r[15].set("revision_version",n.revisionVersion),r[15].set("initialize_restore_result",void 0),r[15].set("device_creation_timestamp_sec",void 0),r[15].set("authority_level",n.authorityLevel),a=[r[15],void 0],r[2]=a[0],r[3]=a[1])})},function(o){return r[5]=new t.Map,r[5].set("value",r[2]),r[5].set("errors",r[3]),r[6]=r[5].get("value"),r[6]!==void 0?t.sequence([function(o){return r[15]=r[6].get("backup_id"),r[16]=r[6].get("device_public_key_blob"),r[17]=r[6].get("device_private_key_blob"),r[18]=r[6].get("epoch_storage_public_key_blob"),r[19]=r[6].get("epoch_storage_private_key_blob"),r[20]=r[6].get("epoch_auth_public_key_blob"),r[21]=r[6].get("epoch_auth_private_key_blob"),r[22]=r[6].get("mailbox_root_key_blob"),r[23]=r[6].get("ocmf_client_state_blob"),r[24]=r[6].get("orf_client_state_v2_blob"),r[25]=r[6].get("orf_v2_authority_level"),r[26]=r[6].get("oblivious_validation_token_blob"),r[27]=r[6].get("device_id"),r[28]=r[6].get("backup_tenancy"),r[29]=r[6].get("encryption_version"),r[30]=r[6].get("revision_version"),r[31]=r[6].get("initialize_restore_result"),r[32]=r[6].get("device_creation_timestamp_sec"),r[33]=r[6].get("authority_level"),t.i64.neq(r[27],void 0)?t.sequence([function(e){return r[36]=void 0,t.i64.neq(r[36],void 0)?t.resolve(r[37]=r[36]):t.sequence([function(e){return r[43]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return r[44]&&(r[53]=(r[43].push(t.i64.cast([0,0])),r[43])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return r[45]&&(r[53]=(r[43].push(t.i64.cast([0,2])),r[43])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return r[46]&&(r[53]=(r[43].push(t.i64.cast([0,3])),r[43])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[47]&&(r[53]=(r[43].push(t.i64.cast([0,4])),r[43])),r[48]=t.createArray(),r[49]=t.i64.of_int32(r[43].length),t.i64.gt(r[49],t.i64.cast([0,0]))?t.loopAsync(r[49],function(e){return r[53]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[43],r[53]).then(function(e){var t;return t=e,r[54]=t[0],r[55]=t[1],t})},function(e){return r[56]=(r[48].push(r[54]),r[48])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[53]=t.createArray(),r[54]=t.i64.of_int32(r[48].length),t.i64.gt(r[54],t.i64.cast([0,0]))?t.loopAsync(r[54],function(e){return r[56]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[48],r[56]).then(function(e){var t;return t=e,r[57]=t[0],r[58]=t[1],t})},function(e){return r[59]=(r[53].push(t.i64.to_string(r[57])),r[53])}])}):t.resolve()},function(e){return r[55]=r[53].join(","),r[50]=r[55]}])},function(e){return r[48].some(function(e){return t.i64.eq(r[29],e)})?r[51]=r[29]:r[51]=void 0,t.i64.neq(r[51],void 0)?r[52]=r[51]:r[52]=void 0,r[37]=r[52]}])},function(o){return t.i64.neq(r[37],void 0)?r[38]=r[37]:r[38]=t.i64.cast([0,0]),t.i64.neq(r[28],void 0)?r[39]=r[28]:r[39]=t.i64.cast([0,1]),t.i64.neq(void 0,void 0)?(r[43]=t.i64.of_float(Date.now()),r[40]=t.i64.le(void 0,t.i64.cast([0,0]))?t.i64.cast([0,0]):t.i64.add(void 0,r[43])):(r[43]=t.i64.of_float(Date.now()),r[40]=t.i64.le(t.i64.cast([0,0]),t.i64.cast([0,0]))?t.i64.cast([0,0]):t.i64.add(r[43],t.i64.sub(t.i64.cast([0,0]),t.i64.mod_(r[43],t.i64.cast([0,0]))))),t.storedProcedure(n("LSIssueNewTaskAndGetTaskID"),["eb_upload",":",e[0]].join(""),t.i64.cast([0,50026]),"",void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),t.i64.cast([0,93]),void 0,r[40],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[41]=t[0],t})},function(n){return t.db.table(177).add({pk:void 0,pendingBackupTaskId:r[41],actionType:t.i64.cast([0,2]),contentType:t.i64.cast([0,2]),backupStatus:t.i64.cast([0,1]),listKey:e[0],uniqueKey:e[0],sortKey:e[1],persistentId:"",isInstamadillo:!1,lsTraceId:e[3],error:e[4]})},function(n){return t.i64.eq(t.i64.cast([0,2]),t.i64.cast([0,1]))?t.i64.eq(t.i64.cast([0,2]),t.i64.cast([0,1]))?(r[43]=t.createArray(),r[45]=(r[43].push("Successfully issued message backup task. act thread id = "),r[43]),r[45]=(r[43].push(e[0]),r[43]),r[45]=(r[43].push(", otid = "),r[43]),r[45]=(r[43].push(e[0]),r[43]),r[44]=r[43].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ","",r[44]].join("")),t.resolve()):(r[43]=t.createArray(),r[45]=(r[43].push("Successfully issued message remove task. act thread id = "),r[43]),r[45]=(r[43].push(e[0]),r[43]),r[45]=(r[43].push(", otid = "),r[43]),r[45]=(r[43].push(e[0]),r[43]),r[44]=r[43].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ","",r[44]].join("")),t.resolve()):(r[43]=t.createArray(),r[45]=(r[43].push("Successfully issued thread remove task. act thread id = "),r[43]),r[45]=(r[43].push(e[0]),r[43]),r[44]=r[43].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ","",r[44]].join("")),t.resolve())},function(e){var n;return r[42]=new t.Map,r[42].set("task_id",r[41]),n=[r[42],void 0],r[34]=n[0],r[35]=n[1]}]):t.sequence([function(n){return r[36]=t.createArray(),r[39]=(r[36].push("Skipping thread remove since EB is disabled. act thread id = "),r[36]),r[39]=(r[36].push(e[0]),r[36]),r[37]=r[36].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ","",r[37]].join("")),t.resolve()},function(e){var n;return r[38]=new t.Map,r[38].set("error_code",t.i64.cast([0,24])),r[38].set("stored_procedure","LSEncryptedBackupsIssueThreadRemoveStoredProcedure"),r[38].set("error_message",""),n=[void 0,r[38]],r[34]=n[0],r[35]=n[1]}])},function(e){var t;return t=[r[34],r[35]],r[7]=t[0],r[8]=t[1],t}]):t.sequence([function(n){return r[15]=r[5].get("errors"),r[16]=r[5].get("errors"),r[17]=t.createArray(),r[20]=(r[17].push("Skipping thread remove since EB is disabled. act thread id = "),r[17]),r[20]=(r[17].push(e[0]),r[17]),r[18]=r[17].join(""),(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ","",r[18]].join("")),t.resolve()},function(e){var n;return r[19]=new t.Map,r[19].set("error_code",t.i64.cast([0,1])),r[19].set("stored_procedure","LSEncryptedBackupsIssueThreadRemoveStoredProcedure"),r[19].set("error_message",""),n=[void 0,r[19]],r[7]=n[0],r[8]=n[1]}])},function(e){return r[9]=t.i64.of_float(Date.now()),r[10]=t.i64.random(),r[12]="Finishing execution. Execution time: ",r[13]=t.i64.to_string(t.i64.sub(r[9],r[0])),r[14]=" ms",r[11]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][issueThreadRemove] ",r[11],r[12],r[11],r[13],r[11],r[14]].join("")),t.i64.eq(t.i64.mod_(r[10],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[15]=",",r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"issueThreadRemove",[r[12],r[15],r[13],r[15],r[14]].join(""),r[16],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[7],r[8]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsIssueThreadRemoveStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","pending_backups_context_v2"],a.exports=e}),null);
__d("LSIssueThreadRemoveStoredProcedure",["LSIssueThreadRemove","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSIssueThreadRemove"),a.actThreadId,a.sortKey,a.source,a.traceId,a.error);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticallyUpdateMessagingPrivacySettings",["LSGetViewerFBID","LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[0]=t[0],t})},function(n){return t.forEach(t.db.table(288).fetch([[[r[0]]]]),function(t){var n=t.update,r=t.item;return n({readReceiptsDisabled:e[0]})})},function(o){return r[1]=new t.Map,r[1].set("read_receipts_disabled",e[0]),r[2]=t.toJSON(r[1]),t.storedProcedure(n("LSIssueNewTask"),"toggle_rr",t.i64.cast([0,731]),r[2],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSOmnistoreSettingsOptimisticallyUpdateMessagingPrivacySettingsStoredProcedure",e.__tables__=["messaging_privacy_settings"],a.exports=e}),null);
__d("LSOptimisticallyUpdateMessagingPrivacySettingsStoredProcedure",["LSOptimisticallyUpdateMessagingPrivacySettings","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticallyUpdateMessagingPrivacySettings"),a.readReceiptsDisabled);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSProcessBackupIds",["LSAppendDataTraceAddon","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsProcessBackupIdsStoredProcedure] Beginning execution."),t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1487]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[9]=t[0],t})},function(e){return r[9]?r[10]=!0:r[10]=!1,r[10]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[12]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[12]].join("")),r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[12],r[11],t.i64.cast([0,3]))):t.resolve()}])},function(o){return t.db.table(172).fetch([[[t.i64.cast([0,1])]]]).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1488]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[9]=t[0],t})},function(e){return r[9]?r[10]=!0:r[10]=!1,r[10]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[12]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[12]].join("")),r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[12],r[11],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[1]=t.i64.cast([0,0])}]):(a=l.item,t.sequence([function(o){return r[11]=a.backupId,r[10]=a.authorityLevel,t.i64.eq(r[10],t.i64.cast([0,20]))?t.resolve(r[9]=t.i64.cast([0,1])):t.sequence([function(o){return t.i64.eq(r[10],t.i64.cast([0,80]))?t.sequence([function(o){return t.i64.eq(r[11],void 0)?t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1492]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[14]=t[0],t})},function(e){return r[14]?r[15]=!0:r[15]=!1,r[15]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[17]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[17]].join("")),r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[17],r[16],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[13]=t.i64.cast([0,2])}]):t.sequence([function(o){return t.i64.eq(r[11],t.i64.cast([-1,4294967295]))?t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1489]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[15]=t[0],t})},function(e){return r[15]?r[16]=!0:r[16]=!1,r[16]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[18]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[18]].join("")),r[17]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[18],r[17],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[14]=t.i64.cast([-1,4294967295])}]):t.sequence([function(o){return t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.backupId,r[11])&&t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1490]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return r[17]?r[18]=!0:r[18]=!1,r[18]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[20]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[20]].join("")),r[19]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[20],r[19],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[15]=t.i64.cast([0,4])}]):(a=l.item,t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1491]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return r[17]?r[18]=!0:r[18]=!1,r[18]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[20]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[20]].join("")),r[19]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[20],r[19],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[15]=t.i64.cast([0,3])}]))})},function(e){return r[14]=r[15]}])},function(e){return r[13]=r[14]}])},function(e){return r[12]=r[13]}]):t.sequence([function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1489]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[13]=t[0],t})},function(e){return r[13]?r[14]=!0:r[14]=!1,r[14]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[16]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[16]].join("")),r[15]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[16],r[15],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[12]=t.i64.cast([-1,4294967295])}])},function(e){return r[9]=r[12]}])},function(e){return r[1]=r[9]}]))})},function(e){return r[3]=t.i64.of_float(Date.now()),r[4]=t.i64.random(),r[6]="Finishing execution. Execution time: ",r[7]=t.i64.to_string(t.i64.sub(r[3],r[0])),r[8]=" ms",r[5]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsProcessBackupIdsStoredProcedure] ",r[5],r[6],r[5],r[7],r[5],r[8]].join("")),t.i64.eq(t.i64.mod_(r[4],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[9]=",",r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsProcessBackupIdsStoredProcedure",[r[6],r[9],r[7],r[9],r[8]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()},function(e){return o[0]=r[1]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsProcessBackupIdsStoredProcedure",e.__tables__=["encrypted_backups","secure_encrypted_backups_client_state"],a.exports=e}),null);
__d("LSProcessBackupIdsStoredProcedure",["LSProcessBackupIds","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){a===void 0&&(a={});var i=t.storedProcedure(r("LSProcessBackupIds"),a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSSendPakeMessage",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][sendPakeMessage] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[4])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[4])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[4]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))}):(a=l.item,r[17]=a.responderId,r[18]=a.initiatorId,r[15]=a.responderUserId,r[16]=a.initiatorUserId,e[1]===r[18]?(t.i64.eq(e[4],t.i64.cast([0,1]))?r[19]=r[15]:r[19]=void 0,r[9]=r[19]):(e[1]===r[17]?(t.i64.eq(e[4],t.i64.cast([0,1]))?r[20]=r[16]:r[20]=void 0,r[19]=r[20]):r[19]=void 0,r[9]=r[19]),t.i64.eq(e[4],t.i64.cast([0,1]))?r[10]=r[15]:r[10]=void 0,t.i64.eq(e[4],t.i64.cast([0,1]))?r[11]=r[16]:r[11]=void 0,r[12]=new t.Map,r[12].set("session_id",e[0]),r[12].set("responder_id",r[17]),r[12].set("initiator_id",r[18]),r[12].set("message_payload",e[2]==null?a.messagePayload:e[2]),r[12].set("pake_secret",a.pakeSecret),r[12].set("sender_id",e[1]),r[12].set("message_type",e[3]),r[12].set("client_type",e[4]),r[12].set("message_recipient_id",r[9]),r[12].set("initiator_user_id",r[11]),r[12].set("responder_user_id",r[10]),r[13]=t.toJSON(r[12]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[13],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[14]=t[0],t}))})},function(e){return r[3]=t.i64.of_float(Date.now()),r[4]=t.i64.random(),r[6]="Finishing execution. Execution time: ",r[7]=t.i64.to_string(t.i64.sub(r[3],r[0])),r[8]=" ms",r[5]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][sendPakeMessage] ",r[5],r[6],r[5],r[7],r[5],r[8]].join("")),t.i64.eq(t.i64.mod_(r[4],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[9]=",",r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"sendPakeMessage",[r[6],r[9],r[7],r[9],r[8]].join(""),r[10],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesSendPakeMessageStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSSendPakeMessageOne",["LSBase64Encode.nop","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][sendPakeMessageOne] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.nativeOperation(n("LSBase64Encode.nop"),e[2]).then(function(e){var t;return t=e,r[2]=t[0],t})},function(o){return t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,7]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,7]),clientType:e[3]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,7])})}))})}]):(a=l.item,r[10]=a.responderId,r[10]!==void 0?(t.i64.eq(e[3],t.i64.cast([0,1]))?r[11]=a.responderUserId:r[11]=void 0,t.i64.eq(e[3],t.i64.cast([0,1]))?r[12]=a.initiatorUserId:r[12]=void 0,r[13]=new t.Map,r[13].set("session_id",e[0]),r[13].set("responder_id",r[10]),r[13].set("initiator_id",e[1]),r[13].set("message_payload",r[2]==null?"":r[2]),r[13].set("message_payload_v2",void 0),r[13].set("pake_secret",void 0),r[13].set("sender_id",e[1]),r[13].set("message_type",t.i64.cast([0,1])),r[13].set("client_type",e[3]),r[13].set("message_recipient_id",r[11]),r[13].set("initiator_user_id",r[12]),r[13].set("responder_user_id",r[11]),r[14]=t.toJSON(r[13]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"PakeMessages",t.i64.cast([0,717]),r[14],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[15]=t[0],t})):t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),void 0,t.i64.cast([0,3]),t.i64.cast([0,8]))},function(n){return t.islc(t.filter(t.db.table(258).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.clientType,e[3])&&t.i64.eq(n.sessionId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,r){var o=n.done,a=n.value;return o?t.db.table(258).add({sessionId:e[0],messageType:t.i64.cast([0,8]),clientType:e[3]}):(r=a.item,t.forEach(t.db.table(258).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({messageType:t.i64.cast([0,8])})}))})}]))})},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][sendPakeMessageOne] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"sendPakeMessageOne",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSPakeMessagesSendPakeMessageOneStoredProcedure",e.__tables__=["pake_messages"],a.exports=e}),null);
__d("LSSendPakeMessageOneStoredProcedure",["LSSendPakeMessageOne","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSendPakeMessageOne"),a.sessionId,a.initiatorId,a.messagePayload,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSSendPakeMessageStoredProcedure",["LSSendPakeMessage","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSendPakeMessage"),a.sessionId,a.senderId,a.messagePayload,a.messageType,a.clientType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSUpdateBackupsTableStoredProcedure",["LSSynchronousPromise","LSUpdateBackupsTable","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSUpdateBackupsTable"),a.isSuccess,a.backupIds,a.virtualDevices,a.deviceIds,a.backupMetadata,a.traceId,a.isUserOptedOut,a.hasOtcEligibleDevices,a.encryptionManagementDelegatorId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return r[0]=new t.Map,r[0].set("thread_key",e[0]),r[0].set("user_self_remove",!1),r[1]=r[0].get("thread_key"),r[2]=t.toJSON(r[0]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[1]),t.i64.cast([0,394]),r[2],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))},function(e){return t.resolve(o)}])}e.__sproc_name__="LSE2EEMessagingMetadataMailboxUpdateE2EEMetadataParticipantsStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSUpdateE2EEMetadataParticipantsStoredProcedure",["LSSynchronousPromise","LSUpdateE2EEMetadataParticipants","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSUpdateE2EEMetadataParticipants"),a.threadKey);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSUserVisibleErrorsUtil",["LSFactory","LSRemoveErrorStoredProcedure","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){r("promiseDone")(e.runInTransaction(function(e){return r("LSRemoveErrorStoredProcedure")(r("LSFactory")(e),{errorId:t})},"readwrite",void 0,void 0,i.id+":24"))}l.removeUserVisibleErrorFromTable=e}),98);
__d("MAWFTSRawStringMatcher",["JSResourceForInteraction","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e=r("JSResourceForInteraction")("WAFtsMultiLangTokenizer").__setRef("MAWFTSRawStringMatcher"),s=null;async function u(){return s=await e.load(),d}function c(e){return new(r("nullthrows")(s))().tokenize(e)}function d(e,t){var n=Array.from(c(e)).filter(function(e){return e.length>1});if(n.length===0)return!1;var r=Array.from(c(t));return n.every(function(e){return r.some(function(t){return t.startsWith(e)})})}l.load=u}),98);
__d("addMAWBridgeSearchMessagesToUniversalSearch",["I64","LSIntEnum","LSMessageSearchType","MAWCurrentUser","MAWUniversalMessageSearch","MWContentSearchUtils","MWSearchThreadUtils","ReQL","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessageSearchType").THREAD);async function c(e,t,n,a,l){var c;o("MAWUniversalMessageSearch").updateSecureMsgMatchCountForThread(t,a.length);var d=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.message_search_results).getKeyRange(u,n,t)),m=d==null,p=(s||(s=o("I64"))).to_int32((c=d==null?void 0:d.matchCount)!=null?c:(s||(s=o("I64"))).zero),_=p+a.length,f=await o("MWSearchThreadUtils").getThreadDataByThreadKey(e,t,s.of_string(o("MAWCurrentUser").getID()),u);if(f!=null){var g=f.profilePicUrl,h=f.secondaryProfilePicUrl,y=f.threadDisplayName,C=f.threadType,b=d==null?void 0:d.globalIndex,v=o("MWContentSearchUtils").getGlobalIndex(a[0].sortOrderMs,d==null?void 0:d.globalIndex),S=async function(r){var e;await r.message_search_results.upsert([u,n,t,b!=null?b:v],babelHelpers.extends({},o("MWContentSearchUtils").getContextLineAndMatches(n,_,(e=a[0].msg)==null?void 0:e.content,u),{displayName:y,globalIndex:v,matchCount:(s||(s=o("I64"))).of_int32(_),messageTimestampMs:o("MWContentSearchUtils").getMessageTimestamp(a[0].sortOrderMs),profilePicUrl:g,query:n,secondaryProfilePicUrl:h,threadKey:t,threadType:C,type_:u})),m&&await r.message_search_queries.put(babelHelpers.extends({},l,{resultCount:(s||(s=o("I64"))).add(l.resultCount,s.one)}))};r("promiseDone")(e.runInTransaction(async function(e){await S(e)},"readwrite",void 0,void 0,i.id+":113"))}}l.default=c}),98);
__d("MAWBridgeAddMessageSearchResultHandler",["I64","LSIntEnum","LSMessageSearchType","MAWCurrentUser","MAWFTSRawStringMatcher","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MWInboxSecureContentSearch","ReQL","addMAWBridgeSearchMessagesToUniversalSearch","emptyFunction","isMAWUniversalSearchWithEBEnabled","promiseDone","waitForMiActMappingForUniversalSearch"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessageSearchType").MESSAGE),c=e.ofNumber(r("LSMessageSearchType").THREAD);function d(e,t,n){return n.length===0?Promise.resolve():Promise.all([p(e,t,n),_(e,t,n)]).then(r("emptyFunction"))}async function m(e,t){var n=await o("MAWFTSRawStringMatcher").load();return t.filter(function(t){var r,o=(r=t.msg)==null?void 0:r.content;return o==null?!1:n(e,o)})}async function p(e,t,n){var a=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.message_search_queries).getKeyRange(u));if(a.length!==0)return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,n[0].chatJid,"MAWBridgeAddMessageSearchResultHandler",function(t,i){return(async function(){var r=a.filter(function(e){return(s||(s=o("I64"))).equal(e.threadKeyV2,i)})[0];if(r!=null){var l=r.query;if(!(l==null||l.length<2)){var u=(s||(s=o("I64"))).to_int32(r.resultCount),c=await m(l,n);c.length!==0&&await o("MWInboxSecureContentSearch").addBridgeSearchMsgsToSearchResult(e,t,r.query,c,u+c.length,s.of_string(o("MAWCurrentUser").getID()))}}})().then(r("emptyFunction"))})}async function _(e,t,n){if(r("isMAWUniversalSearchWithEBEnabled")()){var a=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.message_search_queries).getKeyRange(c).filter(function(e){return(s||(s=o("I64"))).equal(e.threadKeyV2,s.one)}));if(a!=null){var i=a.query;if(!(i==null||i.length<2)){var l=await m(i,n);l.length!==0&&r("promiseDone")(r("waitForMiActMappingForUniversalSearch")(e,n[0].chatJid),function(t){if(t!=null)return r("addMAWBridgeSearchMessagesToUniversalSearch")(e,t.serverThreadKey,i,l,a)})}}}}l.call=d}),98);
__d("MAWBridgeCallRestoreNativeOpHandler",["MAWMpsGating","Promise","WAJids","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("LSProtobufRestoreHandler").__setRef("MAWBridgeCallRestoreNativeOpHandler");function u(t){var r=t.chatJid,a=t.decryptedMessagesProtobufs,i=t.isPointQuery,l=t.taskSource;return o("MAWMpsGating").isFullMpsEnabled()?(e||(e=n("Promise"))).resolve():s.load().then(function(e){return e.handleProtobufRestoreHelper(o("WAJids").threadIdForChatJid(r),{convertedProtobufs:a,type:"convertedProtobufs"},!1,void 0,!1,void 0,i,void 0,void 0,void 0,void 0,l,r)})}l.call=u}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["LSThreadBitOffset","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","ReQL","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.threadJid,"MAWBridgeDeleteGroupInviteHandler",async function(t,n){var a=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.group_invites).getKeyRange(n));return Promise.all(a.map(function(e){return t.group_invites.delete(e.threadKey,e.inviterId,e.inviteeId)})).then(function(){r("promiseDone")(o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(n)),function(t){if(t!=null){var n=o("LSThreadBitOffset").clear([105],t.capabilities,t.capabilities2,t.capabilities3,t.capabilities4,t.capabilities5),r=n[0],a=n[1],i=n[2],l=n[3],s=n[4];return e.threads.put(babelHelpers.extends({},t,{capabilities:r,capabilities2:a,capabilities3:i,capabilities4:l,capabilities5:s,snippet:void 0}))}})})})}l.call=e}),98);
__d("MAWBridgeDeleteMessagesOfThreadHandler",["EBIsEbEnabled","LSFactory","LSIntEnum","LSIssueThreadRemoveStoredProcedure","LSMEBTaskCreationSource"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n){if(n.actionType===2){if(!await o("EBIsEbEnabled").isEbEnabledLS(t))return;await r("LSIssueThreadRemoveStoredProcedure")(r("LSFactory")(t),{actThreadId:n.threadId,sortKey:n.ts.toString(),source:(e||(e=o("LSIntEnum"))).ofNumber(r("LSMEBTaskCreationSource").TAM_WEB)})}}l.call=s}),98);
__d("MAWBridgeEphemeralSettingsUpdatedForUIHandler",["MAWChatJid","MAWEphemeralSettingsUpdate","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t){var n=await o("MAWChatJid").toThreadKeyMaybe(e,t.chatJid);return n!=null?o("MAWEphemeralSettingsUpdate").updateEphemeralSettingsWithTxn(e,t.ephemeralSettingArgs.ephemeralExpirationInSec,await o("WATimeUtils").castUnixTimeToMillisTime(t.ephemeralSettingArgs.ephemeralLastUpdatedOrSetTimestamp),t.isEphemeralSettingReset,n,!1,t.author):Promise.resolve()}l.call=e}),98);
__d("MAWBridgeFulfillRestorePromisePayloadHandler",["MAWEBRestoreTrackingUtils","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return t.success?o("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(t.value.traceId):o("MAWEBRestoreTrackingUtils").markEBRestoreFail(t.error.traceId),(e||(e=n("Promise"))).resolve()}l.call=s}),98);
__d("MAWBridgeGroupInfoUpdatedHandler",["I64","MAWMiActMappingTableAPI","MWFBLogger","ODS","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=o("MWFBLogger").MWLogger().tags(["bridgeUIEvent","Occam","Middleware"]);async function p(t,n){var r,a=await o("MAWMiActMappingTableAPI").getMappingRowForChatJid(t,n.chatJid);if(a==null){m.WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Missing thread key for chatJid: ",""])),n.chatJid);return}var i=(r=n.threadName)!=null?r:void 0,l=a.serverThreadKey,p=t.threads,_=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(p).getKeyRange(l));if(_==null){(c||(c=o("ODS"))).bumpEntityKey(3185,"armadillo_group_info_update","missing_thread"),m.WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Missing thread for updating group with threadKey: ",""])),(d||(d=o("I64"))).to_string(l));return}else i==null&&(i=_.threadName,m.WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(['MAWDB groupInfo is missing "name" field for threadKey: ',""])),(d||(d=o("I64"))).to_string(l)));var f=n.memberAddMode!=="all_member_add";await p.put(babelHelpers.extends({},_,{needsAdminApprovalForNewParticipant:f,threadName:i}))}l.call=p}),98);
__d("MAWBridgeGroupInviteUpdateHandler",["I64","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWUpdateLSThreadCapabilities","Promise","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,a){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,a.threadJid,"MAWBridgeGroupInviteUpdateHandler",function(t,i){var l=(s||(s=o("I64"))).of_string(a.inviterId);return(e||(e=n("Promise"))).all([o("MAWUpdateLSThreadCapabilities").setGroupInviteTxn(t,i,l)]).then(r("emptyFunction"))})}l.call=u}),98);
__d("MAWBridgeHandleCOPDigest",["Promise"],(function(t,n,r,o,a,i){"use strict";var e;function l(t,r){return(e||(e=n("Promise"))).resolve()}i.call=l}),66);
__d("MAWBridgeMediaExpiredHandler",["MAWMiActOnMiThreadExistsForJid__DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.threadJid,"MAWBridgeMediaExpiredHandler.bs",function(e,n){return e.attachments.delete(n,t.msgId,String(t.plaintextHash))})}l.call=e}),98);
__d("MAWBridgeMsgUpdatedHandler",["FBLogger","MAWAdminMsgCTA","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWMsgFetchLSReplyMsgAndAttachment","MAWUpdateMsg","MsgrWebGating","ReQL"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.chatJid,"MAWBridgeMsgUpdatedHandler",async function(n,a){var i,l=await(i=o("ReQL")).firstAsync(i.fromTableAscending(n.messages.index("messageId")).getKeyRange(t.msgId)),u=await i.firstAsync(i.fromTableAscending(n.attachments).getKeyRange(a,t.msgId));if(l==null){r("FBLogger")("messenger_web").info("existing message is null for type %s, and attachment is null: %s",t.type_,u==null);return}var c=await o("MAWAdminMsgCTA").getAdminMsgCtaStep(n,a,t),d=await s(e,t);return o("MAWUpdateMsg").call(n,d,l,c)})}async function s(e,t){if(o("MsgrWebGating").isQuotedMessagesInLsEnabled()){var n=await o("MAWMsgFetchLSReplyMsgAndAttachment").fetchReplyLocalViaLS(e,t);return n!=null?n:t}return Promise.resolve(t)}l.call=e}),98);
__d("MAWBridgeNoteReplyStartCountdownHandler",["MAWMessageExpirationStorage","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,r){return r.msgs.reduce(function(e,t){return e.then(function(){o("MAWMessageExpirationStorage").setMessageForExpiration({bridgeMsgStartCountdown:t,expirationEvent:o("MAWMessageExpirationStorage").expirationNoteReplyEvent})})},(e||(e=n("Promise"))).resolve())}l.call=s}),98);
__d("MAWCreateOptimisticThread",["I64","LSAuthorityLevel","LSCreateOfflineThreadingIDStoredProcedure","LSFactory","LSIntEnum","LSMailboxType","LSRtcCallState"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(t){var n=await r("LSCreateOfflineThreadingIDStoredProcedure")(r("LSFactory")(t),{timestampMs:(e||(e=o("I64"))).of_float(Date.now())}),a=n[0];return a}async function c(t,n){var a={authorityLevel:(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").OPTIMISTIC),folderName:"inbox",lastReadWatermarkTimestampMs:(e||(e=o("I64"))).of_float(0),mailboxType:s.ofNumber(r("LSMailboxType").MESSENGER),ongoingCallState:s.ofNumber(r("LSRtcCallState").NO_ONGOING_CALL),parentThreadKey:e.zero,threadKey:n,threadType:s.ofNumber(15)};return await t.threads.put(a),n}async function d(e){var t=await u(e);return await c(e,t),t}l.createOfflineThreadingId=u,l.createOptimisticThreadWithThreadKey=c,l.createOptimisticThread=d}),98);
__d("MAWBridgeOccamadilloCreateE2EEMetadataThreadHandlerV2",["DedupMiThreadCreationCache","FBLogger","I64","LSAuthorityLevel","LSCreateE2EEMetadataThreadStoredProcedure","LSFactory","LSIntEnum","MAWCreateOptimisticThread","MAWFolderUtils","MAWJids","MAWThreadLoadingState","MAWThreadUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u="[Occamadillo][CreateE2EEMetadataThreadHandlerV2]";async function c(t,n){var a=n.bumpTimestampMs,i=n.creationSource,l=n.folderId,s=n.jid,u=n.optimisticThreadKey;p(i,s);var c=u!=null?await t.threads.get((e||(e=o("I64"))).of_string(u)):null;if(c!=null&&o("DedupMiThreadCreationCache").DedupMiThreadCreationCache.has(s)){h(s);return}if(c!=null&&d(c)){_(s,(e||(e=o("I64"))).to_string(c.threadKey));return}var f={bumpTimestampMs:a,createdByLocalDevice:i==="outgoing_message",folderType:o("MAWFolderUtils").systemFolderToLSCoreClientFolder(l),offlineThreadKey:await m(c,s,t),threadType:o("MAWThreadUtils").getLSThreadTypeFromJid(s),waJid:o("MAWJids").convertChatJidToIntJid(s)};return g(f),r("LSCreateE2EEMetadataThreadStoredProcedure")(r("LSFactory")(t),f).then(function(){o("DedupMiThreadCreationCache").addToDedupMiThreadCreationCache(s)})}function d(e){var t=(s||(s=o("LSIntEnum"))).unwrapIntEnum(e.authorityLevel);switch(t){case r("LSAuthorityLevel").CLIENT_PARTIAL:case r("LSAuthorityLevel").OPTIMISTIC:case r("LSAuthorityLevel").SERVER_PARTIAL:return!1;case r("LSAuthorityLevel").AUTHORITATIVE:case r("LSAuthorityLevel").AUTHORITATIVE_PENDING_REPLACEMENT:case r("LSAuthorityLevel").CLIENT_AUTHORITATIVE_DELETE:return!0;default:throw r("FBLogger")("messenger_web").mustfixThrow("Unknown authority level")}}async function m(e,t,n){if(e!=null)return Promise.resolve(e.threadKey);var r=await o("MAWCreateOptimisticThread").createOfflineThreadingId(n);return f(t,r),await Promise.all([o("MAWCreateOptimisticThread").createOptimisticThreadWithThreadKey(n,r),o("MAWThreadLoadingState").markActThreadLoadingAsCompleted(n,{intJid:o("MAWJids").convertChatJidToIntJid(t),threadKey:r})]),r}function p(e,t){r("FBLogger")("messenger_web").info(u+" handler called from %s for jid %s",e,t)}function _(e,t){r("FBLogger")("messenger_web").info(u+" handler returned early for jid %s because thread %s was already authoritative",e,t)}function f(t,n){r("FBLogger")("messenger_web").info(u+" no thread exists for jid %s, creating optimistic thread with key %s",t,(e||(e=o("I64"))).to_string(n))}function g(t){r("FBLogger")("messenger_web").info(u+" Calling LSCreateE2EEMetadataThreadStoredProcedure with params: bumpTimestampMs: %s, createdByLocalDevice: %s, folderType: %s, offlineThreadKey: %s, offlineThreadKeySource: %s, threadType: %s, waJid: %s",(e||(e=o("I64"))).to_string(t.bumpTimestampMs),t.createdByLocalDevice,e.to_string(t.folderType),e.to_string(t.offlineThreadKey),e.to_string(t.threadType),e.to_string(t.waJid))}function h(e){r("FBLogger")("messenger_web").info(u+" LSCreateE2EEMetadataThreadStoredProcedure has already been called for jid %s, early returning",e)}l.call=c}),98);
__d("MAWBridgeParticipantRemovedHandler",["I64","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,n.threadJid,"MAWBridgeParticipantRemovedHandler",function(t,r){return t.participants.delete(r,(e||(e=o("I64"))).of_string(n.userId))})}l.call=s}),98);
__d("MAWBridgeRavenActionMsgForUIHandler",["I64","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWMsg","MAWRavenUtils","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e=["ephemeralMediaState"],s;function u(t,n){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,n.threadJid,"MAWBridgeRavenActionMsgForUIHandler",async function(t,r){var a=t.attachments,i=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(a).getKeyRange(r,n.ravenMsgId));if(i==null||i.ephemeralMediaState==null)return Promise.resolve();var l=(s||(s=o("I64"))).to_int32(i.ephemeralMediaState);if(i.ephemeralMediaViewMode==null)return Promise.resolve();var u=s.to_int32(i.ephemeralMediaViewMode),c=o("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(l),d=o("MAWMsg").MAWRavenMsgEphemeralType.cast(u);if(c==null||d==null)return Promise.resolve();var m=o("MAWRavenUtils").getNextRavenMessageEphemeralState(c,d);if(m==null)return Promise.resolve();var p=i.ephemeralMediaState,_=babelHelpers.objectWithoutPropertiesLoose(i,e),f=babelHelpers.extends({ephemeralMediaState:s.of_int32(m)},_,{transportKey:"WhatsApp"}),g=[_.threadKey,_.messageId,_.attachmentFbid];return a.upsert(g,f)})}l.call=u}),98);
__d("MAWBridgeReceivedReceiptHandler",["I64","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWTimeUtils","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,r){var a=(e||(e=o("I64"))).of_string(n.fbid),i=o("MAWTimeUtils").toTimestamp(n.deliveredWatermarkTs),l=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.participants).getKeyRange(r,a));l!=null&&await t.participants.put({authorityLevel:l.authorityLevel,contactId:l.contactId,deliveredWatermarkTimestampMs:(e||(e=o("I64"))).equal(i,(e||(e=o("I64"))).zero)?l.deliveredWatermarkTimestampMs:i,groupParticipantJoinState:l.groupParticipantJoinState,isAdmin:l.isAdmin,isModerator:l.isModerator,isSuperAdmin:l.isSuperAdmin,nickname:l.nickname,normalizedSearchTerms:l.normalizedSearchTerms,participantCapabilities:l.participantCapabilities,readActionTimestampMs:l.readActionTimestampMs,readWatermarkTimestampMs:l.readWatermarkTimestampMs,subscribeSource:l.subscribeSource,threadKey:l.threadKey,threadRoles:(e||(e=o("I64"))).zero})}function u(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.chatJid,"MAWBridgeReceivedReceiptHandler",function(e,n){return s(e,t,n)})}l.callWithoutWaitingForAnything=s,l.call=u}),98);
__d("MAWBridgeRefreshContactHandler",["LSFactory","LSRefetchContactRowIfExistsStoredProcedure"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return r("LSRefetchContactRowIfExistsStoredProcedure")(r("LSFactory")(e),{id:t})}l.call=e}),98);
__d("MAWBridgeRemoveMessageSearchResultHandler",["ReQL","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return(async function(){var n=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.message_search_results).filter(function(e){return t.includes(e.messageOtid)}));await Promise.all(n.map(function(t){return e.message_search_results.delete(t.type_,t.query,t.threadKey,t.globalIndex)}))})().then(r("emptyFunction"))}l.call=e}),98);
__d("MAWBridgeResignAttachmentCDNUrlHandler",["I64","LSFactory","LSIssueAttachmentRestoreTaskStoredProcedure","MAWAsyncEBMediaDownloadPromise","MAWBridgeFireAndForget","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e,s="-8";function u(t,n){var a,i=n.traceId,l=(a=n.skipLegacyMediaDownloadFlow)!=null?a:!1;function u(e,t,n){!l&&i!=null&&o("MAWBridgeFireAndForget").fireAndForget("backend","addMediaDownloadQpl",{annotations:n!=null?n:void 0,pointName:t,qplInstanceKey:i,qplType:e})}return u("point","resign_cdn_url_bridge_handler_start"),o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,n.threadJid,"MAWBridgeResignAttachmentCDNUrlHandler",function(t,a){var l={backupEntFbid:(e||(e=o("I64"))).of_string(s),deliveryObjectId:n.deliveryObjectId,mediaType:n.mediaType,messageId:n.messageId,productType:n.productType,serverThreadKey:e.to_string(a),sortOrder:e.of_float(n.sortOrder),threadId:n.threadId,traceId:i.toString()};return n.skipLegacyMediaDownloadFlow!==!0&&o("MAWAsyncEBMediaDownloadPromise").setMediaDownloadPayload({messageId:n.msgId,objectId:n.deliveryObjectId,plaintextHash:n.plaintextHash,threadId:n.threadId}),u("point","resign_cdn_url_issue_attachment_task",{string:{taskTraceId:l.traceId}}),r("LSIssueAttachmentRestoreTaskStoredProcedure")(r("LSFactory")(t),l).then(function(){u("point","resign_cdn_url_issue_attachment_task_end")}).catch(function(e){u("fail","resign_cdn_url_issue_attachment_task_fail",{string:{error:e.toString()}})})})}l.call=u}),98);
__d("MAWBridgeXMAShareTombstonedHandler",["FBLogger","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","ReQL"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=String(t.xmaId);return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.threadJid,"MAWBridgeXMAShareTombstonedHandler",function(e,a){return e.attachments.get(a,t.msgId,n).then(function(i){if(i==null)return Promise.resolve();var l=[i.defaultCtaId,i.attachmentCta1Id,i.attachmentCta2Id,i.attachmentCta3Id].filter(Boolean),s=l.map(function(t){return e.attachment_ctas.delete(t)});return Promise.all(s).then(function(){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.attachments).getKeyRange(a,t.msgId,n)).then(async function(t){if(t!=null){var n=babelHelpers.extends({},t,{attachmentCta1Id:void 0,attachmentCta2Id:void 0,attachmentCta3Id:void 0,cta1Title:void 0,cta1Type:void 0,cta2Title:void 0,cta2Type:void 0,cta3Title:void 0,cta3Type:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,previewHeight:void 0,previewHeightLarge:void 0,previewWidth:void 0,previewWidthLarge:void 0,subtitleText:void 0,titleText:void 0});await e.attachments.put(n)}else r("FBLogger")("messenger_web_sharing").blameToPreviousFrame().mustfix("Trying to tombstone a secure xma attachment but no existing attachment");return Promise.resolve()})})})})}l.call=e}),98);
__d("MAWBridgeStoryReplyStartCountdownHandler",["I64","MAWBridgeXMAShareTombstonedHandler","MAWDbXMA","MAWMessageExpirationStorage","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){return n.msgs.reduce(function(n,r){return n.then(function(){return o("MAWMessageExpirationStorage").setMessageForExpiration({bridgeMsgStartCountdown:r,expirationEvent:o("MAWMessageExpirationStorage").expirationStoryReplyEvent}),(e||(e=o("I64"))).of_int32(r.millisecondsUntilCountdownTs),o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,r.threadJid,"MAWBridgeMsgsStartCountdownHandler",function(e,t){return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.attachments).getKeyRange(t,r.msgId)).then(async function(t){await Promise.all(t.map(function(t){var n=o("MAWDbXMA").convertNumberToXMAId(Number.parseInt(t.attachmentFbid,10)),a={msgId:r.msgId,threadJid:r.threadJid,xmaId:n};return o("MAWBridgeXMAShareTombstonedHandler").call(e,a)}))})})})},Promise.resolve())}l.call=s}),98);
__d("MAWBridgeSyncContacts",["CurrentMessengerUser","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","Promise","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("CurrentMessengerUser").getID();function d(t,a){return a.reduce(function(e,n){var a=(s||(s=o("I64"))).of_string(n);return e.then(function(){return r("LSVerifyContactRowExistsStoredProcedure")(r("LSFactory")(t),{authorityLevel:(u||(u=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:u.ofNumber(r("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:u.ofNumber(r("LSContactIdType").FBID),contactType:u.ofNumber(r("LSContactType").USER),contactViewerRelationship:u.ofNumber(r("LSContactViewerRelationship").UNKNOWN),gender:u.ofNumber(r("LSContactGender").UNKNOWN),id:a,isBlocked:!1,isMemorialized:!1,isSelf:c===n,workForeignEntityType:u.ofNumber(r("LSContactWorkForeignEntityType").UNKNOWN)})}).then(r("emptyFunction"))},(e||(e=n("Promise"))).resolve())}l.call=d}),98);
__d("MAWBridgeThreadHiddenV2Handler",["LSFactory","LSIntEnum","LSOptimisticRemoveThreadStoredProcedure","LSThreadRemoveType","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,n,"MAWBridgeThreadHiddenV2Handler",function(t,n){var a=r("LSFactory")(t);return r("LSOptimisticRemoveThreadStoredProcedure")(a,{removeType:(e||(e=o("LSIntEnum"))).ofNumber(r("LSThreadRemoveType").DELETE_THREAD),threadKey:n})})}l.call=s}),98);
__d("MAWBridgeThreadUpdatedHandler",["MAWBridgeBuildThreadSnippet","MAWBridgeUIEventDataValidation","MAWFolderUtils","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","ReQL","getMAWLastMessageCtaType"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n,r=t.folder!=null?o("MAWFolderUtils").getMessagingFolderTag(t.folder):e.folderName;return(n=t.cannotReplyReason)!=null?n:r==="inbox"?void 0:e.cannotReplyReason}async function s(t,n,a){var i=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.threads).getKeyRange(a));if(i!=null){var l=o("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(n,i.snippet),s=e(i,n),u=r("getMAWLastMessageCtaType")(n.snippetType),c=babelHelpers.extends({},i,{cannotReplyReason:s,folderName:i.folderName,lastMessageCtaType:u,parentThreadKey:i.parentThreadKey,snippet:l,snippetSenderContactId:n.snippetSenderContactId==null?i.snippetSenderContactId:o("MAWBridgeUIEventDataValidation").stringToI64Opt(n.snippetSenderContactId)});await t.threads.put(c)}}function u(e,t){var n=t.threadJid;return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,n,"MAWBridgeThreadUpdatedHandler",function(e,n){return s(e,t,n)})}l.callWithoutWaitingForAnything=s,l.call=u}),98);
__d("MAWBridgeUIEventQueueQPLLogger",["QPLUserFlow","qpl"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){r("QPLUserFlow").start(r("qpl")._(1056849266,"1765"),{annotations:{string_array:{events:t}},instanceKey:e})}function s(e,t){r("QPLUserFlow").addAnnotations(r("qpl")._(1056849266,"1765"),t,{instanceKey:e})}function u(e){r("QPLUserFlow").endSuccess(r("qpl")._(1056849266,"1765"),{instanceKey:e})}function c(e,t){r("QPLUserFlow").endFailure(r("qpl")._(1056849266,"1765"),"MAWBridgeUIEventHandlerFailure",{annotations:{string:{failedEventTag:t}},instanceKey:e})}l.start=e,l.addAnnotations=s,l.endSuccess=u,l.endFailure=c}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["MAWDeviceChangeState-resolver","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,r){return o("MAWDeviceChangeState-resolver").updateDeviceCount(r),(e||(e=n("Promise"))).resolve()}l.call=s}),98);
__d("MAWBridgeUpdateClientRestoreStatus",["I64","LSEncryptedBackupsClientRestoreState","LSIntEnum","MAWUpdateClientRestoreStatusOperationType","ReQL","emptyFunction","vulture"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.encrypted_backups_client_restore_status).filter(function(e){return e.threadId===t})).then(function(t){return r("vulture")("6ohLsZU1yNlCR9ixvbeAM832GX4="),t!=null?e.encrypted_backups_client_restore_status.delete(t.threadId).then(r("emptyFunction")):Promise.resolve()})}function c(t,n,a,i){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.encrypted_backups_client_restore_status).getKeyRange(n)).then(function(i){return i!=null?t.encrypted_backups_client_restore_status.put({lastUpdated:(e||(e=o("I64"))).of_float(Date.now()),restoreStatus:(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsClientRestoreState").RESTORE_COMPLETE),serverThreadKey:a,threadId:n}):Promise.resolve()})}function d(e){return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.encrypted_backups_client_restore_status)).then(function(t){return t.reduce(function(t,n){return t.then(function(){return u(e,n.threadId)})},Promise.resolve())})}async function m(t,n){var a=n.threadId,i=n.action;return i===o("MAWUpdateClientRestoreStatusOperationType").upsertClientRestoreStatus?await t.encrypted_backups_client_restore_status.put({lastUpdated:(e||(e=o("I64"))).of_float(Date.now()),restoreStatus:(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsClientRestoreState").RESTORE_IN_PROGRESS),serverThreadKey:void 0,threadId:a}):await c(t,n.threadId,void 0,n.ebPrefetch),Promise.resolve()}l.truncateClientRestoreStatusTable=d,l.call=m}),98);
__d("MAWBridgeUpdateContactAsConnectedHandler",["FBLogger","I64","LSAddMessengerContactStoredProcedure","LSContactViewerRelationship","LSFactory","LSIntEnum","LSOptimisticAcceptMessageRequestStoredProcedure","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWUpdateLSThreadCapabilities","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(t,n){var a=n.contactUserId,i=n.threadJid,l=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.contacts).getKeyRange((e||(e=o("I64"))).of_string(a)));if(l==null){r("FBLogger")("messenger_web").warn("Missing contact in MAWBridgeUpdateContactAsConnectedHandler");return}var u=babelHelpers.extends({},l,{contactViewerRelationship:(s||(s=o("LSIntEnum"))).ofNumber(r("LSContactViewerRelationship").CONTACT_OF_VIEWER)});return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(t,i,"MAWBridgeUpdateContactAsConnectedHandler",async function(e,t){await Promise.allSettled([e.contacts.upsert([l.id],u),r("LSAddMessengerContactStoredProcedure")(r("LSFactory")(e),{contactId:l.id}),o("MAWUpdateLSThreadCapabilities").updateNonMessageRequestThreadTxn(e,t),r("LSOptimisticAcceptMessageRequestStoredProcedure")(r("LSFactory")(e),{threadKey:t})])})}l.call=u}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler",["LSFactory","LSUpdateE2EEMetadataParticipantsStoredProcedure","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.threadJid,"MAWBridgeThreadsLoadedHandler",function(e,t){return r("LSUpdateE2EEMetadataParticipantsStoredProcedure")(r("LSFactory")(e),{threadKey:t})})}l.call=e}),98);
__d("MAWBridgeUpdateThreadActivityHandler",["I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","MAWBridgeOccamadilloCreateE2EEMetadataThreadHandlerV2","MAWBridgeOccamadilloVerifyThreadExistsHandler","MAWChatJid","MAWFolderTypes","MAWJids","MAWMiActGetThreadLifecycleState__DO_NOT_USE","MWFBLogger","ODS","WAJids","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("MWFBLogger").MWLogger().tags(["bridgeUIEvent","Occam","ActivityUpdate"]);async function c(t,n){var r=null;return(e||(e=o("ODS"))).bumpEntityKey(3185,"occam_thread_creation","verify"),await o("MAWBridgeOccamadilloVerifyThreadExistsHandler").call(t,{authoritativeThreadKey:null,cannotReplyReason:null,clientThreadKey:null,description:"",folder:null,instanceKey:null,isGroup:o("WAJids").switchOnMsgrChatJidType(n.chatJid,{group:function(){return!0},user:function(){return!1}}),jid:n.chatJid,lastReadTs:o("WATimeUtils").castToMillisTime((s||(s=o("I64"))).to_float(n.bumpTimestampMs))}),r=await o("MAWChatJid").toThreadMaybe(t,n.chatJid),r==null&&((e||(e=o("ODS"))).bumpEntityKey(3185,"occam_thread_creation","create"),await o("MAWBridgeOccamadilloCreateE2EEMetadataThreadHandlerV2").call(t,{bumpTimestampMs:n.bumpTimestampMs,creationSource:n.source==="outgoing_msg"?"outgoing_message":"incoming_message",folderId:o("MAWFolderTypes").INBOX,jid:n.chatJid,optimisticThreadKey:null}),r=await o("MAWChatJid").toThreadMaybe(t,n.chatJid)),r==null?(await g(t,n.chatJid),null):r}async function d(e,t){var n=await o("MAWChatJid").toThreadMaybe(e,t.chatJid);e:{if(t.source==="outgoing_msg"||t.source==="incoming_msg"){var r=n!=null?n:await c(e,t);if(r==null){await g(e,t.chatJid);return}return m(e,r,t)}if(t.source==="deleted_msg"){if(n==null){await g(e,t.chatJid);return}return p(e,n,t)}if(t.source==="inserted_admin_msg"){if(n==null){await g(e,t.chatJid);return}return f(n,t,"No bump for admin message")}if(t.source==="eb_restore")return u.warn("Attempted bump from EB restore");throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t.source)}}async function m(e,t,n){if(_(t,n)){f(t,n,"Stale incoming bump");return}await r("LSBumpE2EEMetadataThreadStoredProcedure")(r("LSFactory")(e),{bumpedByLocalDeviceSend:n.source==="outgoing_msg",isUnbump:!1,serverAuthoritativeTimestampMs:n.bumpTimestampMs,threadKey:t.threadKey}),f(t,n,"Thread bumped")}async function p(e,t,n){await e.threads.put(babelHelpers.extends({},t,{lastActivityTimestampMs:(s||(s=o("I64"))).min(t.lastActivityTimestampMs,n.bumpTimestampMs),lastReadWatermarkTimestampMs:s.min(t.lastReadWatermarkTimestampMs,n.bumpTimestampMs)})),f(t,n,"Thread unbumped")}function _(e,t){return t.source==="incoming_msg"&&(s||(s=o("I64"))).le(t.bumpTimestampMs,e.lastActivityTimestampMs)}function f(e,t,n){var r=[(s||(s=o("I64"))).to_string(e.threadKey),t.source,s.to_string(t.bumpTimestampMs),s.to_string(e.lastActivityTimestampMs),s.to_string(e.lastReadWatermarkTimestampMs)];u.debug.apply(u,[n+". threadKey: %s, source: %s, bumpTimestampMs: %s, originalLastActivityTimestampMs: %s, originalLastReadWatermarkTimestampMs: %s"].concat(r))}async function g(e,t){var n=await o("MAWMiActGetThreadLifecycleState__DO_NOT_USE").getThreadLifecycleStateByJid(e,o("MAWJids").convertChatJidToIntJid(t),"MAWBridgeUpdateThreadActivityHandler");u.mustfix("Missing LSDBThread when updating thread activity. jid: %s, thread state: %s",t,n.type)}l.call=d}),98);
__d("MAWBridgeUpdateTraceHandler",["ArmadilloDataTraceCheckPoint","I64","LSAppendDataTraceAddonStoredProcedure","LSDataTraceCheckPoint","LSFactory","LSIntEnum","MAWBridgeTraceEvent","Promise","ReQL","emptyFunction","updateAndFlushLSDataTrace"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t,a,i){return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.data_trace_meta).filter(function(e){var t=e.contextThree;return t!=null&&a.externalIds.includes(t)&&(u||(u=o("I64"))).equal(e.traceType,a.traceType)?e.shouldFlush===!1:!1})).then(function(l){var s=[];return l.reduce(function(e,n){return e.then(function(){s.push(n.traceId);var e=a.errorMessage;return e!=null?r("LSAppendDataTraceAddonStoredProcedure")(r("LSFactory")(t),{checkPointId:i,dataTraceId:n.traceId,errorMessage:e,syncChannel:(u||(u=o("I64"))).neg_one}):r("LSAppendDataTraceAddonStoredProcedure")(r("LSFactory")(t),{checkPointId:i,dataTraceId:n.traceId,syncChannel:(u||(u=o("I64"))).neg_one})})},(e||(e=n("Promise"))).resolve()).then(function(){return s})})}function d(t,o){return o.reduce(function(e,n){return e.then(function(){return r("updateAndFlushLSDataTrace")(t,n)})},(e||(e=n("Promise"))).resolve())}function m(t,a){var i=a.event;return i===r("MAWBridgeTraceEvent").ReceivedReceipt?c(t,a,o("ArmadilloDataTraceCheckPoint").deliveryReceiptReceived).then(function(e){return d(t,e)}):i===r("MAWBridgeTraceEvent").ReceivedSent?c(t,a,o("ArmadilloDataTraceCheckPoint").advancedCryptoMEMSendTaskComplete).then(r("emptyFunction")):i===r("MAWBridgeTraceEvent").FlowEndForFailure?c(t,a,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE)).then(function(e){return d(t,e)}):i===r("MAWBridgeTraceEvent").FlowEndForSuccess?c(t,a,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH)).then(function(e){return d(t,e)}):(e||(e=n("Promise"))).resolve()}l.call=m}),98);
__d("MAWBridgeXMAShareExpiredHandler",["MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,r,o){var a=String(o.xmaId);return t.attachments.get(r,o.msgId,a).then(function(i){if(i==null)return(e||(e=n("Promise"))).resolve();var l=[i.defaultCtaId,i.attachmentCta1Id,i.attachmentCta2Id,i.attachmentCta3Id].filter(Boolean),s=l.map(function(e){return t.attachment_ctas.delete(e)});return(e||(e=n("Promise"))).all(s).then(function(){return t.attachments.delete(r,o.msgId,a)})})}function u(e,t){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJidNoThrow__DO_NOT_USE(e,t.threadJid,"MAWBridgeXMAShareExpiredHandler",function(e,n){return s(e,n,t)})}l.callWithoutWaitingForAnything=s,l.call=u}),98);
__d("isInstamadilloDYI",["qex"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("qex")._("665")===!0}l.default=e}),98);
__d("MAWBridgeUIEventHandler",["EBLogger","MAWAbPropsClient","MAWBridgeAddMessageSearchResultHandler","MAWBridgeCallRestoreNativeOpHandler","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteMessagesOfThreadHandler","MAWBridgeDeleteReactionHandler","MAWBridgeDropAllSecureThreadsHandler","MAWBridgeEditMsgHistoryAddedHandler","MAWBridgeEphemeralSettingsUpdatedForUIHandler","MAWBridgeFulfillRestorePromisePayloadHandler","MAWBridgeGroupInfoUpdatedHandler","MAWBridgeGroupInviteLoadedHandler","MAWBridgeGroupInviteUpdateHandler","MAWBridgeHandleCOPDigest","MAWBridgeMediaExpiredHandler","MAWBridgeMsgUpdatedHandler","MAWBridgeMsgsStartCountdownHandler","MAWBridgeNewMediaHandler","MAWBridgeNewMediaRangeHandler","MAWBridgeNewMsgHandler","MAWBridgeNewPollHandler","MAWBridgeNewReceiverFetchInfoHandler","MAWBridgeNewXMAHandler","MAWBridgeNoteReplyStartCountdownHandler","MAWBridgeOccamadilloCreateE2EEMetadataThreadHandlerV2","MAWBridgeOccamadilloVerifyThreadExistsHandler","MAWBridgeOneToOneMessageRequestLoadedHandler","MAWBridgeParticipantRemovedHandler","MAWBridgeParticipantsUpdatedHandler","MAWBridgeRavenActionMsgForUIHandler","MAWBridgeReactionUpsertHandler","MAWBridgeReceivedChatStateHandler","MAWBridgeReceivedReceiptHandler","MAWBridgeRefreshContactHandler","MAWBridgeRemoveMessageSearchResultHandler","MAWBridgeResignAttachmentCDNUrlHandler","MAWBridgeStartTraceHandler","MAWBridgeStoryReplyStartCountdownHandler","MAWBridgeSyncContacts","MAWBridgeThreadHiddenV2Handler","MAWBridgeThreadUpdatedHandler","MAWBridgeTraceRecordCheckpointHandler","MAWBridgeUIEventQueueQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUpdateClientRestoreStatus","MAWBridgeUpdateContactAsConnectedHandler","MAWBridgeUpdateE2EEMetadataParticipantsHandler","MAWBridgeUpdateThreadActivityHandler","MAWBridgeUpdateTraceHandler","MAWBridgeXMAShareExpiredHandler","MAWBridgeXMAShareTombstonedHandler","MAWLoggerUtils","MAWMessageExpirationStorage","MWFBLogger","WAResultOrError","WATimeUtils","emptyFunction","getErrorSafe","isArmadillo","isInstamadilloDYI","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("MWFBLogger").MWLogger().tags(["MAWBridgeUIEvent"]);function d(t,n,r){switch(r.tag){case"NewMsg":return o("MAWBridgeNewMsgHandler").call(n,r.value);case"MsgsStartCountdown":return o("MAWBridgeMsgsStartCountdownHandler").call(n,r.value);case"StoryReplyStartCountdown":return o("MAWBridgeStoryReplyStartCountdownHandler").call(n,r.value);case"NoteReplyStartCountdown":return o("MAWBridgeNoteReplyStartCountdownHandler").call(n,r.value);case"MsgClearCountdown":return Promise.resolve(o("MAWMessageExpirationStorage").clearMessageFromExpiration(r.value));case"DropAllSecureThreads":return o("MAWBridgeDropAllSecureThreadsHandler").call(n);case"VerifyThreadExists":{var a=r.value;return o("MAWBridgeOccamadilloVerifyThreadExistsHandler").call(n,a)}case"CreateE2EEMetadataThreadV2":return o("MAWBridgeOccamadilloCreateE2EEMetadataThreadHandlerV2").call(n,r.value);case"EditMsgHistoryAdded":return o("MAWBridgeEditMsgHistoryAddedHandler").call(t,n,r.value);case"MsgUpdated":return o("MAWBridgeMsgUpdatedHandler").call(n,r.value);case"NewMedia":return o("MAWBridgeNewMediaHandler").call(n,r.value);case"NewMediaRange":return o("MAWBridgeNewMediaRangeHandler").call(n,r.value);case"MediaExpired":return o("MAWBridgeMediaExpiredHandler").call(n,r.value);case"XMAShareExpired":return o("MAWBridgeXMAShareExpiredHandler").call(n,r.value);case"NewXMA":return o("MAWBridgeNewXMAHandler").call(n,r.value);case"XMAShareTombstoned":return o("MAWBridgeXMAShareTombstonedHandler").call(n,r.value);case"ParticipantRemoved":return o("MAWBridgeParticipantRemovedHandler").call(n,r.value);case"UpdateE2EEMetadataParticipants":return o("MAWBridgeUpdateE2EEMetadataParticipantsHandler").call(n,r.value);case"ReceivedReceipt":return o("MAWBridgeReceivedReceiptHandler").call(n,r.value);case"ThreadUpdated":return o("MAWBridgeThreadUpdatedHandler").call(n,r.value);case"GroupInfoUpdated":return o("MAWBridgeGroupInfoUpdatedHandler").call(n,r.value);case"UpdateThreadActivity":return o("MAWBridgeUpdateThreadActivityHandler").call(n,r.value);case"StartTrace":return o("MAWBridgeStartTraceHandler").call(n,r.value);case"UpdateTrace":return o("MAWBridgeUpdateTraceHandler").call(n,r.value);case"ThreadHiddenV2":return o("MAWBridgeThreadHiddenV2Handler").call(n,r.value);case"SyncContacts":return o("MAWBridgeSyncContacts").call(n,r.value);case"ReceivedChatState":return o("MAWBridgeReceivedChatStateHandler").call(n,r.value);case"ClockSkewUpdated":return Promise.resolve(o("WATimeUtils").setClockSkew(r.value));case"ABPropsUpdated":return c.warn("ABPropsUpdated has been deprecated. Please use the bridge with ABPropsUpdated"),Promise.resolve(o("MAWAbPropsClient").rewrite(r.value));case"COPDigestReceived":return o("MAWBridgeHandleCOPDigest").call(n,r.value);case"UpsertReaction":return o("MAWBridgeReactionUpsertHandler").call(n,r.value);case"DeleteReaction":return o("MAWBridgeDeleteReactionHandler").call(n,r.value);case"DeleteMessagesOfThread":return o("MAWBridgeDeleteMessagesOfThreadHandler").call(n,r.value);case"ResignAttachmentCDNUrl":return o("MAWBridgeResignAttachmentCDNUrlHandler").call(n,r.value);case"DeleteMessages":return o("MAWBridgeDeleteMessagesHandler").call(n,r.value);case"RestoreMessageBatch":return o("EBLogger").EBLogger().tags(["labyrinth_dyi"]).WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]))),Promise.resolve();case"OneToOneMessageRequestLoaded":return o("MAWBridgeOneToOneMessageRequestLoadedHandler").call(n,r.value);case"GroupInviteUpdate":return o("MAWBridgeGroupInviteUpdateHandler").call(n,r.value);case"UpdateDyiStatus":return o("EBLogger").EBLogger().tags(["labyrinth_dyi"]).WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]))),Promise.resolve();case"DeleteGroupInvite":return o("MAWBridgeDeleteGroupInviteHandler").call(n,r.value);case"TraceRecordCheckpoint":return o("MAWBridgeTraceRecordCheckpointHandler").call(n,r.value);case"ParticipantsUpdated":return o("MAWBridgeParticipantsUpdatedHandler").call(n,r.value);case"StartTraceWithTraceId":return Promise.resolve();case"UpdateClientRestoreStatus":return o("MAWBridgeUpdateClientRestoreStatus").call(n,r.value);case"NewMsgs":return o("MAWBridgeNewMsgHandler").bulkCall(n,r.value.msgs);case"UnArchivedSelfDeviceChangeAlerts":return o("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(n,r.value);case"EphemeralSettingsUpdatedForUI":return o("MAWBridgeEphemeralSettingsUpdatedForUIHandler").call(n,r.value);case"RavenActionUpdate":return o("MAWBridgeRavenActionMsgForUIHandler").call(n,r.value);case"GroupInviteLoaded":return o("MAWBridgeGroupInviteLoadedHandler").call(n,r.value);case"RemoveMessageSearchResult":return o("MAWBridgeRemoveMessageSearchResultHandler").call(n,r.value);case"AddMessageSearchResult":return o("MAWBridgeAddMessageSearchResultHandler").call(t,n,r.value);case"FulfillRestorePromise":return o("MAWBridgeFulfillRestorePromisePayloadHandler").call(r.value);case"UpdateContactAsConnected":return o("MAWBridgeUpdateContactAsConnectedHandler").call(n,r.value);case"RefreshContact":return o("MAWBridgeRefreshContactHandler").call(n,r.value);case"NewReceiverFetchInfo":return o("MAWBridgeNewReceiverFetchInfoHandler").call(n,r.value);case"RestoreNativeOp":return o("MAWBridgeCallRestoreNativeOpHandler").call(r.value);case"NewPoll":return o("MAWBridgeNewPollHandler").call(n,r.value);default:return Promise.resolve()}}function m(e,t){if(!r("isArmadillo")()&&!r("isInstamadilloDYI")()){c.mustfix("User is neither part of armadillo QE and dual send QE but somehow loaded this handler");return}if(!(t.length===1&&t[0].tag==="TraceRecordCheckpoint")){var n={};n=t.reduce(function(e,t){var n;return e[t.tag]=((n=e[t.tag])!=null?n:0)+1,e},n),c.DEBUG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Handle UI Events: ",""])),JSON.stringify(n))}r("promiseDone")(p(e,t),r("emptyFunction"),function(e){c.catching(e).mustfix("[MAWBridgeUIEventHandler] Failed to handle UI events: %s",t.map(function(e){return e.tag}).join(", "))})}async function p(e,t){var n=await e,a=o("MAWLoggerUtils").getInstanceKey(),l=t.map(function(e){return e.tag}),s="";o("MAWBridgeUIEventQueueQPLLogger").start(a,l),o("MAWBridgeUIEventQueueQPLLogger").addAnnotations(a,{int:{queue_size:t.length}});var u;try{u=await n.runInTransaction(async function(e){for(var a=0;a<t.length;a++){var i=t[a];try{await d(n,e,i)}catch(e){return s=i.tag,o("WAResultOrError").makeError(r("getErrorSafe")(e))}}return o("WAResultOrError").makeResult(!0)},"readwrite","background",{events:t,type:"maw_ui_bridge"},i.id+":281")}catch(e){u=o("WAResultOrError").makeError(r("getErrorSafe")(e))}u.success?o("MAWBridgeUIEventQueueQPLLogger").endSuccess(a):(o("MAWBridgeUIEventQueueQPLLogger").endFailure(a,s),c.catching(u.error).mustfix("MAWBridgeUIEventHandler] Did not commit UI events to DB, failed at %s, all events: %s",s,l.toString()))}async function _(e,t,n){try{await d(e,t,n)}catch(e){var o=r("getErrorSafe")(e);throw c.catching(o).mustfix("[handleShimEvent] Failed to handle UI event: %s",n.tag),e}}l.handleEvents=m,l.handleShimEvent=_}),98);
__d("MAWBridgeUpdateDYIStatusV2",["EBLogger","EncryptedBackupdDYIFileSaver","EncryptedBackupsDYIFileUtils","EncryptedBackupsDYITypes","QPLUserFlow","getErrorSafe","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t,n){o("EncryptedBackupdDYIFileSaver").saveFile(e,t),window.setTimeout(function(){r("promiseDone")(n())},1e3)}async function s(t){var n=t.qplEvent,a=t.qplInstanceKeyE2E,i=t.status,l=o("EBLogger").EBLogger().tags(["dyi"]);if(i===o("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Completed)try{if(navigator.storage==null)throw l.mustfixThrow("Storage management API is not supported. Please try one of the supported browsers.");var s=o("EncryptedBackupsDYIFileUtils").DyiArchiveFilename,u=await o("EncryptedBackupsDYIFileUtils").getRootFolderHandle(),c=await o("EncryptedBackupsDYIFileUtils").readFile(u,s);await e(s,c,async function(){await u.removeEntry(s)}),l.info("Saving file with filename ",s),n!=null&&a!=null&&r("QPLUserFlow").endSuccess(n,{instanceKey:a}),l.info("DYI Complete")}catch(e){return l.catching(r("getErrorSafe")(e)).mustfix("Failed to download the DYI archive"),n!=null&&a!=null&&r("QPLUserFlow").endFailure(n,r("getErrorSafe")(e).message,{instanceKey:a}),o("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed}return i===o("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed&&n!=null&&a!=null&&r("QPLUserFlow").endFailure(n,"Unknown error",{instanceKey:a}),i}l.call=s}),98);
__d("MAWChatOpenTabForUser",["I64","LSDatabaseSingleton","LSIntEnum","MAWCreateOneToOneThread","MAWMiActGetThreadLifecycleState__DO_NOT_USE","MAWMiActOnMiThreadExistsForJid__DO_NOT_USE","MAWMiActThreadLifecycleState__DO_NOT_USE","MAWUpdateSecureThreadAttributionForContact","MWChatInteraction","MWChatStateActions","MWChatStateV2Types","dispatchOpenChatTabTraceLogging","isOfflineThreadingId"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t){if(t.type===o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.MI_AND_ACT_THREAD_COMPLETE||t.type===o("MAWMiActThreadLifecycleState__DO_NOT_USE").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_ONLY){var n=t.serverThreadKey;return r("isOfflineThreadingId")(n)?{existingThreadKey:n,reason:"otid",type:"continue"}:(e||(e=o("I64"))).le(n,(e||(e=o("I64"))).zero)?{reason:"negative",type:"continue"}:{existingThreadKey:n,type:"skipped"}}return{existingThreadKey:t.serverThreadKey,type:"continue"}}async function d(t,n,r){var a=await(s||(s=o("LSDatabaseSingleton"))).LSDatabaseSingleton;r==null||r.addMarkerPoint("create_one_to_one_secure_thread_start","AppTiming");var l=await o("MAWMiActGetThreadLifecycleState__DO_NOT_USE").getThreadLifecycleStateByJid(a.tables,(e||(e=o("I64"))).of_string(t),n),u=l.type;u!=null&&(r==null||r.addAnnotation("mi_act_thread_state_type_before",u));var d=await c(l);if(d.type==="skipped")return r==null||r.addMarkerPoint("create_one_to_one_secure_thread_end","AppTiming"),{dispatchEntrypoint:"MAWChatOpenTabForUser_skipped_create_thread",threadKey:d.existingThreadKey};d.reason!=null&&(r==null||r.addAnnotation("invalid_server_thread_key_in_mawchatopentabforuser_check",d.reason));var m=await o("MAWCreateOneToOneThread").call(a,e.of_string(t),void 0,"MAWChatOpenTabForUser: "+n),p=await o("MAWMiActGetThreadLifecycleState__DO_NOT_USE").getThreadLifecycleStateByJid(a.tables,e.of_string(t),n),_=p.type;_!=null&&(r==null||r.addAnnotation("mi_act_thread_state_type_after",_)),r==null||r.addMarkerPoint("create_one_to_one_secure_thread_end","AppTiming");var f=await a.runInTransaction(function(e){return o("MAWMiActOnMiThreadExistsForJid__DO_NOT_USE").onMiThreadExistsForJid__DO_NOT_USE(e,m.jid,"MAWChatOpenTabForUser",function(e,t){return Promise.resolve(t)})},"readonly",void 0,void 0,i.id+":147");return{clientThreadKey:f,threadKey:f}}function m(t,n,a,i,l){var s=function(s){var i=s.clientThreadKey,c=s.dispatchEntrypoint,d=s.threadKey;o("MWChatInteraction").set((e||(e=o("I64"))).to_string(d),l.getTraceId()),o("MAWUpdateSecureThreadAttributionForContact").maybeUpdateSecureThreadAttributionForContact(e.of_string(t),d);var m={clientThreadKey:i,threadKey:d,threadType:(u||(u=o("LSIntEnum"))).ofNumber(15)};r("dispatchOpenChatTabTraceLogging")(l,m,c),a(o("MWChatStateActions").openTab(Date.now(),{shouldFocus:!n},{threadKeyDescriptor:m,type:o("MWChatStateV2Types").MWChatStateTabType.ChatTab}))};l.addMarkerPoint("MAWChatOpenTabForUser_getThreadKeyByContactId_start","AppTiming"),d(t,i,l).then(function(e){var t=e.clientThreadKey,n=e.dispatchEntrypoint,r=e.threadKey;l.addMarkerPoint("MAWChatOpenTabForUser_getThreadKeyByContactId_end","AppTiming"),s({clientThreadKey:t,dispatchEntrypoint:n!=null?n:"MAWChatOpenTabForUser",threadKey:r})})}l.getThreadKeyByContactId=d,l.openChatTab=m}),98);
__d("MAWMessageIntegrityChecker",["FBLogger","MAWMessagesCompare","ReQL"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return e.externalId===t.externalId?0:e.sortOrderMs>t.sortOrderMs?1:(e.sortOrderMs<t.sortOrderMs,-1)}function s(e,t){var n=t.reduce(function(e,t){return t.externalId!=null&&e.set(t.externalId,t.sortOrderMs),e},new Map);return e.map(function(e){var t;return babelHelpers.extends({},e,{sortOrderMs:(t=e.externalId!=null?n.get(e.externalId):null)!=null?t:e.sortOrderMs})}).sort(o("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc"))}function u(e,t,n){var r=new Set(e.map(function(e){return e.externalId}).filter(Boolean));return t.toSorted(o("MAWMessagesCompare").makeCompareMessageMetadataForDescOrderFn(r)).slice(0,n)}function c(t,n,o,a,i){for(var l=new Set(t.map(function(e){return e.externalId})),c=new Set(n.map(function(e){return e.externalId})),d=p(l,c),m=p(c,l),_=s(t,n),f=u(_,n,o),g=0,h=0,y=0,C=0,b=[],v=null;g<_.length&&h<f.length;){var S=_[g],R=f[h];if(v!=null&&e(R,v)===0){h+=1,v=R,r("FBLogger")("messenger_web_missing_messages").mustfix("Detected duplicate messages in reference. Target source: %s, reference source: %s",a,i);continue}var L=e(S,R);L===0?(g+=1,h+=1,v=R,b.push([S,{result:"consistent"}])):L<0?(h+=1,v=R,y+=1,b.push([R,{result:"missing_in_target"}])):(g+=1,C+=1,b.push([S,{result:"missing_in_reference"}]))}for(;g<_.length;){var E=_[g];g+=1,f.length<o?(C+=1,b.push([E,{result:"missing_in_reference"}])):b.push([E,{result:"skipped_in_target"}])}for(;h<f.length;){var k=f[h];h+=1,_.length<o?(y+=1,b.push([k,{result:"missing_in_target"}])):b.push([k,{result:"skipped_in_reference"}])}return y===0&&C===0?{detailedResults:b,result:"consistent",setDifferenceInReference:m,setDifferenceInTarget:d}:y>0&&C===0?{detailedResults:b,numOfMissingMessages:y,result:"missing_in_target",setDifferenceInReference:m,setDifferenceInTarget:d}:y===0&&C>0?{detailedResults:b,numOfMissingMessages:C,result:"missing_in_reference",setDifferenceInReference:m,setDifferenceInTarget:d}:{detailedResults:b,numOfMissingMessages:C+y,result:"missing_in_both",setDifferenceInReference:m,setDifferenceInTarget:d}}async function d(e,t,n){var o=n.filter(function(e){var t=e[0],n=e[1];return n.result==="missing_in_target"}).map(function(e){var t=e[0],n=e[1];return t.externalId}),a={admin:!1,editMsgHistory:!1,media:!1,polls:!1,reactions:!1,receiverFetch:!1,xma:!1},i=await t.fetchMessagesByExternalId(o,a),l=new Set(i.map(function(e){return e.externalId}));return Promise.all(n.map(async function(e){var t=e[0],n=e[1];if(!l.has(t.externalId))return[t,n];var o=i.find(function(e){return e.externalId===t.externalId});if(!o)return r("FBLogger")("messenger_web_missing_messages").mustfix("Failed to find msg with external id: %s in MAW",t.externalId),[t,{result:"missing_in_target_invalid_sortOrder"}];var a={sortOrderSkewMs:o.sortOrderMs-t.sortOrderMs,sortOrderSkewNumberOfMsg:0},s={result:"missing_in_target_invalid_sortOrder",sortOrderSkewMs:0};return a.sortOrderSkewNumberOfMsg!=null&&(s=babelHelpers.extends({},s,{sortOrderSkewNumberOfMsg:a.sortOrderSkewNumberOfMsg})),[babelHelpers.extends({},t,{msgType:o.msgType}),s]}))}async function m(e,t){var n=t.filter(function(e){var t=e[0],n=e[1];return n.result==="missing_in_target"}).map(function(e){var t=e[0],n=e[1];return t.externalId});if(n.length===0)return t;var r=n.map(function(t){return o("ReQL").fromTableAscending(e.tables.messages.index("optimistic")).getKeyRange(t)}),a=r.length===1,i=r.length>1?o("ReQL").union.apply(void 0,r):r[0],l=await o("ReQL").toArrayAsync(i);return t.map(function(e){var t=e[0],n=e[1],r=l.find(function(e){return e.offlineThreadingId===t.externalId});return r!=null?[t,{result:"missing_in_target_exists_in_lsdb",transportKey:r.transportKey,wouldHaveThrownS518614:a}]:(n.wouldHaveThrownS518614=a,[t,n])})}function p(e,t){var n=0;for(var r of e)t.has(r)||(n+=1);return n}l.checkIntegrityforMessageList=c,l.checkMsgsExistenceInMAWAndDecomposeTargetConsistencyResult=d,l.checkMsgsExistenceInLSDB=m}),98);
__d("MAWMessageIntegrityMissingInTargetCategory",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.hasEBFetchFailed,n=e.mawVsEB,r=e.uiVsEB,o=u(r),a=n.detailedResults.filter(function(e){var t=e[0],n=e[1];return o.has(t.externalId)});return a.map(function(e){var n=e[0],r=e[1],o=s(n.externalId,r,t);return o==null?null:[n,o]}).filter(Boolean)}function s(e,t,n){switch(t.result){case"consistent":return"client_inconsistency";case"missing_in_target":return n?"eb_restore_timeout":"message_not_persisted_after_eb_restore";case"missing_in_target_invalid_sortOrder":return t.sortOrderSkewMs==null||t.sortOrderSkewMs===0?"message_out_of_order_same_timestamp":"message_out_of_order_different_timestamp";case"skipped_in_target":return"client_inconsistency_skipped";case"skipped_in_reference":return"unknown_skipped";case"missing_in_reference":case"missing_in_target_exists_in_lsdb":return r("FBLogger")("messenger_web_missing_messages").mustfix("Unexpected consistency result %s for message with externalId %s when calculating missing in target category",t.result,e),null;default:return t.result,null}}function u(e){return e.detailedResults.reduce(function(e,t){var n=t[0],r=t[1];return r.result==="missing_in_target"&&e.add(n.externalId),e},new Set)}l.calculateMissingInTargetCategory=e}),98);
__d("MAWMessageIntegrityCompareMessagesData",["I64","MAWMessageIntegrityChecker","MAWMessageIntegrityMissingInTargetCategory","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=o("WATagsLogger").TAGS(["MissingMessages"]);async function m(e,t,n,r,o,a){var i=o.S518614_messagesBacktest,l=i.backendMessages,s=i.ebMessages,u=i.mpsMessages,c=i.uiMessages,d=o.S518614_pageSizeBacktest,m=o.messages,_=m.backendMessages,f=m.ebMessages,g=m.mpsMessages,h=m.uiMessages,y=o.pageSize,C=await p(e,t,n,r,a,_,f,g,h,y),b=C.mawVsEB,v=C.missingInTargetCategory,S=C.mpsVsEB,R=C.mpsVsMaw,L=C.uiVsEB,E=C.uiVsMaw,k=await p(e,t,n,r,a,l,s,u,c,d,!0),I=k.mawVsEB,T=k.mpsVsEB,D=k.mpsVsMaw,x=k.uiVsEB,$=k.uiVsMaw,P=k.wouldHaveThrownS518614;return{S518614_mawVsEB:I,S518614_mpsVsEB:T,S518614_mpsVsMaw:D,S518614_pageSize:d,S518614_uiVsEB:x,S518614_uiVsMaw:$,S518614_wouldHaveThrown:P,mawVsEB:b,missingInTargetCategory:v,mpsVsEB:S,mpsVsMaw:R,pageSize:y,uiVsEB:L,uiVsMaw:E}}async function p(t,n,r,a,i,l,m,p,f,g,h){h===void 0&&(h=!1);var y=o("MAWMessageIntegrityChecker").checkIntegrityforMessageList(f,l,g,"ui","maw"),C=o("MAWMessageIntegrityChecker").checkIntegrityforMessageList(f,m,g,"ui","eb"),b=o("MAWMessageIntegrityChecker").checkIntegrityforMessageList(l,m,g,"maw","eb"),v=p?o("MAWMessageIntegrityChecker").checkIntegrityforMessageList(p,l,g,"mps","maw"):null,S=p?o("MAWMessageIntegrityChecker").checkIntegrityforMessageList(p,m,g,"mps","eb"):null;C.result!=="consistent"&&(h?d.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["S518614 backtest: Missing message detected for ",", result: ",", num of messages missing: ",""])),(c||(c=o("I64"))).to_float(a),C.result,C.numOfMissingMessages):d.WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Missing message detected for ",", result: ",", num of messages missing: ",""])),(c||(c=o("I64"))).to_float(a),C.result,C.numOfMissingMessages)),(C.result==="missing_in_target"||C.result==="missing_in_both")&&(C.detailedResults=_(C.detailedResults,f)),(b.result==="missing_in_target"||b.result==="missing_in_both")&&(b.detailedResults=await o("MAWMessageIntegrityChecker").checkMsgsExistenceInMAWAndDecomposeTargetConsistencyResult(r,n,b.detailedResults));var R=!1;if(y.result==="missing_in_target"||y.result==="missing_in_both")try{y.detailedResults=await o("MAWMessageIntegrityChecker").checkMsgsExistenceInLSDB(t,y.detailedResults),y.detailedResults.map(function(e){var t=e[0],n=e[1];R||(R=n.wouldHaveThrownS518614===!0)})}catch(e){d.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to get detailed results for UI vs MAW comparison: ",""])),e)}var L=o("MAWMessageIntegrityMissingInTargetCategory").calculateMissingInTargetCategory({hasEBFetchFailed:i,mawVsEB:b,uiVsEB:C});return{mawVsEB:b,missingInTargetCategory:L,mpsVsEB:S,mpsVsMaw:v,pageSize:g,uiVsEB:C,uiVsMaw:y,wouldHaveThrownS518614:R}}function _(e,t){var n=new Set(t.map(function(e){return e.externalId}));return e.map(function(e){var t=e[0],r=e[1];return r.result==="missing_in_target"&&n.has(t.externalId)?[t,babelHelpers.extends({},r,{existingInUISamePage:!0})]:[t,r]})}l.compareMessagesData=m}),98);
__d("MAWMessageIntegrityFetchMessagesData",["I64","MAWBridgeSendAndReceive","MAWDbMsg","MAWEBDeanonFetch","MAWMessagesCompare","MAWMpsGating","MAWMpsMessageIntegrityFetch","MpsTypes","WAResultOrError","WAStanzaUtils","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(e,t,n,r,a,i){var l=await o("MAWBridgeSendAndReceive").sendAndReceive("backend","identifyXMAWithAssociatedTextByExternalId",{externalIds:i.map(function(e){return o("WAStanzaUtils").toStanzaId(e.offlineThreadingId)})}),s=i.map(d),p=await Promise.all([m(i),o("MAWMpsGating").isMpsMessageRendering()?[]:u(e,t,n,a,r),c(n,a,r),o("MAWMpsMessageIntegrityFetch").mpsMessageIntegrityFetch(n,"before",a,r)]),_=p[0],f=p[1],g=p[2],h=p[3],y=await o("MAWBridgeSendAndReceive").sendAndReceive("backend","identifyCollapsedMessagesByExternalId",{externalIds:g.map(function(e){return o("WAStanzaUtils").toStanzaId(e.externalId)})});function C(e){return!l.includes(o("WAStanzaUtils").toStanzaId(e.externalId))}function b(e){return!y.includes(o("WAStanzaUtils").toStanzaId(e.externalId))}function v(e){return C(e)&&b(e)}var S=_.filter(v),R=f.filter(v),L=g.filter(v),E=h==null?null:h.filter(v),k=s.filter(v),I=i.length-k.length,T=r-I;if(L.length===0)return o("WAResultOrError").makeError("EB result not available");var D=o("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc"),x=[].concat(R).sort(D).slice(0,T),$=[].concat(L).sort(D).slice(0,T),P=S.sort(D).slice(0,T),N=E!=null?[].concat(E).sort(D).slice(0,T):null,M=r,w=[].concat(f).sort(D).slice(0,M),A=[].concat(g).sort(D).slice(0,M),F=[].concat(_).sort(D).slice(0,M),O=h!=null?[].concat(h).sort(D).slice(0,M):null;return o("WAResultOrError").makeResult({S518614_messagesBacktest:{backendMessages:w,ebMessages:A,mpsMessages:O,uiMessages:F},S518614_pageSizeBacktest:M,messages:{backendMessages:x,ebMessages:$,mpsMessages:N,uiMessages:P},pageSize:T})}async function u(t,n,r,a,i){var l=p(a),s=l.msgId,u=l.timestampMs,c=await n.requestMessages(t,r,(e||(e=o("I64"))).of_float(u),s,"before",i,{admin:!1,editMsgHistory:!1,media:!1,polls:!1,reactions:!1,receiverFetch:!1,xma:!1},"integrity");return c.msgs}async function c(e,t,n){var r,a,i=p(t),l=i.msgId,s=i.timestampMs,u=await(l==null?Promise.resolve(null):o("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:l})),c=(r=u==null?void 0:u.externalId)!=null?r:(a=t.lastItemFromPreviousPage)==null?void 0:a.offlineThreadingId,d=await o("MAWEBDeanonFetch").fetchMessagesMetadataFromEBDeanon({chatJid:e,count:n*2,direction:"before",includeReferenceTimestamp:!0,referenceExternalId:c,referenceTimestampMs:s});if(d.success===!1)return[];var m=d.value.sort(o("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc")),_=m.findIndex(function(e){return e.externalId===c});return m.slice(_+1)}function d(t){return{externalId:t.offlineThreadingId,msgType:(e||(e=o("I64"))).to_string(t.displayedContentTypes),sortOrderMs:e.to_float(t.primarySortKey)}}function m(e){var t=function(t){var e=o("MAWDbMsg").toMsgId(t.messageId);return e==null?Promise.resolve(d(t)):o("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:e}).then(function(e){var n;return babelHelpers.extends({},t,{offlineThreadingId:(n=e==null?void 0:e.externalId)!=null?n:t.offlineThreadingId})}).then(d)};return Promise.all(e.map(t))}function p(t){return t.type==="lastItemFromPreviousPage"?{messageId:o("MpsTypes").toMessageId(t.lastItemFromPreviousPage.offlineThreadingId),msgId:o("MAWDbMsg").toMsgId(t.lastItemFromPreviousPage.messageId),timestampMs:o("WATimeUtils").castToMillisTime((e||(e=o("I64"))).to_float(t.lastItemFromPreviousPage.primarySortKey))}:(t.type,{messageId:null,msgId:null,timestampMs:o("WATimeUtils").millisTime()})}l.fetchMessagesDataForComparison=s,l.getRangeDetailsFromMessageIntegrityFromReference=p}),98);
__d("MAWMpsMessageIntegrityFetch",["MAWCurrentUser","MAWEBLSInWorkerSwitch","MAWEBSwitch","MAWMessageIntegrityFetchMessagesData","MAWMessagesDirection","MpsOverBridge","MpsTypes","WAPromiseDelays"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t,n,a){var i=o("MAWMessageIntegrityFetchMessagesData").getRangeDetailsFromMessageIntegrityFromReference(n),l=i.messageId,s=i.timestampMs;r("MAWEBSwitch").isEnabled()===!0&&await Promise.race([o("WAPromiseDelays").delayMs(1e4),await r("MAWEBLSInWorkerSwitch").waitForEBEnabled()]);var u=await o("MpsOverBridge").mps().loadMessages({config:{shouldFetchSupplementals:!1,shouldIgnoreLocalOnly:!0,strategy:"full-fetch"},debug:{purpose:"integrity-check"},direction:o("MAWMessagesDirection").translateMawDirectionToMwpDirection(t),from:[o("MpsTypes").toTimestamp(s),l],numMessages:a*2,threadId:o("MpsTypes").toThreadId(e)});return u.success===!1?null:u.value.messages.map(function(e){return{externalId:e.toplevelProtobuf.messageId,isOutgoing:e.toplevelProtobuf.senderId!==o("MAWCurrentUser").getID(),msgType:"",sortOrderMs:e.toplevelProtobuf.timestampMs}})}l.mpsMessageIntegrityFetch=e}),98);
__d("MAWMessageIntegrityFetchAndCompareData",["MAWMessageIntegrityCompareMessagesData","MAWMessageIntegrityFetchMessagesData","MAWMiActOnActThreadReady","MAWSecureLocalDBDataSource","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("MAWSecureLocalDBDataSource"));async function s(t){var n=t.db,r=t.fromReferencePoint,a=t.hasEbFetchFailed,i=t.localMessages,l=t.pageSize,s=t.threadKey,u=await o("MAWMiActOnActThreadReady").waitForACTThreadReady(n.tables,s,"fetchAndCompareMessagesData"),c=u.chatJid,d=await o("MAWMessageIntegrityFetchMessagesData").fetchMessagesDataForComparison(n,e,c,l,r,i);if(d.success===!1)return d;var m=await o("MAWMessageIntegrityCompareMessagesData").compareMessagesData(n,e,c,s,d.value,a);return o("WAResultOrError").makeResult(m)}l.fetchAndCompareMessagesData=s}),98);
__d("MAWMessagesIntegrityEphemeralSettings",["I64","MAWGetEphemeralSettings","MAWMiActOnActThreadReady","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,r){var a=await o("MAWMiActOnActThreadReady").waitForACTThreadReady(t.tables,n,"getIsEphemeralMessagesEnabledForPage"),i=a.chatJid,l=await o("MAWGetEphemeralSettings").getEphemeralSetting(i,n);return l==null||l.ephemeralLastUpdatedOrSetTimestamp===o("WATimeUtils").DEFAULT_UNIXTIME?"disabled":o("WATimeUtils").castUnixTimeToMillisTime(l.ephemeralLastUpdatedOrSetTimestamp)<(e||(e=o("I64"))).to_float(r)?l.ephemeralExpirationInSec>0?"enabled":"disabled":l.ephemeralExpirationInSec>0?"maybeDisabled":"maybeEnabled"}l.getEphemeralMessagesStatusForPage=s}),98);
__d("MAWMessageIntegrityCheck",["CometDebounce","DateConsts","EbFetchTimeoutMsForMLv2","I64","MAWBridgeSendAndReceive","MAWEBCombinedSwitch","MAWMessageIntegrityCheckFlytrapResultCache","MAWMessageIntegrityEBFetchStatus","MAWMessageIntegrityFetchAndCompareData","MAWMessageIntegrityTruncateStatus","MAWMessagesIntegrityEphemeralSettings","MAWMiActOnActThreadReady","WACommsConnectionState","WAPromiseDelays","WATagsLogger","WATimeUtils","gkx","justknobx","logMessengerWebFalcoEvent","vulture"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b="11",v=12e4,S=o("WATagsLogger").TAGS(["MissingMessages"]),R=r("CometDebounce")(r("logMessengerWebFalcoEvent"));function L(e){if(e.length===0)return null;var t=0;for(var n of e)t=Math.max(t,(C||(C=o("I64"))).to_float(n.primarySortKey));return o("WATimeUtils").castToMillisTime(t)}function E(e,t){var n=L(e);if(n==null)return t;var o=Math.abs(n-t),a=r("justknobx")._("4843");return o<a?n:t}async function k(t,n,a,i,l,L,k,D,N,M){var w,A,F,O,B,W,q,U,V,H,G,z,j,K;if(S.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["run Message Integrity Check - threadKey: ",", lastItem: ",", pageSize: ",""])),(C||(C=o("I64"))).to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),l),o("WATimeUtils").millisTime()-N>v){S.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check skipped for threadKey: ",", lastItem: ",", reason: check was scheduled more than 2 minutes ago"])),(C||(C=o("I64"))).to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey));return}var Q=o("MAWEBCombinedSwitch").MAWEBCombinedSwitch.isEnabled();if(L==null&&o("WACommsConnectionState").WACommsConnectionState.isConnected()===!1){S.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check skipped for threadKey: ",", lastItem: ",", reason: WACOMMS is disconnected"])),(C||(C=o("I64"))).to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey));return}var X=o("WATimeUtils").millisTime(),Y=r("gkx")("1626"),J=o("MAWMessageIntegrityEBFetchStatus").hasEBFailure(n),Z=o("MAWMessageIntegrityTruncateStatus").getThreadThuncateState(n),ee=L!=null?{lastItemFromPreviousPage:L,type:"lastItemFromPreviousPage"}:{timeOfSnapshotMs:E(k,N),type:"latestPageSnapshot"},te=await o("MAWMessageIntegrityFetchAndCompareData").fetchAndCompareMessagesData({db:t,fromReferencePoint:ee,hasEbFetchFailed:J,localMessages:k,pageSize:l,threadKey:n});if(te.success===!1){S.LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check skipped for threadKey: ",", lastItem: ",", reason: ",""])),(C||(C=o("I64"))).to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),te.error);return}var ne=te.value;r("gkx")("4852")&&ne.uiVsEB.detailedResults.some(function(e){var t=e[0],n=e[1];return n.result==="missing_in_target"})&&M();var re=o("MAWMessageIntegrityCheckFlytrapResultCache").generateMessageIntegrityCheckPageKey(n,k);o("MAWMessageIntegrityCheckFlytrapResultCache").cacheMessageIntegrityCheckResult(re,ne.missingInTargetCategory),S.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check result - threadKey: ",", lastItem: ",", result against backend data: ",""])),C.to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),JSON.stringify(ne.uiVsMaw)),S.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check result - threadKey: ",", lastItem: ",", result against EB data: ",""])),C.to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),JSON.stringify(ne.uiVsEB)),S.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check result - threadKey: ",", lastItem: ",", MPS (target) vs MAW (reference): ",""])),C.to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),JSON.stringify(ne.mpsVsMaw)),S.LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check result - threadKey: ",", lastItem: ",", MPS (target) vs EB (reference): ",""])),C.to_string(n),L==null?"null":(C||(C=o("I64"))).to_float(L.primarySortKey),JSON.stringify(ne.mpsVsEB)),S.LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check Flytrap result - threadKey: ",", missingInTargetCategory: ",""])),C.to_string(n),JSON.stringify(ne.missingInTargetCategory)),S.LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check Truncate state - threadKey: ",", state: ",""])),C.to_string(n),JSON.stringify(Z));var oe=T(ne.mawVsEB),ae=T(ne.uiVsEB),ie=T(ne.uiVsMaw),le=ne.mpsVsMaw!=null?T(ne.mpsVsMaw):{},se=ne.mpsVsEB!=null?T(ne.mpsVsEB):{},ue=T(ne.S518614_mawVsEB),ce=T(ne.S518614_uiVsEB),de=T(ne.S518614_uiVsMaw),me=ne.S518614_mpsVsMaw!=null?T(ne.S518614_mpsVsMaw):{},pe=ne.S518614_mpsVsEB!=null?T(ne.S518614_mpsVsEB):{},_e=x(k),fe=await o("MAWMessagesIntegrityEphemeralSettings").getEphemeralMessagesStatusForPage(t,n,_e),ge=await $(t,n),he=await o("WAPromiseDelays").withTimeout(P({messages:[]}).catch(function(e){return S.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to get extra debug info: ",""])),e),"error"}),1e4,function(){return"timeout"}),ye={MAW_vs_EB_detailedResults:oe.detailedResults,MAW_vs_EB_numOfMissingInReference:oe.numOfMissingInReference,MAW_vs_EB_numOfMissingInTarget:oe.numOfMissingInTarget,MAW_vs_EB_numOfMissingInTargetInvalidSortOrder:oe.numOfMissingInTargetInvalidSortOrder,MAW_vs_EB_setNumOfMissingInReference:oe.setDifferenceInReference,MAW_vs_EB_setNumOfMissingInTarget:oe.setDifferenceInTarget,MPS_vs_EB_detailedResults:(w=se.detailedResults)!=null?w:"",MPS_vs_EB_numOfMissingInReference:(A=se.numOfMissingInReference)!=null?A:"",MPS_vs_EB_numOfMissingInTarget:(F=se.numOfMissingInTarget)!=null?F:"",MPS_vs_MAW_detailedResults:(O=le.detailedResults)!=null?O:"",MPS_vs_MAW_numOfMissingInReference:(B=le.numOfMissingInReference)!=null?B:"",MPS_vs_MAW_numOfMissingInTarget:(W=le.numOfMissingInTarget)!=null?W:"",S518614_MAW_vs_EB_detailedResults:(q=ue.detailedResults)!=null?q:"",S518614_MPS_vs_EB_detailedResults:(U=pe.detailedResults)!=null?U:"",S518614_MPS_vs_MAW_detailedResults:(V=me.detailedResults)!=null?V:"",S518614_pageSize:ne.S518614_pageSize.toString(),S518614_UI_vs_EB_detailedResults:(H=ce.detailedResults)!=null?H:"",S518614_UI_vs_MAW_detailedResults:(G=de.detailedResults)!=null?G:"",S518614_wouldHaveThrown:I(ne.S518614_wouldHaveThrown),UI_vs_EB_detailedResults:ae.detailedResults,UI_vs_EB_numOfMissingInReference:ae.numOfMissingInReference,UI_vs_EB_numOfMissingInTarget:ae.numOfMissingInTarget,UI_vs_EB_setNumOfMissingInReference:ae.setDifferenceInReference,UI_vs_EB_setNumOfMissingInTarget:ae.setDifferenceInTarget,UI_vs_MAW_detailedResults:ie.detailedResults,UI_vs_MAW_numOfMissingInReference:ie.numOfMissingInReference,UI_vs_MAW_numOfMissingInTarget:ie.numOfMissingInTarget,UI_vs_MAW_setNumOfMissingInReference:ie.setDifferenceInReference,UI_vs_MAW_setNumOfMissingInTarget:ie.setDifferenceInTarget,ebMetadataCacheStatus:ge,ebTimeoutSec:(r("EbFetchTimeoutMsForMLv2")()/o("DateConsts").MS_PER_SEC).toString(),endRangeTimestampMs:C.to_string(_e),ephemeralMessagesStatus:fe+"",extraDebugInfo:he,hasAdditionalData:I(Y),hasEBFetchFailed:I(J),integrityCheckScheduleTimestampMs:N.toString(),isDogfooding:I(r("gkx")("2972")),isEbEnabled:I(Q),isEbGraphQL:Q?"false":I(r("gkx")("7083")),isHoldout_H2_2025:I(r("gkx")("15728")),isJidOptimisationInRestoreEnabled:I(r("gkx")("3137")),isMpsEnabled:"true",isUsingLsInitCache:I(r("gkx")("15958")),lastItemExternalId:(z=L==null?void 0:L.offlineThreadingId)!=null?z:"null",lastItemTimestamp:C.to_string((j=L==null?void 0:L.primarySortKey)!=null?j:(C||(C=o("I64"))).zero),missingInTargetCategory:JSON.stringify(ne.missingInTargetCategory),pageIndex:D+"",pageSize:ne.pageSize+"",reportTimeMs:X.toString(),truncateState:(K=JSON.stringify(Z))!=null?K:"null",version:Q?b:"0",waCommsIsConnected:I(o("WACommsConnectionState").WACommsConnectionState.isConnected())};r("gkx")("970")&&S.DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Message Integrity Check - Falco Report"]))).devConsole({falcoReport:ye}),R({threadKey:n,threadType:a},"message_integrity_check",i,ye)}function I(e){return e===!0?"true":"false"}function T(e){var t=0,n=0,r=0;return e.detailedResults.forEach(function(e){var o=e[0],a=e[1];switch(a.result){case"missing_in_target":case"missing_in_target_exists_in_lsdb":t+=1;break;case"missing_in_target_invalid_sortOrder":n+=1,t+=1;break;case"missing_in_reference":r+=1;break;case"consistent":case"skipped_in_target":case"skipped_in_reference":break;default:a.result}}),{detailedResults:D(e.detailedResults),numOfMissingInReference:r+"",numOfMissingInTarget:t+"",numOfMissingInTargetInvalidSortOrder:n+"",setDifferenceInReference:e.setDifferenceInReference+"",setDifferenceInTarget:e.setDifferenceInTarget+""}}function D(e){var t=e.map(function(e){var t=e[0],n=e[1],o=n.existingInUISamePage,a=n.result,i=n.sortOrderSkewMs,l=n.sortOrderSkewNumberOfMsg;return babelHelpers.extends({existingInUISamePage:o,externalId:t.externalId,isOutgoing:t.isOutgoing},r("gkx")("1626")?{msgType:t.msgType,sortOrderMs:t.sortOrderMs}:{},{result:a,sortOrderSkewMs:i!=null?i:0,sortOrderSkewNumberOfMsg:l!=null?l:0})});return JSON.stringify(t)}function x(e){return e.length===0?(C||(C=o("I64"))).min_int:e.map(function(e){return e.timestampMs}).sort((C||(C=o("I64"))).compare)[0]}async function $(e,t){var n=await o("MAWMiActOnActThreadReady").waitForACTThreadReady(e.tables,t,"fetchAndCompareMessagesData"),r=n.chatJid,a=await o("MAWBridgeSendAndReceive").sendAndReceive("backend","getEBMetadataCacheDetailsForThread",{chatJid:r});return JSON.stringify(a)}async function P(e){r("vulture")("L5p00iypub0GBBy1GoTSyMkNm80=");var t={browser:{loadEventEnd:window.performance.timing.loadEventEnd,navigationStart:window.performance.timing.navigationStart},worker:await o("MAWBridgeSendAndReceive").sendAndReceive("backend","getWorkerBasedMessageIntegrityDebugInfo",e)};return JSON.stringify(t)}var N={runMessageIntegrityCheck:k};l.default=N}),98);
__d("MWXIconMenuItemHouseKeyhole",["MWXSvgIcon","SVGIcon","cr:22704","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22704")),r("gkx")("23219"));l.default=e}),98);
__d("MAWSecurityAlertsBadgeMenuItem.react",["fbt","FDSNumberedBadge.react","JSResourceForInteraction","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWXIconMenuItemHouseKeyhole","MWXMenuItem.react","gkx","react","react-compiler-runtime","useMWXLazyDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useContext,d=r("JSResourceForInteraction")("MAWSecurityAlertsDialog.react").__setRef("MAWSecurityAlertsBadgeMenuItem.react");function m(e){var t=o("react-compiler-runtime").c(12),n=e.count,a=r("useMWXLazyDialog")(d),i=a[0],l=c(r("MWJewelPopoverDialogContext.react")),m=l.setIsOpenForDialog,p=r("gkx")("23219"),_;t[0]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"View security alerts"),t[0]=_):_=t[0];var f=_,g;t[1]!==n?(g=s._(/*BTDS*/"_j{\"*\":\"{number} security alerts\",\"_1\":\"1 security alert\"}",[s._plural(n,"number")]),t[1]=n,t[2]=g):g=t[2];var h;t[3]!==n||t[4]!==g?(h={badge:u.jsx(r("FDSNumberedBadge.react"),{accessibilityText:g,color:p?"red":"lightBlue",value:n}),type:"numberedBadge"},t[3]=n,t[4]=g,t[5]=h):h=t[5];var y;t[6]!==m||t[7]!==i?(y=function(){o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","security_alerts"),m(!0),i({})},t[6]=m,t[7]=i,t[8]=y):y=t[8];var C;return t[9]!==h||t[10]!==y?(C=u.jsx(r("MWXMenuItem.react"),{auxItem:h,icon:r("MWXIconMenuItemHouseKeyhole"),id:"security_alerts_badge_menu_item",onClick:y,primaryText:f}),t[9]=h,t[10]=y,t[11]=C):C=t[11],C}l.default=m}),226);
__d("MAWSecurityAlertsBadgeMenuItemWrapper.react",["MAWSecurityAlertsBadgeMenuItem.react","react","react-compiler-runtime","useMAWSecurityAlertsPreferences"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useMemo;function c(e){var t=o("react-compiler-runtime").c(3),n=e.value,a=r("useMAWSecurityAlertsPreferences")(),i=a.securityAlertsPreferences;i==null||i.allowSecurityAlertForSelf;var l;return t[0]!==(i==null?void 0:i.allowSecurityAlertForSelf)||t[1]!==n?(l=i!=null&&i.allowSecurityAlertForSelf?s.jsx(r("MAWSecurityAlertsBadgeMenuItem.react"),{count:n}):null,t[0]=i==null?void 0:i.allowSecurityAlertForSelf,t[1]=n,t[2]=l):l=t[2],l}l.default=c}),98);
__d("MAWSecurityAlertsMenuItem.react",["fbt","JSResourceForInteraction","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWXMenuItem.react","react","react-compiler-runtime","useMWXLazyDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useContext,d=r("JSResourceForInteraction")("MAWSecurityAlertsDialog.react").__setRef("MAWSecurityAlertsMenuItem.react");function m(){var e=o("react-compiler-runtime").c(7),t=r("useMWXLazyDialog")(d),n=t[0],a=c(r("MWJewelPopoverDialogContext.react")),i=a.setIsOpenForDialog,l;e[0]!==i||e[1]!==n?(l=function(){o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","security_alerts"),i(!0),n({})},e[0]=i,e[1]=n,e[2]=l):l=e[2];var m,p;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=s._(/*BTDS*/"Security alerts"),p=s._(/*BTDS*/"View and manage alerts for logins and key changes"),e[3]=m,e[4]=p):(m=e[3],p=e[4]);var _;return e[5]!==l?(_=u.jsx(r("MWXMenuItem.react"),{onClick:l,primaryText:m,secondaryText:p,testid:void 0}),e[5]=l,e[6]=_):_=e[6],_}l.default=m}),226);
__d("MAWXMAPreviewsSettingsMenuItem.react",["fbt","JSResourceForInteraction","MWXMenuItem.react","react","react-compiler-runtime","useMWXLazyDialog","useXMAPreviewsDisabledSetting"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=s._(/*BTDS*/"Previews"),d=s._(/*BTDS*/"See previews of Facebook content"),m=r("JSResourceForInteraction")("MAWXMAPreviewSettingsDialog.react").__setRef("MAWXMAPreviewsSettingsMenuItem.react");function p(){var e=o("react-compiler-runtime").c(9),t=r("useXMAPreviewsDisabledSetting")(),n=r("useMWXLazyDialog")(m),a=n[0],i;e[0]!==t?(i=t?s._(/*BTDS*/"Off"):s._(/*BTDS*/"On"),e[0]=t,e[1]=i):i=e[1];var l;e[2]!==i?(l={auxText:i,type:"text"},e[2]=i,e[3]=l):l=e[3];var p;e[4]!==a?(p=function(){return a({})},e[4]=a,e[5]=p):p=e[5];var _;return e[6]!==l||e[7]!==p?(_=u.jsx(r("MWXMenuItem.react"),{auxItem:l,onClick:p,primaryText:c,secondaryText:d}),e[6]=l,e[7]=p,e[8]=_):_=e[8],_}l.default=p}),226);
__d("MWChatEncryptedBackupsAccessCodeInput.react",["fbt","BaseTextArea.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useRef,d={input:{backgroundColor:"xjbqb8w",borderTopStyle:"x1ejq31n",borderInlineEndStyle:"x18oe1m7",borderBottomStyle:"x1sy0etr",borderInlineStartStyle:"xstzfhl",color:"xzsf02u",fontSize:"x1lkfr7t",fontWeight:"x1s688f",height:"x5yr21d",insetInlineEnd:"xtijo5x",insetInlineStart:"x1o0tod",left:null,right:null,letterSpacing:null,lineHeight:"x11m8ghp",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingBottom:"x18d9i69",paddingTop:"x1y1aw1k",top:"x1jzctok",width:"xh8yej3","::placeholder_color":"xha3pab",$$css:!0}},m="---- ---- ---- ---- ----\n---- ---- ---- ---- ----",p=40;function _(e){var t=o("react-compiler-runtime").c(30),n=e.autoSubmit,a=e.disabled,i=e.onComplete,l=e.onValueChange,_=e.smallInput,y=e.value,C=n===void 0?!1:n,b=a===void 0?!1:a,v=c(),S=f,R;t[0]!==C||t[1]!==i||t[2]!==l||t[3]!==y?(R=function(t){var e=S(t).substring(0,p),n=S(y);e!==n&&(l(e),e.length===p&&C&&(i==null||i(e)))},t[0]=C,t[1]=i,t[2]=l,t[3]=y,t[4]=R):R=t[4];var L=R,E;t[5]!==_?(E={0:{className:"x443n21 x16qb05n xi7iut8 x1dm3dyd x1pv694p x1g2khh7 xyamay9 x2b8uid x10bruuh x1xmf6yo x67w97k xx281p9"},1:{className:"x443n21 x16qb05n xi7iut8 x1dm3dyd x1pv694p xyamay9 x2b8uid x10bruuh x12nagc x18d9i69 x1s1gtqi"}}[!!_<<0],t[5]=_,t[6]=E):E=t[6];var k,I,T,D;t[7]===Symbol.for("react.memo_cache_sentinel")?(k=u.jsx(r("MWXText.react"),{type:"meta3",children:s._(/*BTDS*/"Includes numbers and letters")}),I={className:"xwzfr38 xr1yuqi x11t971q x4ii5y1 xvc5jky x1n2onr6 x1hfn5x7"},T="x5yr21d x10l6tqk xh8yej3",D={fontFamily:"var(--font-family-code)"},t[7]=k,t[8]=I,t[9]=T,t[10]=D):(k=t[7],I=t[8],T=t[9],D=t[10]);var x;t[11]!==y?(x=y===""?m:h(y),t[11]=y,t[12]=x):x=t[12];var $;t[13]!==b||t[14]!==x?($=u.jsx("div",{className:T,style:D,children:u.jsx(r("BaseTextArea.react"),{disabled:b,maxRows:2,placeholder:m,readOnly:!0,suppressFocusRing:!0,unresizable:!0,value:x,xstyle:d.input})}),t[13]=b,t[14]=x,t[15]=$):$=t[15];var P,N;t[16]===Symbol.for("react.memo_cache_sentinel")?(P="x5yr21d x10l6tqk xh8yej3",N={fontFamily:"var(--font-family-code)"},t[16]=P,t[17]=N):(P=t[16],N=t[17]);var M;t[18]!==y?(M=y===""?y:g(y),t[18]=y,t[19]=M):M=t[19];var w;t[20]!==b||t[21]!==L||t[22]!==M?(w=u.jsx("div",{className:P,style:N,children:u.jsx(r("BaseTextArea.react"),{disabled:b,maxRows:2,onValueChange:L,ref:v,suppressFocusRing:!0,testid:void 0,unresizable:!0,value:M,xstyle:d.input})}),t[20]=b,t[21]=L,t[22]=M,t[23]=w):w=t[23];var A;t[24]!==$||t[25]!==w?(A=u.jsxs("div",babelHelpers.extends({},I,{children:[$,w]})),t[24]=$,t[25]=w,t[26]=A):A=t[26];var F;return t[27]!==A||t[28]!==E?(F=u.jsxs("div",babelHelpers.extends({},E,{children:[k,A]})),t[27]=A,t[28]=E,t[29]=F):F=t[29],F}function f(e){return e.toUpperCase().replace(/[^A-Z0-9]/g,"")}function g(e){var t=e.split(""),n=0,r=[];for(var o of t)r.length===24?r.push("\n"):n>0&&n%4===0&&r.push(" "),r.push(o),n+=1;return r.join("")}function h(e){var t=e.split("");return m.split("").map(function(e){return e===" "||e==="\n"||t.length===0?e:(t.pop()," ")}).join("")}l.default=_}),226);
__d("MWChatEncryptedBackupsAccessCodeInputStep.react",["fbt","EBSMGatingUI","FDSProgressButtonIndeterminate.react","MWChatEncryptedBackupsAccessCodeInput.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","MWEBVirtualDevicesContext.react","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsOtcRestoreSteps","MWXButton.react","MWXText.react","QPLUserFlow","RelayHooks","UserMobileEBState","cr:12326","cr:12327","promiseDone","react","react-compiler-runtime","requireDeferred","useEncryptedBackupsQplImpressionRef","useGetUserMobileEBState","useLabyrinthLogging","useMAWEncryptedBackupsRestoreToast","useMWChatEncryptedBackupsAddDevice","useMWEBFlowSourceContext","usePushPage","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["onHighIntent"],u,c,d=c||(c=o("react")),m=c,p=m.useCallback,_=m.useContext,f=m.useState,g=r("requireDeferred")("MWEBUseLocalStorage").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),h=r("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),y=s._(/*BTDS*/"Submit");function C(t){var a=o("react-compiler-runtime").c(55),i=t.onClose,l=t.onComplete,c=t.onForgotRC,m=t.onSkip,p=t.pushPage,C=t.shouldShowForgotButton,v=C===void 0?!0:C,S;a[0]===Symbol.for("react.memo_cache_sentinel")?(S={},a[0]=S):S=a[0];var R=r("usePushPage")(n("cr:12326"),S),L=R[0],E=R[1],k;if(a[1]!==E){var I=E.onHighIntent,T=babelHelpers.objectWithoutPropertiesLoose(E,e);k=T,a[1]=E,a[2]=k}else k=a[2];var D=r("useGetUserMobileEBState")(),x;a[3]===Symbol.for("react.memo_cache_sentinel")?(x={},a[3]=x):x=a[3];var $=r("usePushPage")(n("cr:12327"),x),P=$[0],N=(u||(u=r("useReStore")))(),M;a[4]===Symbol.for("react.memo_cache_sentinel")?(M=s._(/*BTDS*/"Enter your 40-character code to restore messages on this device."),a[4]=M):M=a[4];var w=M,A=f(""),F=A[0],O=A[1],B=f(!1),W=B[0],q=B[1],U=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),V=U.startFlow,H=_(r("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted,G;a[5]!==H?(G=function(){o("MWChatEncryptedBackupsLogging").endFailure({errorName:"wrong_recovery_code",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:r("MWEBODSEntityKey.enum").INCORRECT_RECOVERY_CODE,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),r("QPLUserFlow").markError(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"invalid_recovery_code_input"),q(!0),H==null||H(!1)},a[5]=H,a[6]=G):G=a[6];var z=G,j=r("useMAWEncryptedBackupsRestoreToast")(),K=j.showErrorToast,Q=r("useMWEBFlowSourceContext")(),X;a[7]!==W?(X=function(t){W&&q(!1),O(t)},a[7]=W,a[8]=X):X=a[8];var Y=X,J=o("RelayHooks").useRelayEnvironment(),Z;a[9]!==N||a[10]!==l?(Z=function(){var e;r("QPLUserFlow").addPoint((e=o("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success"),r("QPLUserFlow").addPoint(e.restoreQplEvent,"restore_auth_finished_and_dismissed"),h.onReady(function(e){var t=e.upsertEBSharedStateEntry;r("promiseDone")(t({db:N,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),g.onReady(b),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:e.restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endSuccess({event:e.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),l()},a[9]=N,a[10]=l,a[11]=Z):Z=a[11];var ee=Z,te;a[12]!==H||a[13]!==K?(te=function(t){o("MWChatEncryptedBackupsLogging").endFailure({errorName:t,event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({errorName:t,event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),K(),H==null||H(!1)},a[12]=H,a[13]=K,a[14]=te):te=a[14];var ne=te,re;a[15]!==z||a[16]!==ee||a[17]!==ne||a[18]!==J?(re={environment:J,onComplete:ee,onFailure:ne,onInvalidRecoveryCode:z},a[15]=z,a[16]=ee,a[17]=ne,a[18]=J,a[19]=re):re=a[19];var oe=r("useMWChatEncryptedBackupsAddDevice")(re),ae=oe[0],ie=oe[1],le=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_IMPRESSION",void 0,function(){_e!=null&&r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")}),se;a[20]!==i||a[21]!==l||a[22]!==c||a[23]!==k||a[24]!==p||a[25]!==L||a[26]!==P||a[27]!==v||a[28]!==D?(se=v?d.jsx(r("MWXButton.react"),babelHelpers.extends({},D.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?k:null,{label:s._(/*BTDS*/"Don\u2019t have your code?"),onPress:function(){D.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?L({onClose:i,onComplete:l}):D.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE?P({onClose:i,onComplete:l,pushPage:p}):(r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_DONT_HAVE_RC"),c())},testid:void 0,type:"secondary"})):null,a[20]=i,a[21]=l,a[22]=c,a[23]=k,a[24]=p,a[25]=L,a[26]=P,a[27]=v,a[28]=D,a[29]=se):se=a[29];var ue=se,ce;a[30]!==i||a[31]!==l||a[32]!==m||a[33]!==p?(ce=function(){o("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onClose:i,onOtcComplete:l,onSkip:m,pushPage:p})},a[30]=i,a[31]=l,a[32]=m,a[33]=p,a[34]=ce):ce=a[34];var de=ce,me=o("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),pe=me.virtualDeviceInfo,_e=pe.doesUserHaveOtcEligibleDevices?d.jsx(r("MWXButton.react"),{label:s._(/*BTDS*/"Use a one-time code instead"),onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),de()},reduceEmphasis:!1,testid:void 0,type:"secondary"}):null,fe=_e!=null?_e:ue,ge;a[35]!==F||a[36]!==ae||a[37]!==Q||a[38]!==ie||a[39]!==H||a[40]!==V?(ge=ie?d.jsx(r("FDSProgressButtonIndeterminate.react"),{label:y}):d.jsx(r("MWXButton.react"),{disabled:F.length<40,label:y,onPress:function(){var e;r("QPLUserFlow").addPoint((e=o("MWChatEncryptedBackupsQPLEvents")).restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_SUBMIT");var t=Q();r("QPLUserFlow").addAnnotations(e.restoreQplEvent,{string:{restore_type:"recovery_code",source:t}}),V({additionalAnnotations:{device_type:"OFFLINE"},event:e.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH,source:t}),r("QPLUserFlow").addPoint(e.restoreDeviceAuthQplEvent,"add_device_begin"),H==null||H(!0),ae(F)},testid:void 0}),a[35]=F,a[36]=ae,a[37]=Q,a[38]=ie,a[39]=H,a[40]=V,a[41]=ge):ge=a[41];var he=ie?null:fe,ye,Ce;a[42]===Symbol.for("react.memo_cache_sentinel")?(ye=s._(/*BTDS*/"Restore your chat history"),Ce=d.jsx("div",{className:"xwib8y2",children:d.jsx(r("MWXText.react"),{type:"meta3",children:w})}),a[42]=ye,a[43]=Ce):(ye=a[42],Ce=a[43]);var be;a[44]!==F||a[45]!==Y?(be=d.jsx(r("MWChatEncryptedBackupsAccessCodeInput.react"),{onValueChange:Y,smallInput:!1,value:F}),a[44]=F,a[45]=Y,a[46]=be):be=a[46];var ve;a[47]!==W?(ve=W?d.jsx("div",{className:"x106a9eq x1xnnf8n xz9dl7a",children:d.jsx(r("MWXText.react"),{align:"center",color:"negative",testid:void 0,type:"meta3",children:s._(/*BTDS*/"Incorrect 40-character code. Try again.")})}):null,a[47]=W,a[48]=ve):ve=a[48];var Se;return a[49]!==le||a[50]!==ge||a[51]!==he||a[52]!==be||a[53]!==ve?(Se=d.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",primaryAction:ge,ref:le,secondaryAction:he,showTopMargin:!1,title:ye,children:[Ce,be,ve]}),a[49]=le,a[50]=ge,a[51]=he,a[52]=be,a[53]=ve,a[54]=Se):Se=a[54],Se}function b(e){var t=e.mwEBCreateLocalStorageEntry,n=e.mwEBDeleteLocalStorageEntry;t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION),t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2),n(r("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}l.default=C}),226);
__d("MWChatEncryptedBackupsAddDeviceWithEBKeys",["EBMainThreadEBDBApiDeferred","EBSMAPI","EBWorkerODSEntityName.enum","MAWBridgeFireAndForget"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.backupId,n=e.db,a=e.newDeviceRegistrationId,i=e.previousDeviceId;return r("EBSMAPI").addDeviceWithEBKeys({backupId:t,db:n,newDeviceRegistrationId:a,previousDeviceId:i,source:r("EBWorkerODSEntityName.enum").MW_EB_AUTO_RESTORE_MAIN_THREAD,trackAddingDevice:function(t){o("EBMainThreadEBDBApiDeferred").addNewDevice(t)}}).then(function(){return o("MAWBridgeFireAndForget").fireAndForget("backend","addDeviceWithKeysInWorker",{backupId:t,deviceRegistrationId:a,isAutoRestore:!0,previousDeviceId:i,source:r("EBWorkerODSEntityName.enum").MW_EB_AUTO_RESTORE_WORKER})})}l.addDeviceWithEBKeys=e}),98);
__d("MWChatEncryptedBackupsChatHistoryDialogQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25383716367917102"}),null);
__d("MWChatEncryptedBackupsChatHistoryDialogQuery$Parameters",["MWChatEncryptedBackupsChatHistoryDialogQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("MWChatEncryptedBackupsChatHistoryDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsChatHistoryDialogQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("MWChatEncryptedBackupsChatHistoryDialog.entrypoint",["JSResourceForInteraction","MWChatEncryptedBackupsChatHistoryDialogQuery$Parameters"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{queryReference:{parameters:r("MWChatEncryptedBackupsChatHistoryDialogQuery$Parameters"),variables:{}}}}},root:r("JSResourceForInteraction")("MWChatEncryptedBackupsChatHistoryDialog.react").__setRef("MWChatEncryptedBackupsChatHistoryDialog.entrypoint")};l.default=e}),98);
__d("MWChatEncryptedBackupsRecoveryCodeIcon.react",["ix","CometImageFromIXValue.react","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react"));function d(t){var n=o("react-compiler-runtime").c(9),a=t.alt,i=t.ref,l=t.xstyle,u=r("useCurrentDisplayMode")(),d=u==="dark",m;n[0]!==d?(m=s(d?"232768":"232770"),n[0]=d,n[1]=m):m=n[1];var p=m,_;n[2]!==a||n[3]!==i||n[4]!==p?(_=c.jsx(r("CometImageFromIXValue.react"),{alt:a,ref:i,source:p}),n[2]=a,n[3]=i,n[4]=p,n[5]=_):_=n[5];var f=_,g;return n[6]!==f||n[7]!==l?(g=l==null?f:c.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(l),{children:f})),n[6]=f,n[7]=l,n[8]=g):g=n[8],g}l.default=d}),98);
__d("MWChatEncryptedBackupsInterstitialIcon.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react"));function d(t){var n=o("react-compiler-runtime").c(9),a=t.alt,i=t.ref,l=t.xstyle,u=r("useCurrentDisplayMode")(),d=u==="dark",m;n[0]!==d?(m=r("gkx")("23219")?s(d?"230225":"230227"):s("835202"),n[0]=d,n[1]=m):m=n[1];var p=m,_;n[2]!==a||n[3]!==i||n[4]!==p?(_=c.jsx(r("CometImageFromIXValue.react"),{alt:a,ref:i,source:p}),n[2]=a,n[3]=i,n[4]=p,n[5]=_):_=n[5];var f=_,g;return n[6]!==f||n[7]!==l?(g=l==null?f:c.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(l),{children:f})),n[6]=f,n[7]=l,n[8]=g):g=n[8],g}l.default=d}),98);
__d("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react",["fbt","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWXButton.react","MWXIconCalendar","MWXIconDocument","MWXIconStrict.react","MWXLink.react","MWXListCell.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more";function d(e){var t=o("react-compiler-runtime").c(16),n=e.onClose,a=e.onDontRestore,i=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_ROAD_IMPRESSION"),l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=u.jsx(r("MWChatEncryptedBackupsInterstitialIcon.react"),{}),t[0]=l):l=t[0];var d;t[1]===Symbol.for("react.memo_cache_sentinel")?(d=s._(/*BTDS*/"Go to chats"),t[1]=d):d=t[1];var p;t[2]!==n||t[3]!==a?(p=u.jsx(r("MWXButton.react"),{label:d,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_GO_TO_CHATS"),a==null||a(),o("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"END_OF_THE_ROAD_GO_TO_CHATS",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),n()}}),t[2]=n,t[3]=a,t[4]=p):p=t[4];var _,f;t[5]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Other steps you can take to restore your messages"),f={className:"xfdjxqc"},t[5]=_,t[6]=f):(_=t[5],f=t[6]);var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:r("MWXIconCalendar"),size:36}),t[7]=g):g=t[7];var h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=s._(/*BTDS*/"Skip restoring for now and try again later from Settings."),t[8]=h):h=t[8];var y;t[9]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWXListCell.react"),{addOnStart:g,content:u.jsx(r("MWXTextPairing.react"),{body:h,bodyColor:"secondary",headline:s._(/*BTDS*/"Restore messages later"),headlineColor:"primary",level:4})}),t[9]=y):y=t[9];var C;t[10]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:r("MWXIconDocument"),size:36}),t[10]=C):C=t[10];var b;t[11]===Symbol.for("react.memo_cache_sentinel")?(b=s._(/*BTDS*/"Find other ways to restore your messages in the {helpCenterLink}.",[s._param("helpCenterLink",u.jsx(r("MWXLink.react"),{display_DEPRECATED:"inline",href:c,onClick:m,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Help Center")})}))]),t[11]=b):b=t[11];var v;t[12]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsxs("div",babelHelpers.extends({},f,{children:[y,u.jsx(r("MWXListCell.react"),{addOnEndVerticalAlign:"center",addOnStart:C,addOnStartVerticalAlign:"center",content:u.jsx(r("MWXTextPairing.react"),{body:b,bodyColor:"secondary",headline:s._(/*BTDS*/"See all restore options"),headlineColor:"primary",level:4})})]})),t[12]=v):v=t[12];var S;return t[13]!==i||t[14]!==p?(S=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{icon:l,primaryAction:p,ref:i,title:_,children:v}),t[13]=i,t[14]=p,t[15]=S):S=t[15],S}function m(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_OPEN_HELP_CENTER_LINK")}l.default=d}),226);
__d("MWChatEncryptedBackupsCreatePinInstruction.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","deferredLoadComponent","react","react-compiler-runtime","requireDeferred","useEncryptedBackupsQplImpressionRef","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useState,p=r("deferredLoadComponent")(r("requireDeferred")("MWChatEncryptedBackupsPinCodeRestoreStep.react").__setRef("MWChatEncryptedBackupsCreatePinInstruction.react")),_="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function f(e){var t=o("react-compiler-runtime").c(32),n=e.onClose,a=e.onComplete,i=e.pushPage,l=m(!0),c=l[0],d=l[1],f=r("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")(),h=f.vestaClientID;c&&h!=null&&d(!1);var y;t[0]!==n||t[1]!==i?(y=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:n})})},t[0]=n,t[1]=i,t[2]=y):y=t[2];var C=y,b;t[3]!==n||t[4]!==a||t[5]!==i||t[6]!==h?(b=function(){return i(function(){return h==null?null:u.jsx(p,{onClose:n,onComplete:a,onSkip:n,pushPage:i})})},t[3]=n,t[4]=a,t[5]=i,t[6]=h,t[7]=b):b=t[7];var v=b,S=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_IMPRESSION"),R;t[8]===Symbol.for("react.memo_cache_sentinel")?(R=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[8]=R):R=t[8];var L;t[9]===Symbol.for("react.memo_cache_sentinel")?(L=s._(/*BTDS*/"Enter PIN"),t[9]=L):L=t[9];var E;t[10]!==v?(E=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_ENTER_PIN_CLICK"),v()},t[10]=v,t[11]=E):E=t[11];var k;t[12]!==c||t[13]!==E?(k=u.jsx(r("MWXButton.react"),{disabled:c,label:L,onPress:E}),t[12]=c,t[13]=E,t[14]=k):k=t[14];var I;t[15]===Symbol.for("react.memo_cache_sentinel")?(I=s._(/*BTDS*/"Can\u2019t create PIN?"),t[15]=I):I=t[15];var T;t[16]!==C?(T=u.jsx(r("MWXButton.react"),{label:I,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_CANT_CREATE_PIN_CLICK"),C()},type:"secondary"}),t[16]=C,t[17]=T):T=t[17];var D;t[18]===Symbol.for("react.memo_cache_sentinel")?(D={className:"xewm4ob"},t[18]=D):D=t[18];var x,$;t[19]===Symbol.for("react.memo_cache_sentinel")?(x=u.jsx("div",babelHelpers.extends({},D,{children:u.jsx(r("MWXText.react"),{align:"center",isSemanticHeading:!0,type:"headlineEmphasized2",children:s._(/*BTDS*/"Create a PIN to restore your chats")})})),$={className:"x162z183 xd9ej83 xm77wn2 xvue9z"},t[19]=x,t[20]=$):(x=t[19],$=t[20]);var P;t[21]===Symbol.for("react.memo_cache_sentinel")?(P=s._(/*BTDS*/"Step 1 \u00b7 Find your mobile device"),t[21]=P):P=t[21];var N;t[22]===Symbol.for("react.memo_cache_sentinel")?(N=s._(/*BTDS*/"It needs to have secure storage turned on."),t[22]=N):N=t[22];var M;t[23]===Symbol.for("react.memo_cache_sentinel")?(M=s._(/*BTDS*/"Learn more about secure storage"),t[23]=M):M=t[23];var w,A;t[24]===Symbol.for("react.memo_cache_sentinel")?(w=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:P,level:4,meta:u.jsxs(u.Fragment,{children:[N," ",u.jsx(r("MWXLink.react"),{"aria-label":M,href:_,onClick:g,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]})})}),A=u.jsx("br",{}),t[24]=w,t[25]=A):(w=t[24],A=t[25]);var F;t[26]===Symbol.for("react.memo_cache_sentinel")?(F=s._(/*BTDS*/"Step 2 \u00b7 Create a PIN on that device"),t[26]=F):F=t[26];var O;t[27]===Symbol.for("react.memo_cache_sentinel")?(O=u.jsxs("div",babelHelpers.extends({},$,{children:[w,A,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:F,level:4,meta:u.jsxs(r("MWXText.react"),{type:"meta4",children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Create PIN")}))])]})})})]})),t[27]=O):O=t[27];var B;return t[28]!==S||t[29]!==k||t[30]!==T?(B=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:R,primaryAction:k,ref:S,secondaryAction:T,children:[x,O]}),t[28]=S,t[29]=k,t[30]=T,t[31]=B):B=t[31],B}function g(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_LEARN_MORE_LINK_CLICK")}l.default=f}),226);
__d("pushRCRestoreStep",["MWEncryptedBackupsForgotRCStep","deferredLoadComponent","react","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=r("deferredLoadComponent")(r("requireDeferred")("MWChatEncryptedBackupsAccessCodeInputStep.react").__setRef("pushRCRestoreStep"));function c(e){var t=e.onClose,n=e.onComplete,r=e.onForgotRC,a=e.pushPage,i=e.shouldShowForgotButton,l=function(){o("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:t,onComplete:n,pushPage:a})},c=r!=null?r:l;a(function(){return s.jsx(u,{onClose:t,onComplete:n,onForgotRC:c,onSkip:t,pushPage:a,shouldShowForgotButton:i})})}l.default=c}),98);
__d("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWEBHasSeenAutoRestoreNoticeContext","MWXButton.react","MWXLink.react","MWXListCell.react","MWXMultiStepDialogHeader.react","MWXTextPairing.react","QPLUserFlow","pushRCRestoreStep","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWEBAutoRestoreNoticeStep"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useContext,d="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function m(e){var t=o("react-compiler-runtime").c(28),n=e.onClose,a=e.onCloseDialogWithConfirmation,i=e.onComplete,l=e.onDontRestore,m=e.pushPage,_=a!=null,f=c(r("MWEBHasSeenAutoRestoreNoticeContext")),g=f.hasSeenNotice,h=r("useMWEBAutoRestoreNoticeStep")(),y;t[0]!==_||t[1]!==a||t[2]!==i||t[3]!==l||t[4]!==m?(y=function(){m(function(){return u.jsxs(u.Fragment,{children:[_?u.jsx(r("MWXMultiStepDialogHeader.react"),{onClose:a,title:null,withCloseButton:!0,withoutBackButton:!0}):null,u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:i,onDontRestore:l})]})})},t[0]=_,t[1]=a,t[2]=i,t[3]=l,t[4]=m,t[5]=y):y=t[5];var C=y,b=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_IMPRESSION"),v;t[6]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[6]=v):v=t[6];var S;t[7]===Symbol.for("react.memo_cache_sentinel")?(S=s._(/*BTDS*/"Enter new code"),t[7]=S):S=t[7];var R;t[8]!==h||t[9]!==g||t[10]!==n||t[11]!==i||t[12]!==m?(R=u.jsx(r("MWXButton.react"),{label:S,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_ENTER_CODE"),r("pushRCRestoreStep")({onClose:n,onComplete:function(){h({hasSeenNotice:g,onNextStep:i,pushPage:m})},pushPage:m,shouldShowForgotButton:!1})},testid:void 0}),t[8]=h,t[9]=g,t[10]=n,t[11]=i,t[12]=m,t[13]=R):R=t[13];var L;t[14]===Symbol.for("react.memo_cache_sentinel")?(L=s._(/*BTDS*/"Can\u2019t generate code?"),t[14]=L):L=t[14];var E;t[15]!==C?(E=u.jsx(r("MWXButton.react"),{label:L,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_CANT_GENERATE_CODE"),C()},type:"secondary"}),t[15]=C,t[16]=E):E=t[16];var k,I;t[17]===Symbol.for("react.memo_cache_sentinel")?(k=s._(/*BTDS*/"Generate a new code to restore your chats"),I={className:"xvue9z"},t[17]=k,t[18]=I):(k=t[17],I=t[18]);var T;t[19]===Symbol.for("react.memo_cache_sentinel")?(T=s._(/*BTDS*/"It needs to have secure storage turned on. It\u2019s likely to be the device you used to create your original 40-character code."),t[19]=T):T=t[19];var D;t[20]===Symbol.for("react.memo_cache_sentinel")?(D=u.jsxs(u.Fragment,{children:[T," ",u.jsx(r("MWXLink.react"),{display_DEPRECATED:"inline",href:d,onClick:p,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]}),t[20]=D):D=t[20];var x;t[21]===Symbol.for("react.memo_cache_sentinel")?(x=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{body:D,bodyColor:"secondary",headline:s._(/*BTDS*/"Step 1 \u00b7 Find your other device"),level:4})}),t[21]=x):x=t[21];var $;t[22]===Symbol.for("react.memo_cache_sentinel")?($=u.jsxs(u.Fragment,{children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Generate recovery code")}))])]}),t[22]=$):$=t[22];var P;t[23]===Symbol.for("react.memo_cache_sentinel")?(P=u.jsxs("div",babelHelpers.extends({},I,{children:[x,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{body:$,bodyColor:"secondary",headline:s._(/*BTDS*/"Step 2 \u00b7 Generate a new code on that device"),level:4})})]})),t[23]=P):P=t[23];var N;return t[24]!==b||t[25]!==R||t[26]!==E?(N=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:v,primaryAction:R,ref:b,secondaryAction:E,title:k,children:P}),t[24]=b,t[25]=R,t[26]=E,t[27]=N):N=t[27],N}function p(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_SCREEN_ACTION_OPEN_LEARN_MORE_LINK")}l.default=m}),226);
__d("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWEBHasSeenAutoRestoreNoticeContext","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","pushRCRestoreStep","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWEBAutoRestoreNoticeStep","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useContext,p=c.useState,_="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function f(e){var t=o("react-compiler-runtime").c(35),n=e.onClose,a=e.onComplete,i=e.pushPage,l=p(!0),c=l[0],d=l[1],f=r("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")(),h=f.offlineDevicesCount,y=r("useMWEBAutoRestoreNoticeStep")(),C=m(r("MWEBHasSeenAutoRestoreNoticeContext")),b=C.hasSeenNotice;c&&h>0&&d(!1);var v;t[0]!==n||t[1]!==i?(v=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:n})})},t[0]=n,t[1]=i,t[2]=v):v=t[2];var S=v,R;t[3]!==n||t[4]!==a||t[5]!==i?(R=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[3]=n,t[4]=a,t[5]=i,t[6]=R):R=t[6];var L=R,E=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_IMPRESSION"),k;t[7]===Symbol.for("react.memo_cache_sentinel")?(k=u.jsx(r("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),t[7]=k):k=t[7];var I;t[8]===Symbol.for("react.memo_cache_sentinel")?(I=s._(/*BTDS*/"Enter 40-character code"),t[8]=I):I=t[8];var T;t[9]!==y||t[10]!==b||t[11]!==n||t[12]!==L||t[13]!==i?(T=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_ENTER_CODE_CLICK"),r("pushRCRestoreStep")({onClose:n,onComplete:function(){y({hasSeenNotice:b,onNextStep:n,pushPage:i})},onForgotRC:L,pushPage:i,shouldShowForgotButton:!1})},t[9]=y,t[10]=b,t[11]=n,t[12]=L,t[13]=i,t[14]=T):T=t[14];var D;t[15]!==c||t[16]!==T?(D=u.jsx(r("MWXButton.react"),{disabled:c,label:I,onPress:T}),t[15]=c,t[16]=T,t[17]=D):D=t[17];var x;t[18]===Symbol.for("react.memo_cache_sentinel")?(x=s._(/*BTDS*/"Can\u2019t generate code?"),t[18]=x):x=t[18];var $;t[19]!==S?($=u.jsx(r("MWXButton.react"),{label:x,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_CANT_GENERATE_CODE_CLICK"),S()},type:"secondary"}),t[19]=S,t[20]=$):$=t[20];var P;t[21]===Symbol.for("react.memo_cache_sentinel")?(P={className:"xewm4ob"},t[21]=P):P=t[21];var N,M;t[22]===Symbol.for("react.memo_cache_sentinel")?(N=u.jsx("div",babelHelpers.extends({},P,{children:u.jsx(r("MWXText.react"),{align:"center",isSemanticHeading:!0,type:"headlineEmphasized2",children:s._(/*BTDS*/"Generate a 40-character code to restore your chats")})})),M={className:"x162z183 xd9ej83 xm77wn2 xvue9z"},t[22]=N,t[23]=M):(N=t[22],M=t[23]);var w;t[24]===Symbol.for("react.memo_cache_sentinel")?(w=s._(/*BTDS*/"Step 1 \u00b7 Find your mobile device"),t[24]=w):w=t[24];var A;t[25]===Symbol.for("react.memo_cache_sentinel")?(A=s._(/*BTDS*/"It needs to have secure storage turned on."),t[25]=A):A=t[25];var F;t[26]===Symbol.for("react.memo_cache_sentinel")?(F=s._(/*BTDS*/"Learn more about secure storage"),t[26]=F):F=t[26];var O,B;t[27]===Symbol.for("react.memo_cache_sentinel")?(O=u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:w,level:4,meta:u.jsxs(u.Fragment,{children:[A," ",u.jsx(r("MWXLink.react"),{"aria-label":F,display_DEPRECATED:"inline",href:_,onClick:g,rel:"noreferrer",target:"_blank",children:u.jsx("b",{children:s._(/*BTDS*/"Learn more")})})]})})}),B=u.jsx("br",{}),t[27]=O,t[28]=B):(O=t[27],B=t[28]);var W;t[29]===Symbol.for("react.memo_cache_sentinel")?(W=s._(/*BTDS*/"Step 2 \u00b7 Generate a 40-character code on that device"),t[29]=W):W=t[29];var q;t[30]===Symbol.for("react.memo_cache_sentinel")?(q=u.jsxs("div",babelHelpers.extends({},M,{children:[O,B,u.jsx(r("MWXListCell.react"),{content:u.jsx(r("MWXTextPairing.react"),{headline:W,level:4,meta:u.jsxs(r("MWXText.react"),{type:"meta4",children:[s._(/*BTDS*/"1. Go to Messenger Settings"),u.jsx("br",{}),s._(/*BTDS*/"2. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Privacy & safety")}))]),u.jsx("br",{}),s._(/*BTDS*/"3. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"End-to-end encrypted chats")}))]),u.jsx("br",{}),s._(/*BTDS*/"4. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Message storage")}))]),u.jsx("br",{}),s._(/*BTDS*/"5. Tap {=m1}",[s._implicitParam("=m1",u.jsx("b",{children:s._(/*BTDS*/"Generate recovery code")}))])]})})})]})),t[30]=q):q=t[30];var U;return t[31]!==E||t[32]!==D||t[33]!==$?(U=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:k,primaryAction:D,ref:E,secondaryAction:$,children:[N,q]}),t[31]=E,t[32]=D,t[33]=$,t[34]=U):U=t[34],U}function g(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_LEARN_MORE_LINK_CLICK")}l.default=f}),226);
__d("MWChatEncryptedBackupsDots3HorizontalIconSmall.react",["ix","FDSDots3HorizontalFilled20Icon","MWXIcon_DEPRECATED.react","cr:1376","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var a=n("cr:1376")!=null?new(n("cr:1376"))(s("275834"),24,24):r("FDSDots3HorizontalFilled20Icon");t=u.jsx(r("MWXIcon_DEPRECATED.react"),{color:"primary",icon:a}),e[0]=t}else t=e[0];return t}l.default=c}),98);
__d("MWChatEncryptedBackupsTextIconSmall.react",["ix","FDSTextFilled20Icon","MWXIcon_DEPRECATED.react","cr:1376","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var a=n("cr:1376")!=null?new(n("cr:1376"))(s("275886"),24,24):r("FDSTextFilled20Icon");t=u.jsx(r("MWXIcon_DEPRECATED.react"),{color:"primary",icon:a}),e[0]=t}else t=e[0];return t}l.default=c}),98);
__d("MWChatEncryptedBackupsEOTRPhaseOne",["fbt","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsChevronRightIconMedium.react","MWChatEncryptedBackupsCreatePinInstruction.react","MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react","MWChatEncryptedBackupsDots3HorizontalIconSmall.react","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsTextIconSmall.react","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useCallback;function d(e){var t=o("react-compiler-runtime").c(28),n=e.onClose,a=e.onComplete,i=e.pushPage,l;t[0]!==n||t[1]!==a||t[2]!==i?(l=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsCreatePinInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[0]=n,t[1]=a,t[2]=i,t[3]=l):l=t[3];var c=l,d;t[4]!==n||t[5]!==a||t[6]!==i?(d=function(){return i(function(){return u.jsx(r("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react"),{onClose:n,onComplete:a,pushPage:i})})},t[4]=n,t[5]=a,t[6]=i,t[7]=d):d=t[7];var m=d,p=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_OPTIONS_IMPRESSION"),_;t[8]===Symbol.for("react.memo_cache_sentinel")?(_=u.jsx(r("MWChatEncryptedBackupsInterstitialIcon.react"),{}),t[8]=_):_=t[8];var f;t[9]===Symbol.for("react.memo_cache_sentinel")?(f=s._(/*BTDS*/"Restore your end-to-end encrypted chats with your mobile device"),t[9]=f):f=t[9];var g,h;t[10]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXText.react"),{color:"secondary",type:"body4",children:s._(/*BTDS*/"Try one of these methods to get your chats on this device.")}),h={className:"x1miatn0 x2b8uid xk68kj7"},t[10]=g,t[11]=h):(g=t[10],h=t[11]);var y;t[12]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),t[12]=y):y=t[12];var C;t[13]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWChatEncryptedBackupsAddonIcon.react"),{icon:u.jsx(r("MWChatEncryptedBackupsDots3HorizontalIconSmall.react"),{})}),t[13]=C):C=t[13];var b;t[14]===Symbol.for("react.memo_cache_sentinel")?(b=u.jsx(r("MWXTextPairing.react"),{headline:s._(/*BTDS*/"Learn how to create a PIN"),level:4}),t[14]=b):b=t[14];var v;t[15]!==c?(v=u.jsx(r("MWXListCellPressable.react"),{addOnEnd:y,addOnEndVerticalAlign:"center",addOnStart:C,addOnStartVerticalAlign:"center",content:b,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_PIN_CODE_CLICK"),c()}}),t[15]=c,t[16]=v):v=t[16];var S;t[17]===Symbol.for("react.memo_cache_sentinel")?(S=u.jsx(r("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),t[17]=S):S=t[17];var R;t[18]===Symbol.for("react.memo_cache_sentinel")?(R=u.jsx(r("MWChatEncryptedBackupsAddonIcon.react"),{icon:u.jsx(r("MWChatEncryptedBackupsTextIconSmall.react"),{})}),t[18]=R):R=t[18];var L;t[19]===Symbol.for("react.memo_cache_sentinel")?(L=u.jsx(r("MWXTextPairing.react"),{headline:s._(/*BTDS*/"Learn how to generate a 40-character code"),level:4}),t[19]=L):L=t[19];var E;t[20]!==m?(E=u.jsx(r("MWXListCellPressable.react"),{addOnEnd:S,addOnEndVerticalAlign:"center",addOnStart:R,addOnStartVerticalAlign:"center",content:L,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_RECOVERY_CODE_CLICK"),m()}}),t[20]=m,t[21]=E):E=t[21];var k;t[22]!==v||t[23]!==E?(k=u.jsxs("div",babelHelpers.extends({},h,{children:[v,E]})),t[22]=v,t[23]=E,t[24]=k):k=t[24];var I;return t[25]!==p||t[26]!==k?(I=u.jsxs(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"row",icon:_,ref:p,title:f,children:[g,k]}),t[25]=p,t[26]=k,t[27]=I):I=t[27],I}l.default=d}),226);
__d("MWChatEncryptedBackupsEOTRPhaseTwoOrThree.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWEBChatDoubleInterstitialAlphaIcon.react","MWXButton.react","MWXText.react","UserMobileEBState","cr:12326","cr:12327","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useGetUserMobileEBState","usePushPage"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){var t=o("react-compiler-runtime").c(16),a=e.onClose,i=e.onComplete,l=e.pushPage,c=r("useGetUserMobileEBState")(),d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d={},t[0]=d):d=t[0];var m=r("usePushPage")(n("cr:12326"),d),p=m[0],_;t[1]===Symbol.for("react.memo_cache_sentinel")?(_={},t[1]=_):_=t[1];var f=r("usePushPage")(n("cr:12327"),_),g=f[0],h=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_OPTIONS_EOTR_IMPRESSION"),y;t[2]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWEBChatDoubleInterstitialAlphaIcon.react"),{}),t[2]=y):y=t[2];var C;t[3]===Symbol.for("react.memo_cache_sentinel")?(C=s._(/*BTDS*/"See options"),t[3]=C):C=t[3];var b;t[4]!==a||t[5]!==i||t[6]!==p||t[7]!==g||t[8]!==l||t[9]!==c.state?(b=u.jsx(r("MWXButton.react"),{label:C,onPress:function(){c.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?p({onClose:a,onComplete:i}):g({onClose:a,onComplete:i,pushPage:l})},type:"primary"}),t[4]=a,t[5]=i,t[6]=p,t[7]=g,t[8]=l,t[9]=c.state,t[10]=b):b=t[10];var v;t[11]===Symbol.for("react.memo_cache_sentinel")?(v=s._(/*BTDS*/"Chat history can\u2019t be restored on this device"),t[11]=v):v=t[11];var S;t[12]===Symbol.for("react.memo_cache_sentinel")?(S=u.jsx(r("MWXText.react"),{color:"secondary",type:"body4",children:s._(/*BTDS*/"Some messages may be missing from your chats.")}),t[12]=S):S=t[12];var R;return t[13]!==h||t[14]!==b?(R=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"row",icon:y,innerContentPaddingVertical:8,primaryAction:b,ref:h,title:v,children:S}),t[13]=h,t[14]=b,t[15]=R):R=t[15],R}l.default=c}),226);
__d("MWChatEncryptedBackupsHandleRestoreWrapper.react",["cr:6736","cr:8598","cr:8599","cr:8601"],(function(t,n,r,o,a,i,l){"use strict";function e(){return n("cr:8598")==null||n("cr:8598")(),n("cr:8599")==null||n("cr:8599")(),n("cr:8601")==null||n("cr:8601")(),n("cr:6736")==null||n("cr:6736")(),null}l.default=e}),98);
__d("MWChatEncryptedBackupsKVSOnlyRestoreStep.react",["MWChatEncryptedBackupsEOTRPhaseOne","UserMobileEBState","cr:27431","react","react-compiler-runtime","useGetUserMobileEBState"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(8),a=e.onClose,i=e.onComplete,l=e.pushPage,u=r("useGetUserMobileEBState")(),c=u.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE||u.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE;if(c&&n("cr:27431")!=null){var d;return t[0]!==a||t[1]!==i||t[2]!==l?(d=s.jsx(n("cr:27431"),{onClose:a,onComplete:i,pushPage:l}),t[0]=a,t[1]=i,t[2]=l,t[3]=d):d=t[3],d}var m;return t[4]!==a||t[5]!==i||t[6]!==l?(m=s.jsx(r("MWChatEncryptedBackupsEOTRPhaseOne"),{onClose:a,onComplete:i,pushPage:l}),t[4]=a,t[5]=i,t[6]=l,t[7]=m):m=t[7],m}l.default=u}),98);
__d("MWEBCreateNewBackupDialog.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{}}},root:r("JSResourceForInteraction")("MWEBCreateNewBackupDialog.react").__setRef("MWEBCreateNewBackupDialog.entrypoint")};l.default=e}),98);
__d("useNoPinCodeDialogButtonProps",["fbt","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBCreateNewBackupDialog.entrypoint","MWEBSendRequestToUntrustedMobileWithDeviceInfoDialog.entrypoint","MWEncryptedBackupsOtcRestoreSteps","QPLUserFlow","UserMobileEBState","react","react-compiler-runtime","useGetUserMobileEBState","usePushPage"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["onHighIntent"],u=["onHighIntent"],c,d=c||(c=o("react")),m=d.useCallback,p=d.useContext;function _(t,n,a,i,l,c,d){var m=o("react-compiler-runtime").c(37),_=r("useGetUserMobileEBState")(),f;m[0]===Symbol.for("react.memo_cache_sentinel")?(f={},m[0]=f):f=m[0];var g=r("usePushPage")(r("MWEBSendRequestToUntrustedMobileWithDeviceInfoDialog.entrypoint"),f),h=g[0],y=g[1],C;if(m[1]!==y){var b=y.onHighIntent,v=babelHelpers.objectWithoutPropertiesLoose(y,e);C=v,m[1]=y,m[2]=C}else C=m[2];var S=p(r("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted,R;m[3]===Symbol.for("react.memo_cache_sentinel")?(R={},m[3]=R):R=m[3];var L=r("usePushPage")(r("MWEBCreateNewBackupDialog.entrypoint"),R),E=L[0],k=L[1],I;if(m[4]!==k){var T=k.onHighIntent,D=babelHelpers.objectWithoutPropertiesLoose(k,u);I=D,m[4]=k,m[5]=I}else I=m[5];var x;m[6]!==t||m[7]!==n||m[8]!==a||m[9]!==i?(x=function(){o("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onClose:t,onOtcComplete:n,onSkip:a,pushPage:i})},m[6]=t,m[7]=n,m[8]=a,m[9]=i,m[10]=x):x=m[10];var $=x;if(_.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE){var P;m[11]===Symbol.for("react.memo_cache_sentinel")?(P=s._(/*BTDS*/"See options"),m[11]=P):P=m[11];var N;m[12]!==c||m[13]!==E||m[14]!==t||m[15]!==n||m[16]!==a||m[17]!==i||m[18]!==S?(N=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,c),S(!0),E({onClose:t,onComplete:n,onSkip:a,pushPage:i})},m[12]=c,m[13]=E,m[14]=t,m[15]=n,m[16]=a,m[17]=i,m[18]=S,m[19]=N):N=m[19];var M;return m[20]!==I||m[21]!==N?(M=babelHelpers.extends({},I,{label:P,onPress:N}),m[20]=I,m[21]=N,m[22]=M):M=m[22],M}else if(_.state===o("UserMobileEBState").UserMobileEBState.TRUSTED_MOBILE){var w;m[23]===Symbol.for("react.memo_cache_sentinel")?(w=s._(/*BTDS*/"Send code"),m[23]=w):w=m[23];var A;return m[24]!==$||m[25]!==l?(A={label:w,onPress:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,l),$()}},m[24]=$,m[25]=l,m[26]=A):A=m[26],A}else{var F;m[27]===Symbol.for("react.memo_cache_sentinel")?(F=s._(/*BTDS*/"See options"),m[27]=F):F=m[27];var O;m[28]!==t||m[29]!==n||m[30]!==i||m[31]!==h||m[32]!==d?(O=function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,d),h({onClose:t,onComplete:n,pushPage:i})},m[28]=t,m[29]=n,m[30]=i,m[31]=h,m[32]=d,m[33]=O):O=m[33];var B;return m[34]!==C||m[35]!==O?(B=babelHelpers.extends({},C,{label:F,onPress:O}),m[34]=C,m[35]=O,m[36]=B):B=m[36],B}}l.default=_}),226);
__d("MWChatEncryptedBackupsNoPINDialog.react",["fbt","MWChatEncryptedBackupsErrorPhoneIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXText.react","QPLUserFlow","UserMobileEBState","react","react-compiler-runtime","useGetUserMobileEBState","useNoPinCodeDialogButtonProps","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){return e===o("UserMobileEBState").UserMobileEBState.TRUSTED_MOBILE?{subtitle:s._(/*BTDS*/"Get a one-time code from the Messenger or Facebook mobile app to restore your chat history on this device."),title:s._(/*BTDS*/"Send a one-time code to restore your chat history")}:e===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE||e===o("UserMobileEBState").UserMobileEBState.NO_MOBILE?{subtitle:s._(/*BTDS*/"You don't have a way to restore your chat history on this device."),title:s._(/*BTDS*/"Chat history can't be restored on this device")}:e===o("UserMobileEBState").UserMobileEBState.UNKNOWN?{subtitle:s._(/*BTDS*/"Something went wrong. Please try again later."),title:s._(/*BTDS*/"Unable to restore your chats")}:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+e)})()}function d(e){var t=o("react-compiler-runtime").c(15),n=e.onClose,a=e.onComplete,i=e.onSkip,l=e.pushPage,s=r("useGetUserMobileEBState")(),d;t[0]!==s.state?(d=c(s.state),t[0]=s.state,t[1]=d):d=t[1];var m=d,p=m.subtitle,_=m.title,f;t[2]!==s.state?(f={onVisible:function(){e:{if(s.state===o("UserMobileEBState").UserMobileEBState.TRUSTED_MOBILE){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"NO_PIN_RESTORE_IMPRESSION_TRUSTED_MOBILE");break e}if(s.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"NO_PIN_RESTORE_IMPRESSION_UNTRUSTED_MOBILE");break e}if(s.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"NO_PIN_RESTORE_IMPRESSION_NO_MOBILE");break e}if(s.state===o("UserMobileEBState").UserMobileEBState.UNKNOWN){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"NO_PIN_RESTORE_IMPRESSION_UNKNOWN");break e}throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+s.state)}}},t[2]=s.state,t[3]=f):f=t[3];var g=r("useVisibilityObserver")(f),h=r("useNoPinCodeDialogButtonProps")(n,a,i,l,"NO_PIN_TRUSTED_USE_ONE_TIME_CODE_CLICK","NO_PIN_NO_MOBILE_CREATE_NEW_BACKUP_CLICK","NO_PIN_UNTRUSTED_MOBILE_SEE_OPTIONS_CLICK"),y;t[4]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWChatEncryptedBackupsErrorPhoneIcon.react"),{}),t[4]=y):y=t[4];var C;t[5]!==h.label||t[6]!==h.onPress?(C=u.jsx(r("MWXButton.react"),{label:h.label,onPress:h.onPress,testid:void 0,type:"primary"}),t[5]=h.label,t[6]=h.onPress,t[7]=C):C=t[7];var b;t[8]!==p?(b=u.jsx(r("MWXColumn.react"),{children:u.jsx(r("MWXColumnItem.react"),{paddingTop:16,children:u.jsx(r("MWXText.react"),{color:"secondary",type:"body3",children:p})})}),t[8]=p,t[9]=b):b=t[9];var v;return t[10]!==g||t[11]!==C||t[12]!==b||t[13]!==_?(v=u.jsx(r("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"row",icon:y,primaryAction:C,ref:g,title:_,children:b}),t[10]=g,t[11]=C,t[12]=b,t[13]=_,t[14]=v):v=t[14],v}l.default=d}),226);
__d("MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react",["MWEncryptedBackupsForgotPinStep","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","href","onClick","onHoverEnd","onHoverStart","onPressStart","rel","target"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(5),r=t.children,a=t.dismissSoftblock,i;n[0]!==a?(i={onDismiss:a},n[0]=a,n[1]=i):i=n[1];var l=o("MWEncryptedBackupsForgotPinStep").useForgotPinLinkShowDialogProps(i),s;if(n[2]!==r||n[3]!==l){var u=l.children,c=l.href,d=l.onClick,m=l.onHoverEnd,p=l.onHoverStart,_=l.onPressStart,f=l.rel,g=l.target,h=babelHelpers.objectWithoutPropertiesLoose(l,e),y=babelHelpers.extends({},h,{label:u,linkProps:c!=null?{rel:f,target:g,url:c}:void 0,onHoverIn:p,onHoverOut:m,onPress:d,onPressIn:_});s=r({buttonProps:y,linkProps:l}),n[2]=r,n[3]=l,n[4]=s}else s=n[4];return s}l.default=c}),98);
__d("MWChatSidebarEncryptedBackupsMenuItem.react",["fbt","MAWEncryptedBackupsStateManager","MWChatEncryptedBackupsSettingsDialog.entrypoint","MWEBEntrypointsKillswitch.enum","MWJewelPopoverDialogContext.react","MWXMenuItem.react","promiseDone","react","react-compiler-runtime","requireDeferred","useMWEBBackupState","useMWXEntryPointDialog","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=u.useContext,m=r("requireDeferred")("MWEncryptedBackupsFetchBackupMetadata").__setRef("MWChatSidebarEncryptedBackupsMenuItem.react"),p=s._(/*BTDS*/"Message storage"),_=s._(/*BTDS*/"Manage how you store and access your chat history.");function f(){var t=o("react-compiler-runtime").c(7),n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n={},t[0]=n):n=t[0];var a=r("useMWXEntryPointDialog")(r("MWChatEncryptedBackupsSettingsDialog.entrypoint"),n),i=a[0],l=d(r("MWJewelPopoverDialogContext.react")),s=l.setIsOpenForDialog,u=(e||(e=r("useReStore")))(),f;t[1]===Symbol.for("react.memo_cache_sentinel")?(f={entrypoint:r("MWEBEntrypointsKillswitch.enum").EB_SETTINGS},t[1]=f):f=t[1];var g=r("useMWEBBackupState")(f),h;if(t[2]!==g||t[3]!==s||t[4]!==i||t[5]!==u){var y=function(){o("MAWEncryptedBackupsStateManager").eligibleForEBUX(g)&&m.onReady(function(e){var t=e.fetchBackupMetadata;r("promiseDone")(t(u))}),s(!0),i({})};h=c.jsx(r("MWXMenuItem.react"),{onClick:y,primaryText:p,role:"button",secondaryText:_,testid:void 0}),t[2]=g,t[3]=s,t[4]=i,t[5]=u,t[6]=h}else h=t[6];return h}l.default=f}),226);
__d("MWChatSidebarSettingsE2EEChatsMenu.react",["fbt","MAWSecurityAlertsMenuItem.react","MAWXMAPreviewsSettingsMenuItem.react","MWXDivider.react","MWXMenuItemWithSubmenu.react","MetaConfig","cr:3079","cr:6692","cr:6733","cr:7398","cr:8596","cr:8597","gkx","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d=c||(c=o("react")),m={divider:{marginTop:"x1gslohp",marginBottom:"x12nagc",marginInlineStart:"xyqm7xq",marginInlineEnd:"x1ys307a",marginLeft:null,marginRight:null,$$css:!0}},p=s._(/*BTDS*/"End-to-end encrypted chats"),_=s._(/*BTDS*/"Manage your end-to-end encrypted chat settings"),f=r("MetaConfig")._("37"),g=!f&&r("gkx")("11645")?null:(e=(u=n("cr:8596"))!=null?u:n("cr:8597"))!=null?e:n("cr:6733");function h(){var e=o("react-compiler-runtime").c(4),t,a,i;e[0]===Symbol.for("react.memo_cache_sentinel")?(t={title:p},a=g!=null?d.jsx(g,{},"encrypted-backups-comet"):null,i=d.jsx(r("MAWSecurityAlertsMenuItem.react"),{},"security-alerts-after-redesign"),e[0]=t,e[1]=a,e[2]=i):(t=e[0],a=e[1],i=e[2]);var l;return e[3]===Symbol.for("react.memo_cache_sentinel")?(l=d.jsx(r("MWXMenuItemWithSubmenu.react"),{primaryText:p,secondaryText:_,submenu:{header:t,items:[a,i,d.jsxs(d.Fragment,{children:[d.jsx(r("MWXDivider.react"),{xstyle:m.divider}),d.jsx(r("MAWXMAPreviewsSettingsMenuItem.react"),{})]},"settings-xma-previews"),n("cr:3079")!=null?d.jsx(n("cr:3079"),{},"encrypted-backups-dev-options"):null,n("cr:6692")&&d.jsx(n("cr:6692"),{},"persisted-eb-state-menu"),n("cr:7398")!=null?d.jsx(n("cr:7398"),{},"reset-menu"):null]},testid:void 0}),e[3]=l):l=e[3],l}l.default=h}),226);
__d("MWChatSidebarSettingsVerifyKeysInChatMenuItem.react",["fbt","FDSMenuItemCheckbox.react","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsSharedState","MWXMenuItemWithSubmenu.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(8),t=o("MWEncryptedBackupsSharedState").useEBSharedStateEntry(r("MWEncryptedBackupsLocalStorageEntryEnum").VERIFY_KEYS_IN_CHAT_ENABLED),n=t[0],a=t[1],i=n==="true",l;e[0]!==i||e[1]!==a?(l=function(){a(i?"false":"true")},e[0]=i,e[1]=a,e[2]=l):l=e[2];var c;e[3]===Symbol.for("react.memo_cache_sentinel")?(c=s._(/*BTDS*/"Verify keys in chat"),e[3]=c):c=e[3];var d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=u.jsx(r("MWXText.react"),{color:"secondary",type:"body4",children:s._(/*BTDS*/"Click on a message to view your keys or another person's keys.")}),e[4]=d):d=e[4];var m;return e[5]!==i||e[6]!==l?(m=u.jsx(r("FDSMenuItemCheckbox.react"),{asSwitch:!0,isSelected:i,onClick:l,preventClosingMenuOnSelect:!0,primaryText:c,secondaryText:d}),e[5]=i,e[6]=l,e[7]=m):m=e[7],m}function d(){var e=o("react-compiler-runtime").c(6),t=o("MWEncryptedBackupsSharedState").useEBSharedStateEntry(r("MWEncryptedBackupsLocalStorageEntryEnum").VERIFY_KEYS_IN_CHAT_ENABLED),n=t[0],a=n==="true",i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=s._(/*BTDS*/"Verify keys in chat"),e[0]=i):i=e[0];var l;e[1]!==a?(l=a?s._(/*BTDS*/"On"):s._(/*BTDS*/"Off"),e[1]=a,e[2]=l):l=e[2];var d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d={header:{title:s._(/*BTDS*/"Verify keys")},items:[u.jsx(c,{},"verify-keys")]},e[3]=d):d=e[3];var m;return e[4]!==l?(m=u.jsx(r("MWXMenuItemWithSubmenu.react"),{primaryText:i,secondaryText:l,submenu:d}),e[4]=l,e[5]=m):m=e[5],m}l.default=d}),226);
__d("MWSupportInboxDialogQuery$Parameters",["MWSupportInboxDialogQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("MWSupportInboxDialogQuery_facebookRelayOperation"),metadata:{},name:"MWSupportInboxDialogQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("MWSupportInboxDialog.entrypoint",["JSResourceForInteraction","MWSupportInboxDialogQuery$Parameters","WebPixelRatio"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{queryReference:{options:{fetchPolicy:"network-only"},parameters:r("MWSupportInboxDialogQuery$Parameters"),variables:{scale:o("WebPixelRatio").get()}}}}},root:r("JSResourceForInteraction")("MWSupportInboxDialog.react").__setRef("MWSupportInboxDialog.entrypoint")};l.default=e}),98);
__d("XSupportInboxControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/support/",Object.freeze({second:!1,shimmed_in_item:!1}),void 0),s=e;l.default=s}),98);
__d("MWSupportInboxMenuItem.react",["fbt","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWSupportInboxDialog.entrypoint","MWXMenuItem.react","MessengerWebUXLogger","QPLUserFlow","XSupportInboxControllerRouteBuilder","gkx","qpl","react","react-compiler-runtime","useMWXEntryPointDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useContext;function d(){var e=o("react-compiler-runtime").c(12),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t={},e[0]=t):t=e[0];var n=r("useMWXEntryPointDialog")(r("MWSupportInboxDialog.entrypoint"),t),a=n[0],i=c(r("MWJewelPopoverDialogContext.react")),l=i.setIsOpenForDialog,d=r("MessengerWebUXLogger").useInteractionLogger(),m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m={eventName:"support_inbox_entrypoint_impression"},e[1]=m):m=e[1];var p=r("MessengerWebUXLogger").useImpressionLoggerRef(m),_;e[2]===Symbol.for("react.memo_cache_sentinel")?(_=r("gkx")("23433")?void 0:r("XSupportInboxControllerRouteBuilder").buildURL({}),e[2]=_):_=e[2];var f;e[3]!==d||e[4]!==l||e[5]!==a?(f=function(){d==null||d({eventName:"support_inbox_entrypoint_click"}),r("gkx")("23433")&&(r("QPLUserFlow").start(r("qpl")._(25305734,"469")),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","support_inbox"),l(!0),a({}))},e[3]=d,e[4]=l,e[5]=a,e[6]=f):f=e[6];var g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g=s._(/*BTDS*/"Reported chats"),e[7]=g):g=e[7];var h;e[8]===Symbol.for("react.memo_cache_sentinel")?(h=s._(/*BTDS*/"View updates about your reports"),e[8]=h):h=e[8];var y;return e[9]!==p||e[10]!==f?(y=u.jsx(r("MWXMenuItem.react"),{href:_,onClick:f,primaryText:g,ref:p,secondaryText:h}),e[9]=p,e[10]=f,e[11]=y):y=e[11],y}l.default=d}),226);
__d("MWChatSidebarSettingsPrivacyMenu.react",["fbt","FDSMenuSeparator.react","MWChatSidebarSettingsVerifyKeysInChatMenuItem.react","MWEBEntrypointsKillswitch.enum","MWPBumpEntityKey","MWSupportInboxMenuItem.react","MWXIconMenuItemHouseKeyhole","MWXMenuItemWithSubmenu.react","cr:20183","cr:7253","gkx","react","react-compiler-runtime","useMWEBBackupState"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(10),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t={entrypoint:r("MWEBEntrypointsKillswitch.enum").SIDEBAR_SETTINGS_PRIVACY_MENU},e[0]=t):t=e[0];var a=r("useMWEBBackupState")(t),i;if(e[1]!==a){if(i=[],n("cr:7253")!=null){var l;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=u.jsx(n("cr:7253"),{},"settings-e2ee-chats"),e[3]=l):l=e[3],i.push(l)}if(n("cr:20183")!=null){var c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c=u.jsx(n("cr:20183"),{},"settings-read-receipts"),e[4]=c):c=e[4],i.push(c)}var m;if(e[5]===Symbol.for("react.memo_cache_sentinel")?(m=u.jsx(r("MWSupportInboxMenuItem.react"),{},"settings-support-inbox"),e[5]=m):m=e[5],i.push(m),r("gkx")("20911")&&a===3){var p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=u.jsxs(u.Fragment,{children:[u.jsx(r("FDSMenuSeparator.react"),{}),u.jsx(r("MWChatSidebarSettingsVerifyKeysInChatMenuItem.react"),{})]},"settings-verify-keys-in-chat"),e[6]=p):p=e[6],i.push(p)}e[1]=a,e[2]=i}else i=e[2];var _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Privacy & safety"),e[7]=_):_=e[7];var f;return e[8]!==i?(f=u.jsx(r("MWXMenuItemWithSubmenu.react"),{icon:r("MWXIconMenuItemHouseKeyhole"),onClick:d,primaryText:_,submenu:{items:i},testid:void 0}),e[8]=i,e[9]=f):f=e[9],f}function d(){return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","privacy_submenu")}l.default=c}),226);
__d("useMWDropEBDbMenuDialog",["fbt","EBDB","promiseDone","react-compiler-runtime","setTimeout","useMWXConfirmationDialog"],(function(t,n,r,o,a,i,l,s){"use strict";function e(){var e=o("react-compiler-runtime").c(3),t=r("useMWXConfirmationDialog")(),n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=async function(){await o("EBDB").clearAll()},e[0]=n):n=e[0];var a=n,i;return e[1]!==t?(i=function(){return t({body:s._(/*BTDS*/"Confirm deleting persisted state for encrypted backups?"),cancel:s._(/*BTDS*/"Cancel"),confirm:s._(/*BTDS*/"Delete"),title:s._(/*BTDS*/"Clear Messaging Data")},function(){r("promiseDone")(a().then(u))})},e[1]=t,e[2]=i):i=e[2],i}function u(){r("setTimeout")(c,500)}function c(){window.location.reload()}l.default=e}),226);
__d("MWDropEBDbMenu.react",["cr:5086","react","react-compiler-runtime","useMWDropEBDbMenuDialog"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(){var e=o("react-compiler-runtime").c(2),t=r("useMWDropEBDbMenuDialog")(),a;return e[0]!==t?(a=n("cr:5086")!=null?s.jsx(n("cr:5086"),{onClick:t,primaryText:"[Fb-only] Clear persisted EB DB"}):null,e[0]=t,e[1]=a):a=e[1],a}l.default=u}),98);
__d("MWEBAutoRestoreNoticeDialogStep.react",["fbt","CometRelay","MWChatEncryptedBackupsDismissalDialogContext","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSettingsDialog.entrypoint","MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXDialogHeader.react","MWXDialogPage.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","gkx","react","react-compiler-runtime","useCometRelayEntrypointContextualEnvironmentProvider","useEncryptedBackupsQplImpressionRef","useMergeRefs","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useContext,p=c.useRef,_=r("gkx")("23219");function f(){var e=o("react-compiler-runtime").c(2),t=m(r("MWChatEncryptedBackupsDismissalDialogContext")),n=t.isDismissedDisabled,a=t.setIsDismissedDisabled,i=p(n),l;return e[0]!==a?(l={onHidden:function(){a(i.current)},onVisible:function(){a(!0)}},e[0]=a,e[1]=l):l=e[1],r("useVisibilityObserver")(l)}function g(){}function h(e){var t=e.onComplete,n=e.pushPage,a=r("useEncryptedBackupsQplImpressionRef")(o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_IMPRESSION"),i=r("useCometRelayEntrypointContextualEnvironmentProvider")(),l=d(function(){var e=o("CometRelay").loadEntryPoint(i,r("MWChatEncryptedBackupsSettingsDialog.entrypoint"),{});n(function(){return u.jsx(o("CometRelay").EntryPointContainer,{entryPointReference:e,props:{onClose:t,pushPageFromParent:n}})},{withoutBackButton:!0})},[i,t,n]),c=r("gkx")("14456"),m=c?f:g,p=m(),h=r("useMergeRefs")(a,p);return u.jsx(r("MWXDialogPage.react"),{footer:null,header:u.jsx(r("MWXDialogHeader.react"),{onClose:t,title:s._(/*BTDS*/"Changes to secure storage settings"),withBackButton:!1,withCloseButton:!0}),children:u.jsx("div",{ref:h,children:u.jsxs(r("MWXColumn.react"),{paddingVertical:8,testid:void 0,children:[u.jsx(r("MWXColumnItem.react"),{paddingHorizontal:_?8:0,paddingTop:12,children:u.jsx(r("MWXText.react"),{align:"start",type:"body3",children:s._(/*BTDS*/"After you restore chat history, messages will continue to sync automatically even if you log out and log back in. You can turn this off in {[Armadillo] Inline settings link parameter.}.",[s._param("[Armadillo] Inline settings link parameter.",u.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink3",children:u.jsx(r("MWXLink.react"),{onClick:l,children:s._(/*BTDS*/"Settings")})}))])})}),u.jsx(r("MWXColumnItem.react"),{paddingTop:16,children:u.jsx(r("MWXRow.react"),{align:"end",paddingHorizontal:0,paddingTop:16,children:u.jsx(r("MWXRowItem.react"),{expanding:_,children:u.jsx(r("MWXButton.react"),{label:s._(/*BTDS*/"OK"),onPress:t,padding:"wide",testid:void 0})})})})]})})})}h.displayName=h.name+" [from "+i.id+"]",l.default=h}),226);
__d("MWEBOTCDialog.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{}}},root:r("JSResourceForInteraction")("MWEBOTCDialog.react").__setRef("MWEBOTCDialog.entrypoint")};l.default=e}),98);
__d("MWEBPropagateEbStateUtils",["CometRelay","EBLogger","promiseDone","react","react-compiler-runtime","requireDeferred","useMAWHasUserVisibleErrors","useMAWUnsupportedBrowserNUX"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=c.useCallback,m=c.useEffect,p=c.useRef,_=r("requireDeferred")("mwEBSetBackupState").__setRef("MWEBPropagateEbStateUtils"),f=r("requireDeferred")("mwProcessBackupIds").__setRef("MWEBPropagateEbStateUtils");function g(t,n){var r=p(null);return d(function(a){o("EBLogger").EBLogger().DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[useMWEBPropagateEbStateChangesThroughRelay] update: ",""])),a);var i=r.current;i!==null&&i!==a&&n&&(o("EBLogger").EBLogger().DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mwEB Backup state changed from "," to "," - triggering onStateChange"])),i,a),n()),r.current=a,o("CometRelay").commitLocalUpdate(t,function(e){var t=e.getRoot().getLinkedRecord("viewer");if(t==null){o("EBLogger").EBLogger().mustfix("[backup_state] A viewer record does not exist when propagating EB state.");return}t.setValue(a,"backup_state")})},[t,n])}function h(){var e=o("useMAWUnsupportedBrowserNUX").useMAWUnsupportedBrowserNUX(),t=e.shouldHideEBFlow,n=r("useMAWHasUserVisibleErrors")();return t||n}function y(e,t,n,a,i){var l=o("react-compiler-runtime").c(11),s;l[0]!==t||l[1]!==e||l[2]!==a||l[3]!==i?(s=function(){var n=async function(){var n=null;(e!=null||t!=null)&&(n=a?0:(await f.load())({clientStateData:t,encryptedBackupData:e})),n!=null&&(await _.load())({setBackupState:i,state:n})};r("promiseDone")(n())},l[0]=t,l[1]=e,l[2]=a,l[3]=i,l[4]=s):s=l[4];var u;l[5]!==t||l[6]!==e||l[7]!==n||l[8]!==a||l[9]!==i?(u=[t,e,n,a,i],l[5]=t,l[6]=e,l[7]=n,l[8]=a,l[9]=i,l[10]=u):u=l[10],m(s,u)}l.useBackupStateUpdate=g,l.useHasArmadilloError=h,l.useEbStatePropagationEffect=y}),98);
__d("MWEBQPWithPinState.enum",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({INITIAL:0,RESTORE_IN_PROGRESS:1}),l=e;i.default=l}),66);
__d("MWEBRestoreOTCFirstStep.react",["fbt","MWChatEncryptedBackupsQPLEvents","MWEBOTCInterstitialIllustration.react","MWXColumn.react","MWXColumnItem.react","MWXDialogFooter.react","MWXDialogPage.react","MWXText.react","QPLUserFlow","react","react-compiler-runtime","requireDeferredForDisplay","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=r("requireDeferredForDisplay")("MWEncryptedBackupsOtcRestoreSteps").__setRef("MWEBRestoreOTCFirstStep.react");function d(e){var t=o("react-compiler-runtime").c(16),n=e.onCloseDialog,a=e.onComplete,i=e.onSkip,l=e.pushPage,d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d={onVisible:m},t[0]=d):d=t[0];var p=r("useVisibilityObserver")(d),_;t[1]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Send code"),t[1]=_):_=t[1];var f;t[2]!==n||t[3]!==a||t[4]!==i||t[5]!==l?(f=u.jsx(r("MWXDialogFooter.react"),{callToActionGroupDirection:"backward",primaryCallToAction:{label:_,onPress:function(){c.onReadyImmediately(function(e){var t=e.pushByOneTimeCodePage;r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FIRST_RESTORE_SEND_CODE_CLICK"),t({onClose:n,onOtcComplete:a,onSkip:i,pushPage:l})})}}}),t[2]=n,t[3]=a,t[4]=i,t[5]=l,t[6]=f):f=t[6];var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(r("MWXColumnItem.react"),{align:"center",paddingTop:20,paddingVertical:4}),t[7]=g):g=t[7];var h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=u.jsx(r("MWXColumnItem.react"),{align:"center",paddingTop:0,paddingVertical:8,children:u.jsx(r("MWEBOTCInterstitialIllustration.react"),{})}),t[8]=h):h=t[8];var y;t[9]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(r("MWXColumnItem.react"),{align:"center",children:u.jsx(r("MWXText.react"),{align:"center",color:"primary",isSemanticHeading:!0,type:"headlineEmphasized2",children:s._(/*BTDS*/"Send a one-time code to restore your chat history")})}),t[9]=y):y=t[9];var C;t[10]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("MWXColumnItem.react"),{align:"center",children:u.jsx(r("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:s._(/*BTDS*/"Get a one-time code from the Messenger or Facebook mobile app to restore your chat history on this device.")})}),t[10]=C):C=t[10];var b;t[11]!==p?(b=u.jsxs(r("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:8,ref:p,spacing:16,children:[g,h,y,C]}),t[11]=p,t[12]=b):b=t[12];var v;return t[13]!==f||t[14]!==b?(v=u.jsx(r("MWXDialogPage.react"),{footer:f,header:null,children:b}),t[13]=f,t[14]=b,t[15]=v):v=t[15],v}function m(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FIRST_RESTORE_DIALOG_STEP_IMPRESSION")}l.default=d}),226);
__d("MWEBRestoreQPWithPin_viewer.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBRestoreQPWithPin_viewer",selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_viewer"},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"qp_with_pin_state",storageKey:null}]}],type:"Viewer",abstractKey:null};a.exports=e}),null);
__d("useMWEBAutoRestoreNoticeDialog",["JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","ReQL","ReQLSuspense","react","react-compiler-runtime","useLabyrinthLogging","useMWEBSetHasSeenNotice","useMWXLazyDialog","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useCallback,c=r("JSResourceForInteraction")("MWEBAutoRestoreNoticeDialog.react").__setRef("useMWEBAutoRestoreNoticeDialog");function d(){var t=o("react-compiler-runtime").c(9),n=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),a=n.startFlow,l=r("useMWXLazyDialog")(c),s=l[0],u=(e||(e=r("useReStore")))(),d;t[0]!==u.tables.auto_restore_opt_out?(d=function(){return o("ReQL").fromTableAscending(u.tables.auto_restore_opt_out)},t[0]=u.tables.auto_restore_opt_out,t[1]=d):d=t[1];var p;t[2]!==u?(p=[u],t[2]=u,t[3]=p):p=t[3];var _=o("ReQLSuspense").useArray(d,p,i.id+":45"),f=r("useMWEBSetHasSeenNotice")(),g;return t[4]!==_||t[5]!==f||t[6]!==s||t[7]!==a?(g=function(t){var e=t.hasSeenNotice,n=t.source,i=_.filter(m).length>0;if(a({event:o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,source:n}),i){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_OUT"),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent});return}if(r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_IN"),o("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT),e){o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent});return}f(),s({})},t[4]=_,t[5]=f,t[6]=s,t[7]=a,t[8]=g):g=t[8],g}function m(e){return e.optOutKey===r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_OPTED_OUT_OF_AUTO_RESTORE}l.default=d}),98);
__d("MWEBRestoreQPWithPin.react",["fbt","CometPlaceholder.react","CometRelay","CometVisualCompletionAttributes","EncryptedBackupsSupportedPlatformUtils","FBLogger","FocusRegion.react","JSResourceForInteraction","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react","MWEBFlowSourceContextProvider.react","MWEBOTCDialog.entrypoint","MWEBQPWithPinState.enum","MWEBRestoreQPWithPin_viewer.graphql","MWEncryptedBackupsForgotPinStep","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWLogInboxFiltersInteraction","MWLogInteraction","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconCross","MWXImage.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","QPLUserFlow","focusScopeQueries","getMWEBRestoreQPCautionCircleProperties","gkx","promiseDone","react","react-compiler-runtime","useAsyncReStore","useLabyrinthLogging","useMWChatEncryptedBackupsPinCodeRestore","useMWChatEncryptedBackupsVestaUserInfo","useMWEBAutoRestoreNoticeDialog","useMWEBFlowSourceContext","useMWXEntryPointDialog","useMWXLazyDialog","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=u,m=d.useCallback,p=d.useContext,_=d.useEffect,f=d.useMemo,g=d.useRef,h=d.useState,y=r("JSResourceForInteraction")("MWChatEncryptedBackupsPinCodeBlockedDialog.react").__setRef("MWEBRestoreQPWithPin.react"),C="chat-encrypted-backups-jewel-qp-with-pin-input",b={icon:{paddingTop:"x889kno",$$css:!0}};function v(t){var a,i,l=o("react-compiler-runtime").c(82),u=t.clientID,d=t.doesUserHaveOtcEligibleDevices,m=t.fragmentKey,f=t.isInbox,v=t.setClosed,k=t.setDismissed,I=o("CometRelay").useFragment(e!==void 0?e:e=n("MWEBRestoreQPWithPin_viewer.graphql"),m),T=o("CometRelay").useRelayEnvironment(),D;l[0]!==T?(D=function(t){return o("CometRelay").commitLocalUpdate(T,function(e){var n=e.getRoot().getLinkedRecord("viewer");if(n==null){r("FBLogger")("wmi_eb").mustfix("[labyrinth][jewel_softblock_state] A viewer record does not exist when propagating EB restore qp with pin state");return}n.setValue(t,"qp_with_pin_state")})},l[0]=T,l[1]=D):D=l[1];var x=D,$;l[2]!==I?($={viewer$key:I},l[2]=I,l[3]=$):$=l[3];var P=r("useMWChatEncryptedBackupsVestaUserInfo")($),N=P.attemptsRemaining===0||P.loginTimeoutRemainingSecs!=null,M=h(!1),w=M[0],A=M[1],F=g(!1),O=r("useMWXLazyDialog")(y),B=O[0],W,q;l[4]!==N||l[5]!==B||l[6]!==w||l[7]!==P.attemptsRemaining||l[8]!==P.loginTimeoutRemainingSecs||l[9]!==P.refetchVestaClientInfo?(W=function(){N&&w===!0&&F.current!==!0&&(F.current=!0,B({attemptsRemaining:P.attemptsRemaining,loginTimeoutRemainingSecs:P.loginTimeoutRemainingSecs,onDismiss:E,refetchVestaClientInfo:P.refetchVestaClientInfo}))},q=[N,B,w,P.attemptsRemaining,P.loginTimeoutRemainingSecs,P.refetchVestaClientInfo],l[4]=N,l[5]=B,l[6]=w,l[7]=P.attemptsRemaining,l[8]=P.loginTimeoutRemainingSecs,l[9]=P.refetchVestaClientInfo,l[10]=W,l[11]=q):(W=l[10],q=l[11]),_(W,q);var U=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),V=U.startFlow,H=r("useAsyncReStore")(),G=r("useMWEBFlowSourceContext")(),z;l[12]!==G?(z=G(),l[12]=G,l[13]=z):z=l[13];var j=z,K;l[14]!==H||l[15]!==d||l[16]!==N||l[17]!==j||l[18]!==V?(K=function(t){r("promiseDone")(H.then(function(e){o("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:e,onFetch:function(n){var e=n.ebsmWiped,a=n.firstUpsellTime,i=n.hasEbKeysLocally,l=n.hasEBSM,s=n.hasPDB,u=n.hasUserRestoredBefore,c=n.hasUserRestoredBeforeTemp;V({additionalAnnotations:{eb_session_identifier:a,ebsm_wiped:e,has_eb_keys_locally:i,has_ebsm:l,has_pdb:s,has_user_restored_before:u,has_user_restored_before_temp:c,is_otc_eligible:d.toString(),is_pin_locked_blocked:N.toString(),is_pin_set:"true",restore_upsell_first_impression_time:a},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:j}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,t)}})}))},l[14]=H,l[15]=d,l[16]=N,l[17]=j,l[18]=V,l[19]=K):K=l[19];var Q=K,X;l[20]!==f||l[21]!==v||l[22]!==k||l[23]!==Q?(X=function(){var e=f?"RESTORE_QP_WITH_PIN_INBOX_DISMISSED":"RESTORE_QP_WITH_PIN_JEWEL_DISMISSED";Q(e),o("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"thread_list_qp_with_pin",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),v(),k()},l[20]=f,l[21]=v,l[22]=k,l[23]=Q,l[24]=X):X=l[24];var Y=X,J=p(r("MWJewelPopoverDialogContext.react")),Z=J.setIsOpenForDialog,ee=r("useMWEBAutoRestoreNoticeDialog")(),te;if(l[25]!==ee||l[26]!==(I==null||(a=I.encrypted_backup)==null?void 0:a.has_seen_eb_auto_restore_notice)||l[27]!==j||l[28]!==v||l[29]!==Z||l[30]!==x){var ne;te=function(){var e,t;v(),ee({hasSeenNotice:(e=I==null||(t=I.encrypted_backup)==null?void 0:t.has_seen_eb_auto_restore_notice)!=null?e:!1,source:j}),Z(!0),x(r("MWEBQPWithPinState.enum").INITIAL)},l[25]=ee,l[26]=I==null||(ne=I.encrypted_backup)==null?void 0:ne.has_seen_eb_auto_restore_notice,l[27]=j,l[28]=v,l[29]=Z,l[30]=x,l[31]=te}else te=l[31];I==null||(i=I.encrypted_backup)==null||i.has_seen_eb_auto_restore_notice;var re=te,oe,ae;l[32]!==x?(ae=function(){A(!0),o("MWLogInteraction").logPopoverOpenCancel("initiate_restore"),o("MWLogInboxFiltersInteraction").logInboxFiltersNavigationCancel("initiate_restore"),x(r("MWEBQPWithPinState.enum").RESTORE_IN_PROGRESS)},oe=function(){x(r("MWEBQPWithPinState.enum").INITIAL)},l[32]=x,l[33]=oe,l[34]=ae):(oe=l[33],ae=l[34]);var ie;l[35]!==u||l[36]!==re||l[37]!==oe||l[38]!==ae?(ie={clientID:u,focusRegionId:C,onSubmitPin:ae,onSubmitPinFailure:oe,onVestaComplete:re},l[35]=u,l[36]=re,l[37]=oe,l[38]=ae,l[39]=ie):ie=l[39];var le=o("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore(ie),se=le.inputProps,ue=le.invalidKeyPressedError,ce=le.isInProgress,de=le.isLabyrinthError,me=le.isPinCodeIncorrect,pe=le.isVestaError,_e=r("gkx")("23219"),fe=(I==null?void 0:I.qp_with_pin_state)==="RESTORE_IN_PROGRESS"||ce,ge=_e||!r("gkx")("19484"),he;l[40]!==f||l[41]!==Q?(he={onVisible:function(){ge&&o("FocusRegion.react").focusRegionById(C,o("focusScopeQueries").tabbableScopeQuery);var e=f?"RESTORE_QP_WITH_PIN_INBOX_IMPRESSION":"RESTORE_QP_WITH_PIN_JEWEL_IMPRESSION";Q(e)}},l[40]=f,l[41]=Q,l[42]=he):he=l[42];var ye=r("useVisibilityObserver")(he),Ce;l[43]===Symbol.for("react.memo_cache_sentinel")?(Ce={},l[43]=Ce):Ce=l[43];var be=r("useMWXEntryPointDialog")(r("MWEBOTCDialog.entrypoint"),Ce),ve=be[0],Se;l[44]!==f||l[45]!==ve?(Se=function(){ve({source:f?r("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP:r("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP},L)},l[44]=f,l[45]=ve,l[46]=Se):Se=l[46];var Re=Se,Le;l[47]!==ue||l[48]!==de||l[49]!==me||l[50]!==pe?(Le=ue!=null?ue:me?s._(/*BTDS*/"Incorrect PIN. Try again."):de||pe?s._(/*BTDS*/"There was an error while using the PIN Code, please try again"):void 0,l[47]=ue,l[48]=de,l[49]=me,l[50]=pe,l[51]=Le):Le=l[51];var Ee=Le;if(N===!0)return v(),null;var ke;l[52]===Symbol.for("react.memo_cache_sentinel")?(ke={0:{className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk xe4pinz x14vqqas x1ys307a xod5an3 xyqm7xq xz9dl7a xpdmqnj xsag5q8 x1g0dm76"},1:{className:"x1obq294 x5a5i1n xde0f50 x15x8krk xe4pinz x14vqqas x1ys307a xod5an3 xyqm7xq xz9dl7a xpdmqnj xsag5q8 x1g0dm76 x1jx94hy"}}[!!_e<<0],l[52]=ke):ke=l[52];var Ie;l[53]===Symbol.for("react.memo_cache_sentinel")?(Ie=c.jsx(r("MWXRowItem.react"),{xstyle:b.icon,children:c.jsx(r("MWXImage.react"),{src:r("getMWEBRestoreQPCautionCircleProperties")()})}),l[53]=Ie):Ie=l[53];var Te;l[54]===Symbol.for("react.memo_cache_sentinel")?(Te=c.jsx(r("MWXColumnItem.react"),{children:c.jsx(r("MWXText.react"),{align:"start",isSemanticHeading:!0,numberOfLines:2,type:"headlineEmphasized4",children:s._(/*BTDS*/"Chat history is missing")})}),l[54]=Te):Te=l[54];var De;l[55]===Symbol.for("react.memo_cache_sentinel")?(De=c.jsx(r("MWXRowItem.react"),{expanding:!0,children:c.jsxs(r("MWXColumn.react"),{paddingTop:8,spacing:12,children:[Te,c.jsx(r("MWXColumnItem.react"),{children:c.jsx(r("MWXText.react"),{align:"start",color:_e?"secondary":"primary",numberOfLines:2,type:"body4",children:s._(/*BTDS*/"Enter your PIN to restore chat history.")})})]})}),l[55]=De):De=l[55];var xe;l[56]===Symbol.for("react.memo_cache_sentinel")?(xe=s._(/*BTDS*/"Close chat history restore notification"),l[56]=xe):xe=l[56];var $e;l[57]!==Y?($e=c.jsx(r("MWXColumnItem.react"),{children:c.jsxs(r("MWXRow.react"),{paddingHorizontal:0,paddingVertical:0,spacing:12,children:[Ie,De,c.jsx(r("MWXRowItem.react"),{children:c.jsx(r("MWXCircleButton.react"),{"aria-label":xe,color:"primary",icon:r("MWXIconCross"),onPress:Y,size:_e?24:32,testid:void 0})})]})}),l[57]=Y,l[58]=$e):$e=l[58];var Pe;l[59]!==se||l[60]!==fe?(Pe=c.jsx(r("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers.extends({},se,{color:_e?"primary":"secondary",disabled:fe,inputSize:"small",testid:void 0,withAutoFocus:ge})),l[59]=se,l[60]=fe,l[61]=Pe):Pe=l[61];var Ne;l[62]!==Ee||l[63]!==Pe?(Ne=c.jsx(r("MWXColumnItem.react"),{paddingTop:16,children:c.jsx(r("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:Ee,inputSize:"small",children:Pe})}),l[62]=Ee,l[63]=Pe,l[64]=Ne):Ne=l[64];var Me;l[65]!==fe?(Me=fe&&c.jsx(r("MWXColumnItem.react"),{align:"center",children:c.jsx("div",{className:"xfitlp5 x9otpla",children:c.jsx(r("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:_e})})}),l[65]=fe,l[66]=Me):Me=l[66];var we;l[67]!==d||l[68]!==Ee||l[69]!==fe||l[70]!==Re||l[71]!==Z?(we=!fe&&c.jsx(r("MWXColumnItem.react"),{align:"center",children:c.jsx("div",babelHelpers.extends({},{0:{},2:{className:"xod5an3"},1:{className:"x12nagc x1iorvi4"},3:{className:"x12nagc x1iorvi4"}}[(Ee==null)<<1|(Ee!=null)<<0],{children:c.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:d===!0?c.jsx(r("MWXLink.react"),{onClick:function(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),Z(!0),Re()},children:s._(/*BTDS*/"Use a one-time code instead")}):c.jsx("div",babelHelpers.extends({},r("CometVisualCompletionAttributes").IGNORE,{children:c.jsx(r("CometPlaceholder.react"),{fallback:c.jsx(r("MWXLink.react"),babelHelpers.extends({testid:void 0},o("MWEncryptedBackupsForgotPinStep").STATIC_HELP_CENTER_LINK_PROPS,{onClick:R})),name:"mw-chat-encrypted-backups-jewel-forgot-pin-fallback-link",children:c.jsx(r("MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react"),{children:S})})}))})}))}),l[67]=d,l[68]=Ee,l[69]=fe,l[70]=Re,l[71]=Z,l[72]=we):we=l[72];var Ae;l[73]!==ye||l[74]!==$e||l[75]!==Ne||l[76]!==Me||l[77]!==we?(Ae=c.jsxs(r("MWXColumn.react"),{ref:ye,testid:void 0,children:[$e,Ne,Me,we]}),l[73]=ye,l[74]=$e,l[75]=Ne,l[76]=Me,l[77]=we,l[78]=Ae):Ae=l[78];var Fe;return l[79]!==ke||l[80]!==Ae?(Fe=c.jsx("div",babelHelpers.extends({},ke,{children:Ae})),l[79]=ke,l[80]=Ae,l[81]=Fe):Fe=l[81],Fe}function S(e){var t=e.linkProps;return c.jsx(r("MWXLink.react"),babelHelpers.extends({testid:void 0},t,{onClick:function(n){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_FORGOT_PIN_CLICK"),t.onClick==null||t.onClick(n)}}))}S.displayName=S.name+" [from "+i.id+"]";function R(e){r("FBLogger")("wmi_eb").tags(["jewel_restore_qp"]).warn("User clicked on the placeholder Forgot PIN button"),o("MWEncryptedBackupsForgotPinStep").STATIC_HELP_CENTER_LINK_PROPS.onClick==null||o("MWEncryptedBackupsForgotPinStep").STATIC_HELP_CENTER_LINK_PROPS.onClick(e)}function L(){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_CLOSE_DIALOG_CLICK")}function E(){}function k(e){var t=o("react-compiler-runtime").c(10),n=e.clientID,a=e.currentSupportedPlatform,i=e.doesUserHaveOtcEligibleDevices,l=e.fragmentKey,s=e.setClosed,u=e.setDismissed,d=a!==o("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,m=d?r("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP_WITH_PIN:r("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP_WITH_PIN,p;t[0]!==n||t[1]!==i||t[2]!==l||t[3]!==d||t[4]!==s||t[5]!==u?(p=c.jsx(v,{clientID:n,doesUserHaveOtcEligibleDevices:i,fragmentKey:l,isInbox:d,setClosed:s,setDismissed:u}),t[0]=n,t[1]=i,t[2]=l,t[3]=d,t[4]=s,t[5]=u,t[6]=p):p=t[6];var _;return t[7]!==m||t[8]!==p?(_=c.jsx(r("MWEBFlowSourceContextProvider.react"),{source:m,children:p}),t[7]=m,t[8]=p,t[9]=_):_=t[9],_}l.default=k}),226);
__d("MWEncryptedBackupsDeviceUtils",[],(function(t,n,r,o,a,i){"use strict";var e=[6628568379,0x9e1d0efc8522,350685531728],l=[0x9e1d0efc8522];i.FB_APP_IDS=e,i.TABLET_APP_IDS=l}),66);
__d("MWEncryptedBackupsDeviceListCell.react",["fbt","AddOnStartOverride.react","BaseMiddot.react","FDSRelativeTimestamp.react","I64","MWEncryptedBackupsDeviceUtils","MWXIconForListCell.react","MWXIconMobile","MWXIconTablet","MWXListCell.react","MWXTextPairing.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e.useMemo;function m(e){var t=o("react-compiler-runtime").c(17),n=e.device,a;t[0]!==n.appId?(a=n.appId!=null?(u||(u=o("I64"))).to_float(n.appId):null,t[0]=n.appId,t[1]=a):a=t[1];var i=a,l=o("MWEncryptedBackupsDeviceUtils").TABLET_APP_IDS.includes(i),d;t[2]!==i?(d=o("MWEncryptedBackupsDeviceUtils").FB_APP_IDS.includes(i)?s._(/*BTDS*/"Facebook"):s._(/*BTDS*/"Messenger"),t[2]=i,t[3]=d):d=t[3];var m=d,p=r(l?"MWXIconTablet":"MWXIconMobile"),_;t[4]!==p?(_=c.jsx(r("AddOnStartOverride.react"),{children:c.jsx(r("MWXIconForListCell.react"),{icon:p,size:"large"})}),t[4]=p,t[5]=_):_=t[5];var f;t[6]!==n.lastUploadTime?(f=n.lastUploadTime!=null&&s._(/*BTDS*/"Last seen {last_seen}",[s._param("last_seen",c.jsx(r("FDSRelativeTimestamp.react"),{date:new Date(Number(n.lastUploadTime)*1e3)}))]),t[6]=n.lastUploadTime,t[7]=f):f=t[7];var g;t[8]!==m||t[9]!==n.model?(g=n.model!=null?c.jsxs(c.Fragment,{children:[m,c.jsx(r("BaseMiddot.react"),{}),n.model]}):m,t[8]=m,t[9]=n.model,t[10]=g):g=t[10];var h;t[11]!==f||t[12]!==g?(h=c.jsx(r("MWXTextPairing.react"),{body:f,bodyColor:"secondary",headline:g,level:4}),t[11]=f,t[12]=g,t[13]=h):h=t[13];var y;return t[14]!==_||t[15]!==h?(y=c.jsx(r("MWXListCell.react"),{addOnStart:_,content:h}),t[14]=_,t[15]=h,t[16]=y):y=t[16],y}l.default=m}),226);
__d("MWEncryptedBackupsFetchBackupMetadata",["LSFactory","LSFetchBackupsMetadataStoredProcedure"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e.runInTransaction(function(e){return r("LSFetchBackupsMetadataStoredProcedure")(r("LSFactory")(e))},"readwrite",void 0,void 0,i.id+":17")}l.fetchBackupMetadata=e}),98);
__d("useFetchOTCEligibleEBDevices",["FBLogger","LSAuthorityLevel","LSFactory","LSFetchOTCEligibleEBDevicesV2StoredProcedure","LSIntEnum","ReQL","ReQLSuspense","gkx","promiseDone","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=c.useCallback,m=c.useEffect,p=c.useMemo,_=c.useRef,f=r("gkx")("24064");function g(t){var n=o("react-compiler-runtime").c(27),a=t===void 0?"store-or-network":t,l=(e||(e=r("useReStore")))(),u=_(!1),c;n[0]!==l.tables.encrypted_backups_otc_devices?(c=function(){return o("ReQL").fromTableAscending(l.tables.encrypted_backups_otc_devices)},n[0]=l.tables.encrypted_backups_otc_devices,n[1]=c):c=n[1];var d;n[2]!==l?(d=[l],n[2]=l,n[3]=d):d=n[3];var p=o("ReQLSuspense").useArray(c,d,i.id+":45"),g;n[4]!==l?(g=function(){return l.runInTransaction(C,"readwrite",void 0,void 0,i.id+":51")},n[4]=l,n[5]=g):g=n[5];var b=g,v;n[6]!==b?(v=function(){r("promiseDone")(b(),null,y)},n[6]=b,n[7]=v):v=n[7];var S=v,R,L;n[8]!==a||n[9]!==p.length||n[10]!==S?(R=function(){u.current!==!0&&(p.length===0||a==="network-only")&&(u.current=!0,S())},L=[a,p.length,S],n[8]=a,n[9]=p.length,n[10]=S,n[11]=R,n[12]=L):(R=n[11],L=n[12]),m(R,L);var E;n[13]!==p[0]||n[14]!==p.length?(E=p.length>0&&(s||(s=o("LSIntEnum"))).toNumber(p[0].authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC,n[13]=p[0],n[14]=p.length,n[15]=E):E=n[15];var k=E,I=!k&&p.length>0&&p[0].deviceId==="-1",T,D;n[16]!==I?(T=function(){I&&r("FBLogger")("wmi_eb").mustfix("Encrypted Backups OTC: Failed to fetch otc eligible devices.")},D=[I],n[16]=I,n[17]=T,n[18]=D):(T=n[17],D=n[18]),m(T,D);var x;n[19]!==p?(x=p.filter(h),n[19]=p,n[20]=x):x=n[20];var $=x,P=$.length>0||f,N;return n[21]!==I||n[22]!==k||n[23]!==$||n[24]!==P||n[25]!==S?(N={doesUserHaveOtcEligibleDevices:P,failedToFetchOtcDevices:I,isFetchOtcDevicesInFlight:k,otcEligibleDevices:$,triggerFetchOtcEligibleDevices:S},n[21]=I,n[22]=k,n[23]=$,n[24]=P,n[25]=S,n[26]=N):N=n[26],N}function h(e){return(s||(s=o("LSIntEnum"))).toNumber(e.authorityLevel)!==r("LSAuthorityLevel").OPTIMISTIC&&e.deviceId!==""}function y(){r("FBLogger")("wmi_eb").mustfix("Failed to fetch OTC eligible devices")}async function C(e){var t=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.encrypted_backups_otc_devices)),n=t!=null&&(s||(s=o("LSIntEnum"))).toNumber(t.authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC;if(!n)return r("LSFetchOTCEligibleEBDevicesV2StoredProcedure")(r("LSFactory")(e))}l.default=g}),98);
__d("MWEncryptedBackupsOTCEligibleDevicesList.react",["fbt","AddOnStartOverride.react","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsDeviceListCell.react","MWXGlimmer.react","MWXIconExclamationMarkCircleOutline","MWXIconForListCell.react","MWXLink.react","MWXList.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useFetchOTCEligibleEBDevices"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useEffect,m=c.useRef,p={glimmerBody:{borderStartStartRadius:"x10c0hgg",borderStartEndRadius:"x17hxvv9",borderEndEndRadius:"xys2atg",borderEndStartRadius:"x18dcsfh",height:"xlzyvqe",width:"x3hqpx7",$$css:!0},glimmerHeadline:{borderStartStartRadius:"x10c0hgg",borderStartEndRadius:"x17hxvv9",borderEndEndRadius:"xys2atg",borderEndStartRadius:"x18dcsfh",height:"xlzyvqe",width:"xktia5q",$$css:!0},glimmerIcon:{borderStartStartRadius:"xvs2etk",borderStartEndRadius:"xg3wpu6",borderEndEndRadius:"x1jwbhkm",borderEndStartRadius:"xgg4q86",height:"xc9qbxq",width:"x14qfxbe",$$css:!0}};function _(){var e=o("react-compiler-runtime").c(2),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t=u.jsx(r("AddOnStartOverride.react"),{children:u.jsx(r("MWXGlimmer.react"),{index:0,xstyle:p.glimmerIcon})}),e[0]=t):t=e[0];var n;return e[1]===Symbol.for("react.memo_cache_sentinel")?(n=u.jsx(r("MWXListCell.react"),{addOnStart:t,content:u.jsx(r("MWXTextPairing.react"),{body:u.jsx(r("MWXGlimmer.react"),{index:2,xstyle:p.glimmerBody}),headline:u.jsx(r("MWXGlimmer.react"),{index:1,xstyle:p.glimmerHeadline}),level:4})}),e[1]=n):n=e[1],n}function f(){var e=o("react-compiler-runtime").c(16),t=r("useFetchOTCEligibleEBDevices")(),n=t.failedToFetchOtcDevices,a=t.isFetchOtcDevicesInFlight,i=t.otcEligibleDevices,l=t.triggerFetchOtcEligibleDevices,c=m(!1),p,f;if(e[0]!==n||e[1]!==a||e[2]!==i.length?(p=function(){a||(r("QPLUserFlow").addAnnotations(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{int:{otc_eligible_devices:i.length}}),n?c.current||(c.current=!0,r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_DEVICES_LIST_FAILURE")):!c.current&&i.length>0&&(c.current=!0,r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_DEVICES_LIST_LOADED")))},f=[n,a,i.length],e[0]=n,e[1]=a,e[2]=i.length,e[3]=p,e[4]=f):(p=e[3],f=e[4]),d(p,f),a){var y;return e[5]===Symbol.for("react.memo_cache_sentinel")?(y=u.jsx(_,{}),e[5]=y):y=e[5],y}else if(n){var C;e[6]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx(r("AddOnStartOverride.react"),{children:u.jsx(r("MWXIconForListCell.react"),{icon:r("MWXIconExclamationMarkCircleOutline"),size:"large"})}),e[6]=C):C=e[6];var b;if(e[7]!==l){var v;e[9]===Symbol.for("react.memo_cache_sentinel")?(v=s._(/*BTDS*/"Refresh"),e[9]=v):v=e[9];var S=u.jsx(r("MWXLink.react"),{onClick:l,children:v}),R;e[10]!==S?(R=u.jsx(r("MWXText.react"),{color:"blueLink",type:"headlineEmphasized4",children:S}),e[10]=S,e[11]=R):R=e[11],b=u.jsx(r("MWXListCell.react"),{addOnStart:C,content:u.jsx(r("MWXText.react"),{type:"headlineEmphasized4",children:s._(/*BTDS*/"Unable to show your devices. {try_again}",[s._param("try_again",R)])})}),e[7]=l,e[8]=b}else b=e[8];return b}else{var L;e[12]!==i?(L=i.toSorted(h).map(g),e[12]=i,e[13]=L):L=e[13];var E;return e[14]!==L?(E=u.jsx(r("MWXList.react"),{testid:void 0,children:L}),e[14]=L,e[15]=E):E=e[15],E}}function g(e){return u.jsx(r("MWEncryptedBackupsDeviceListCell.react"),{device:e},e.deviceId)}g.displayName=g.name+" [from "+i.id+"]";function h(e,t){return Number(t.lastUploadTime)-Number(e.lastUploadTime)}l.default=f}),226);
__d("MWEncryptedBackupsOTCEligibleDevicesPopover.react",["MWEncryptedBackupsOTCEligibleDevicesList.react","MWXPopover.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(1),n;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx(r("MWXPopover.react"),{withArrow:!0,children:s.jsx("div",{className:"x1xiyphd x1odjw0f x1y1aw1k xf159sx xwib8y2 xmzvs34 x168biu4",children:s.jsx(r("MWEncryptedBackupsOTCEligibleDevicesList.react"),{})})}),t[0]=n):n=t[0],n}l.default=u}),98);
__d("MWEncryptedBackupsProcessBackupDataUtils",["EBFetchBackupIdsShared","MWEncryptedBackupsListenForChangesToBackupStateInitPath","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.data,n=e.dbPromise,a=e.isInitalLoad,i=e.setListenForChangesToBackupState,l=o("EBFetchBackupIdsShared").transformBackupDataForLS(t);r("promiseDone")(n,function(e){return o("EBFetchBackupIdsShared").updateBackupsTableWithTransformedData({storage:e,transformedData:l}).then(function(){i(!0),t.xfb_backup!=null&&t.xfb_backup.id!=null&&a.current===!0&&(a.current=!1,r("MWEncryptedBackupsListenForChangesToBackupStateInitPath").preloadEBData(e))})})}l.processBackupData=e}),98);
__d("MWEncryptedBackupsProcessBackupIdsDEPRECATED",["FBLogger","LSFactory","LSIntEnum","LSProcessBackupIdsStoredProcedure","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","Promise","QPLEvent","QPLUserFlow","ReQL","WebSession","gkx","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=r("gkx")("23914");function d(t){if(c){var a=o("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();return r("QPLUserFlow").getActiveFlowIDs().includes((s||(s=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent))||r("QPLUserFlow").start(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:a,processBackupIdsVersion:"msys",sessionTabId:o("WebSession").getId()}}}),t.runInTransaction(function(e){return r("LSProcessBackupIdsStoredProcedure")(r("LSFactory")(e))},"readwrite",void 0,void 0,i.id+":53").then(function(e){var t=(u||(u=o("LSIntEnum"))).unwrapIntEnum(e[0]);return r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,"EB_STATE_"+t+"."),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent}),t})}else return(e||(e=n("Promise"))).resolve(0)}function m(e,t){return e.tables.encrypted_backups.subscribe(function(){r("promiseDone")(o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.tables.encrypted_backups)),function(n){if(n!=null){r("promiseDone")(d(e),t,function(e){r("FBLogger")("wmi_eb").catching(e).info("Error in db transaction")});return}})})}l.processBackupIdsStoredProcedure=d,l.subscribeToEncryptedBackupsRow=m}),98);
__d("MWEncryptedBackupsThreadListPersistentBanner.react",["fbt","EncryptedBackupsSupportedPlatformUtils","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWXLink.react","MWXText.react","QPLUserFlow","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWXEntryPointDialog","useReStore","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=u,m=d.useContext,p=d.useRef,_=r("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEncryptedBackupsThreadListPersistentBanner.react");function f(t){var n=o("react-compiler-runtime").c(23),a=t.onDismissUpsell,i;n[0]===Symbol.for("react.memo_cache_sentinel")?(i={},n[0]=i):i=n[0];var l=r("useMWXEntryPointDialog")(r("MAWEncryptedBackupsRestoreDialog.entrypoint"),i),u=l[0],d=o("EncryptedBackupsSupportedPlatformUtils").useMWEncryptedBackupsGetCurrentSupportedPlatform(),f=d!==o("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,g=m(r("MWJewelPopoverDialogContext.react")),h=g.setIsOpenForDialog,y=(e||(e=r("useReStore")))(),C=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),b=C.startFlow,v=p(!1),S=f?r("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_PERSISTENT_BANNER:r("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_PERSISTENT_BANNER,R;n[1]!==y||n[2]!==S||n[3]!==b?(R=function(t){o("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:y,onFetch:function(n){var e=n.ebsmWiped,a=n.firstUpsellTime,i=n.hasEbKeysLocally,l=n.hasEBSM,s=n.hasPDB,u=n.hasUserRestoredBefore,c=n.hasUserRestoredBeforeTemp;b({additionalAnnotations:{eb_session_identifier:a,ebsm_wiped:e,has_eb_keys_locally:i,has_ebsm:l,has_pdb:s,has_user_restored_before:u,has_user_restored_before_temp:c,restore_upsell_first_impression_time:a},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:S}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,t),v.current===!1&&(v.current=!0,r("promiseDone")(_.load(),function(e){return e(i)}))}})},n[1]=y,n[2]=S,n[3]=b,n[4]=R):R=n[4];var L=R,E;n[5]!==f||n[6]!==L?(E={onVisible:function(){L(f?"RESTORE_THREAD_LIST_PERSISTENT_BANNER_IMPRESSION_INBOX":"RESTORE_THREAD_LIST_PERSISTENT_BANNER_IMPRESSION")}},n[5]=f,n[6]=L,n[7]=E):E=n[7];var k=r("useVisibilityObserver")(E),I;n[8]===Symbol.for("react.memo_cache_sentinel")?(I={className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk x1xmf6yo x1e56ztr xyqm7xq x1ys307a x6ikm8r x10wlt62 xyamay9 x1l90r2v xf7dkkf xv54qhq"},n[8]=I):I=n[8];var T;n[9]===Symbol.for("react.memo_cache_sentinel")?(T=s._(/*BTDS*/"Missing chat history."),n[9]=T):T=n[9];var D;n[10]!==f||n[11]!==a||n[12]!==h||n[13]!==u||n[14]!==S||n[15]!==L?(D=function(){h(!0),L(f?"RESTORE_THREAD_LIST_PERSISTENT_BANNER_CTA_CLICKED_INBOX":"RESTORE_THREAD_LIST_PERSISTENT_BANNER_CTA_CLICKED"),u({onDismissUpsell:a,source:S})},n[10]=f,n[11]=a,n[12]=h,n[13]=u,n[14]=S,n[15]=L,n[16]=D):D=n[16];var x;n[17]===Symbol.for("react.memo_cache_sentinel")?(x=s._(/*BTDS*/"Restore now"),n[17]=x):x=n[17];var $;n[18]!==D?($=c.jsx(r("MWXText.react"),{color:"primary",type:"body4",children:c.jsxs(c.Fragment,{children:[T," ",c.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:c.jsx(r("MWXLink.react"),{onClick:D,target:"_blank",testid:void 0,children:x})})]})}),n[18]=D,n[19]=$):$=n[19];var P;return n[20]!==k||n[21]!==$?(P=c.jsx("div",babelHelpers.extends({},I,{ref:k,children:$})),n[20]=k,n[21]=$,n[22]=P):P=n[22],P}l.default=f}),226);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEncryptedBackupsThreadListRestoreQPWrapper_query",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MWEncryptedBackupsThreadListRestoreQPWrapper_viewer"}],storageKey:null}],type:"Query",abstractKey:null};a.exports=e}),null);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEncryptedBackupsThreadListRestoreQPWrapper_viewer",selections:[{args:null,kind:"FragmentSpread",name:"MWEBRestoreQPWithPin_viewer"}],type:"Viewer",abstractKey:null};a.exports=e}),null);
__d("MWEncryptedBackupsVerifyDeviceNux.react",["fbt","EncryptedBackupsSupportedPlatformUtils","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWXQPCard.react","QPLUserFlow","getMWEBRestoreQPCautionCircleProperties","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWXEntryPointDialog","useReStore","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=u,m=d.useContext,p=d.useRef,_=r("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEncryptedBackupsVerifyDeviceNux.react");function f(t){var n=o("react-compiler-runtime").c(47),a=t.children,i=t.currentSupportedPlatform,l=t.setClosed,u=t.setDismissed,d=o("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState(),f;n[0]===Symbol.for("react.memo_cache_sentinel")?(f={},n[0]=f):f=n[0];var g=r("useMWXEntryPointDialog")(r("MAWEncryptedBackupsRestoreDialog.entrypoint"),f),h=g[0],y=(e||(e=r("useReStore")))(),C=i!==o("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,b=C?r("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP:r("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP,v=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),S=v.startFlow,R=p(!1),L=m(r("MWJewelPopoverDialogContext.react")),E=L.setIsOpenForDialog,k=o("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),I=k.virtualDeviceInfo,T=I.vestaClientID!=null,D=I.offlineDevicesCount>0,x=I.doesUserHaveOtcEligibleDevices,$=!T&&x,P;n[1]!==y||n[2]!==x||n[3]!==d||n[4]!==T||n[5]!==b||n[6]!==S?(P=function(t){o("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:y,onFetch:function(n){var e=n.ebsmWiped,a=n.firstUpsellTime,i=n.hasEbKeysLocally,l=n.hasEBSM,s=n.hasPDB,u=n.hasUserRestoredBefore,c=n.hasUserRestoredBeforeTemp;S({additionalAnnotations:{eb_session_identifier:a,ebsm_wiped:e,has_eb_keys_locally:i,has_ebsm:l,has_pdb:s,has_user_restored_before:u,has_user_restored_before_temp:c,is_otc_eligible:x.toString(),is_pin_locked_blocked:d.toString(),is_pin_set:T.toString(),restore_upsell_first_impression_time:a},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:b}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,t),R.current===!1&&(R.current=!0,r("promiseDone")(_.load(),function(e){return e(i)}))}})},n[1]=y,n[2]=x,n[3]=d,n[4]=T,n[5]=b,n[6]=S,n[7]=P):P=n[7];var N=P,M;n[8]!==C||n[9]!==N?(M={onVisible:function(){var e=C?"VERIFY_DEVICE_INBOX_QP_THREAD_LIST_IMPRESSION":"VERIFY_DEVICE_QP_THREAD_LIST_IMPRESSION";N(e)}},n[8]=C,n[9]=N,n[10]=M):M=n[10];var w=r("useVisibilityObserver")(M),A;n[11]!==C||n[12]!==l||n[13]!==E||n[14]!==N?(A=function(){var e=C?"USER_CLICKED_INBOX_THREAD_LIST_VERIFY_DEVICE":"USER_CLICKED_FB_THREAD_LIST_VERIFY_DEVICE";N(e),E(!0),l()},n[11]=C,n[12]=l,n[13]=E,n[14]=N,n[15]=A):A=n[15];var F=A,O,B;if(n[16]!==C||n[17]!==l||n[18]!==u||n[19]!==N?(O=function(){var e=C?"USER_CLOSED_INBOX_THREAD_LIST_VERIFY_DEVICE_NUX":"USER_CLOSED_FB_THREAD_LIST_VERIFY_DEVICE_NUX";N(e),o("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"thread_list_nux",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),B()},B=function(){u(),l()},n[16]=C,n[17]=l,n[18]=u,n[19]=N,n[20]=O,n[21]=B):(O=n[20],B=n[21]),!T&&!D&&!x)return a;var W;n[22]===Symbol.for("react.memo_cache_sentinel")?(W=s._(/*BTDS*/"Chat history is missing"),n[22]=W):W=n[22];var q=W,U;n[23]!==x||n[24]!==d||n[25]!==T||n[26]!==$?(U=d&&x?s._(/*BTDS*/"Restore now"):T?s._(/*BTDS*/"Enter PIN"):$?s._(/*BTDS*/"Restore now"):s._(/*BTDS*/"Enter 40-character code"),n[23]=x,n[24]=d,n[25]=T,n[26]=$,n[27]=U):U=n[27];var V;n[28]!==B||n[29]!==F||n[30]!==b||n[31]!==h?(V=function(){F(),h({onDismissUpsell:B,source:b})},n[28]=B,n[29]=F,n[30]=b,n[31]=h,n[32]=V):V=n[32];var H;n[33]!==U||n[34]!==V?(H={label:U,onPress:V,testid:"mw-encrypted-backups-in-thread-verify-device-nux-verify-now-button"},n[33]=U,n[34]=V,n[35]=H):H=n[35];var G;n[36]!==x||n[37]!==d||n[38]!==T||n[39]!==$?(G=d&&x?s._(/*BTDS*/"Send a one-time code to restore your chat history"):T?s._(/*BTDS*/"Enter your PIN to see messages that aren't loaded on this device."):$?s._(/*BTDS*/"Send a one-time code to restore your chat history"):s._(/*BTDS*/"Enter your 40-character code to see messages that aren't loaded on this device."),n[36]=x,n[37]=d,n[38]=T,n[39]=$,n[40]=G):G=n[40];var z;n[41]===Symbol.for("react.memo_cache_sentinel")?(z={props:{src:r("getMWEBRestoreQPCautionCircleProperties")()},type:"image"},n[41]=z):z=n[41];var j;return n[42]!==O||n[43]!==w||n[44]!==H||n[45]!==G?(j=c.jsx(r("MWXQPCard.react"),{addOnPrimary:H,body:G,headline:q,icon:z,onClose:O,ref:w}),n[42]=O,n[43]=w,n[44]=H,n[45]=G,n[46]=j):j=n[46],j}l.default=f}),226);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper.react",["CometRelay","EncryptedBackupsSupportedPlatformUtils","MWEBEntrypointsKillswitch.enum","MWEBRestoreQPWithPin.react","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsDeferLocalStorageUpsell","MWEncryptedBackupsThreadListPersistentBanner.react","MWEncryptedBackupsThreadListQPWrapper.react","MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql","MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql","MWEncryptedBackupsVerifyDeviceNux.react","react","react-compiler-runtime","useHasRestoreInterstitialSoftblockBeenDismissed","useMWEBBackupState","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react"));function m(t){var a=o("react-compiler-runtime").c(32),i=t.backupState,l=t.children,s=t.currentSupportedPlatform,c=t.fragmentKey,m=t.setHasDismissedQp,p=t.setHasDismissedQpWithPin,_=o("CometRelay").useFragment(e!==void 0?e:e=n("MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql"),c),f=(u||(u=r("useReStore")))(),g=o("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),h=g.virtualDeviceInfo,y=s===o("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,C=h.doesUserHaveOtcEligibleDevices,b=o("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState(),v;a[0]!==i||a[1]!==b?(v={backupState:i,isCooldownOrLockOutState:b},a[0]=i,a[1]=b,a[2]=v):v=a[2];var S=r("useHasRestoreInterstitialSoftblockBeenDismissed")(v);if(!C&&b&&S)return null;if(b&&S){var R;a[3]!==m?(R=function(){m(!0)},a[3]=m,a[4]=R):R=a[4];var L;a[5]!==f?(L=function(){return o("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:f,upsellType:o("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_JEWEL})},a[5]=f,a[6]=L):L=a[6];var E;return a[7]!==l||a[8]!==s||a[9]!==R||a[10]!==L?(E=d.jsx(r("MWEncryptedBackupsVerifyDeviceNux.react"),{children:l,currentSupportedPlatform:s,setClosed:R,setDismissed:L}),a[7]=l,a[8]=s,a[9]=R,a[10]=L,a[11]=E):E=a[11],E}else if(y&&h.vestaClientID!=null&&r("MWEBRestoreQPWithPin.react")){var k;a[12]!==p?(k=function(){p(!0)},a[12]=p,a[13]=k):k=a[13];var I;a[14]!==f?(I=function(){return o("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:f,upsellType:o("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_WITH_PIN_JEWEL})},a[14]=f,a[15]=I):I=a[15];var T;return a[16]!==s||a[17]!==_||a[18]!==k||a[19]!==I||a[20]!==h.doesUserHaveOtcEligibleDevices||a[21]!==h.vestaClientID?(T=d.jsx(r("MWEBRestoreQPWithPin.react"),{clientID:h.vestaClientID,currentSupportedPlatform:s,doesUserHaveOtcEligibleDevices:h.doesUserHaveOtcEligibleDevices,fragmentKey:_,setClosed:k,setDismissed:I}),a[16]=s,a[17]=_,a[18]=k,a[19]=I,a[20]=h.doesUserHaveOtcEligibleDevices,a[21]=h.vestaClientID,a[22]=T):T=a[22],T}else{var D;a[23]!==m?(D=function(){m(!0)},a[23]=m,a[24]=D):D=a[24];var x;a[25]!==f?(x=function(){return o("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:f,upsellType:o("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_JEWEL})},a[25]=f,a[26]=x):x=a[26];var $;return a[27]!==l||a[28]!==s||a[29]!==D||a[30]!==x?($=d.jsx(r("MWEncryptedBackupsVerifyDeviceNux.react"),{children:l,currentSupportedPlatform:s,setClosed:D,setDismissed:x}),a[27]=l,a[28]=s,a[29]=D,a[30]=x,a[31]=$):$=a[31],$}}function p(e){var t=o("react-compiler-runtime").c(12),a=e.children,i=e.currentSupportedPlatform,l=e.fragmentKey,c=e.hasDismissedQps,p=e.setHasDismissedBanner,_=e.setHasDismissedQp,f=e.setHasDismissedQpWithPin,g=e.trigger,h=o("CometRelay").useFragment(s!==void 0?s:s=n("MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql"),l),y=(u||(u=r("useReStore")))(),C;t[0]===Symbol.for("react.memo_cache_sentinel")?(C={entrypoint:r("MWEBEntrypointsKillswitch.enum").INBOX_THREADLIST},t[0]=C):C=t[0];var b=r("useMWEBBackupState")(C),v;return t[1]!==b||t[2]!==a||t[3]!==i||t[4]!==(h==null?void 0:h.viewer)||t[5]!==y||t[6]!==c||t[7]!==p||t[8]!==_||t[9]!==f||t[10]!==g?(v=c?d.jsx(o("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsThreadListQPWrapper,{trigger:g,children:d.jsx(r("MWEncryptedBackupsThreadListPersistentBanner.react"),{onDismissUpsell:function(){p(!0),o("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:y,upsellType:o("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.PERSISTENT_BANNER_JEWEL})}})}):d.jsx(o("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsThreadListQPWrapper,{trigger:g,children:d.jsx(m,{backupState:b,children:a,currentSupportedPlatform:i,fragmentKey:h==null?void 0:h.viewer,setHasDismissedQp:_,setHasDismissedQpWithPin:f})}),t[1]=b,t[2]=a,t[3]=i,t[4]=h==null?void 0:h.viewer,t[5]=y,t[6]=c,t[7]=p,t[8]=_,t[9]=f,t[10]=g,t[11]=v):v=t[11],v}l.default=p}),98);
__d("MWXIconMenuItemFriends",["MWXSvgIcon","SVGIcon","cr:22687","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22687")),r("gkx")("23219"));l.default=e}),98);
__d("MWFamilyCenterSuppervisionMenuItem.react",["fbt","MWXIconMenuItemFriends","MWXMenuItem.react","XMessengerFamilyCenterHomeControllerRouteBuilder","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(2),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var n;t=(n=r("XMessengerFamilyCenterHomeControllerRouteBuilder").buildUri({}).setSubDomain("familycenter"))==null?void 0:n.toString(),e[0]=t}else t=e[0];var a;return e[1]===Symbol.for("react.memo_cache_sentinel")?(a=u.jsx(r("MWXMenuItem.react"),{href:t,icon:r("MWXIconMenuItemFriends"),primaryText:s._(/*BTDS*/"Family Center"),target:"_blank",testid:void 0}),e[1]=a):a=e[1],a}l.default=c}),226);
__d("MWInboxAccessibilitySettingsDialogQuery$Parameters",["MWInboxAccessibilitySettingsDialogQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("MWInboxAccessibilitySettingsDialogQuery_facebookRelayOperation"),metadata:{},name:"MWInboxAccessibilitySettingsDialogQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("MWInboxAccessibilitySettingsDialog.entrypoint",["JSResourceForInteraction","MWInboxAccessibilitySettingsDialogQuery$Parameters"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{queryReference:{parameters:r("MWInboxAccessibilitySettingsDialogQuery$Parameters"),variables:{}}}}},root:r("JSResourceForInteraction")("MWInboxAccessibilitySettingsDialog.react").__setRef("MWInboxAccessibilitySettingsDialog.entrypoint")};l.default=e}),98);
__d("MWInboxInfoFRXOverflowMenu.react",["fbt","MWPBumpEntityKey","MWXIconMenuItemAppFacebook","MWXIconMenuItemShieldStar","MWXMenu.react","MWXMenuItem.react","emptyFunction","react","react-compiler-runtime","useMWInboxInfoFRX"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){var t=o("react-compiler-runtime").c(20),n=e.onClose,a=e.thread,i;t[0]!==a?(i={entryPoint:"groups_report_to_admin",messagingEntrypoint:"thread_details",onPress:r("emptyFunction"),thread:a},t[0]=a,t[1]=i):i=t[1];var l=r("useMWInboxInfoFRX")(i),c;t[2]!==a?(c={entryPoint:"report_button",messagingEntrypoint:"thread_details",onPress:r("emptyFunction"),thread:a},t[2]=a,t[3]=c):c=t[3];var d=r("useMWInboxInfoFRX")(c),m;t[4]===Symbol.for("react.memo_cache_sentinel")?(m=s._(/*BTDS*/"Menu for reporting issues to admins or Facebook"),t[4]=m):m=t[4];var p;t[5]!==n||t[6]!==l?(p=function(t){o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","privacy_support_section_something_wrong"),l(),n==null||n(t)},t[5]=n,t[6]=l,t[7]=p):p=t[7];var _;t[8]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Report to admins"),t[8]=_):_=t[8];var f;t[9]!==p?(f=u.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemShieldStar"),onClick:p,primaryText:_}),t[9]=p,t[10]=f):f=t[10];var g;t[11]!==n||t[12]!==d?(g=function(t){o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","privacy_support_section_something_wrong"),d(),n==null||n(t)},t[11]=n,t[12]=d,t[13]=g):g=t[13];var h;t[14]===Symbol.for("react.memo_cache_sentinel")?(h=s._(/*BTDS*/"Report to Facebook"),t[14]=h):h=t[14];var y;t[15]!==g?(y=u.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemAppFacebook"),onClick:g,primaryText:h}),t[15]=g,t[16]=y):y=t[16];var C;return t[17]!==f||t[18]!==y?(C=u.jsxs(r("MWXMenu.react"),{"aria-label":m,withArrow:!0,children:[f,y]}),t[17]=f,t[18]=y,t[19]=C):C=t[19],C}l.default=c}),226);
__d("MWInboxMediaGalleryEBRestoreSyncBanner.react",["fbt","MWXCard.react","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c={files:"files",links:"links",media:"media"};function d(e){var t=o("react-compiler-runtime").c(3),n=e.contentType,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=u.jsx(r("MWXRowItem.react"),{children:u.jsx(r("MWXSpinner.react"),{color:"blue",size:20})}),t[0]=a):a=t[0];var i;return t[1]!==n?(i=u.jsx(r("MWXCard.react"),{background:"card-flat",children:u.jsxs(r("MWXRow.react"),{align:"center",paddingHorizontal:12,paddingVertical:12,verticalAlign:"center",children:[a,u.jsx(r("MWXRowItem.react"),{children:u.jsx(r("MWXText.react"),{align:"center",color:"primary",type:"body4",children:s._(/*BTDS*/"_j{\"media\":\"Syncing media...\",\"files\":\"Syncing files...\",\"links\":\"Syncing links...\"}",[s._enum(c[n],{media:"media",files:"files",links:"links"})])})})]})}),t[1]=n,t[2]=i):i=t[2],i}l.default=d}),226);
__d("MWInboxMediaGalleryEBRestoreUpsell.react",["fbt","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreUpsellTrigger.react","MWXCard.react","MWXLink.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c={files:"files may be",links:"links may be",media:"media may be"};function d(e){var t=o("react-compiler-runtime").c(2),n=e.contentType,a;return t[0]!==n?(a=u.jsx(r("MWEBRestoreUpsellTrigger.react"),{markerPrefix:"MEDIA_GALLERY_RESTORE",qplSource:r("MWChatEncryptedBackupsQPLSource.enum").MEDIA_GALLERY_RESTORE,children:function(t,o){return u.jsx(r("MWXCard.react"),{background:"card-flat",children:u.jsx("div",{className:"xyamay9 x1l90r2v x1g0dm76 xpdmqnj",ref:o,children:u.jsxs(r("MWXText.react"),{align:"center",color:"primary",type:"body4",children:[s._(/*BTDS*/"_j{\"files may be\":\"Some files may be missing.\",\"links may be\":\"Some links may be missing.\",\"media may be\":\"Some media may be missing.\"}",[s._enum(c[n],{"files may be":"files may be","links may be":"links may be","media may be":"media may be"})])," ",u.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:u.jsx(r("MWXLink.react"),{onClick:t,children:s._(/*BTDS*/"Restore now")})})]})})})}}),t[0]=n,t[1]=a):a=t[1],a}l.default=d}),226);
__d("MessengerClientEventMinorSurface",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({MUSIC_PLAYER:"music_player",LYRICS_SELECTOR:"lyrics_selector",CHANNELS_FOLDER_SUGGESTED_BROADCAST_CHANNELS_SECTION:"channels_folder_suggested_broadcast_channels_section",CHANNELS_FOLDER_SUGGESTED_BROADCAST_CHANNELS_SEE_MORE_LIST:"channels_folder_suggested_broadcast_channels_see_more_list",COMMUNITIES_ALL_COMMUNITIES_LIST_VIEW:"communities_all_communities_list_view",COMMUNITIES_CHANNEL_LIST_VIEW:"communities_channel_list_view",COMMUNITIES_CHAT_PREVIEW:"communities_chat_preview",COMMUNITIES_COMMUNITY_PREVIEW:"communities_community_preview",COMMUNITIES_MAIN_VIEW_CONNECTED_COMMUNITIES_SECTION:"communities_main_view_connected_communities_section",COMMUNITIES_MAIN_VIEW_CONNECTED_CHANNELS_SECTION:"communities_main_view_connected_channels_section",COMMUNITIES_MAIN_VIEW_TO_REVIEW_SECTION:"communities_main_view_to_review_section",COMMUNITIES_MAIN_VIEW_UNCONNECTED_COMMUNITIES_SECTION:"communities_main_view_unconnected_communities_section",COMMUNITIES_TO_REVIEW_LIST_VIEW:"communities_to_review_list_view",CONTEXT_MENU:"context_menu",NOTE_CREATION_SETTINGS:"note_creation_settings",HIGHLIGHTS_FEED:"highlights_feed",ACTIVITY_LIST:"activity_list",HIGHLIGHTS_TAB_FOOTER:"highlights_tab_footer",HIGHLIGHTS_TAB_IMMERSIVE_VIEW:"highlights_tab_immersive_view",HIGHLIGHTS_TAB_NUX:"highlights_tab_nux",HIGHLIGHTS_TAB_TRAY:"highlights_tab_tray",HIGHLIGHTS_TRAY:"highlights_tray",HOLIDAY_CARD_EDITOR:"holiday_card_editor",IMMERSIVE_PROFILE_SELF_VIEW:"immersive_profile_self_view",JEWEL_FOCUS_VIEW:"jewel_focus_view",LEFT_DRAWER_DISCOVER_CHANNELS_LIST:"left_drawer_discover_channels_list",LEFT_NAV:"left_nav",MAIN_VIEW:"main_view",MEDIA_VIEW:"media_view",MSGR_TAB:"msgr_tab",PREVIEW_PROFILE_PICTURE:"preview_profile_picture",PYMK_VIEW:"pymk_view",PYMK_FULL_PAGE:"pymk_full_page",THREAD_VIEW:"thread_view",NEW_FRIENDS_FOLDER:"new_friends_folder",SEE_NEW_FRIENDS_PROMPT:"see_new_friends_prompt",INBOX_BANNER:"inbox_banner",INBOX_COMMUNITIES:"inbox_communities",INBOX_COMMUNITIES_LONG_PRESS_PAGE:"inbox_communities_long_press_page",INBOX_MESSAGES:"inbox_messages",INBOX_MESSAGES_BULK_ACTION_PAGE:"inbox_messages_bulk_action_page",INBOX_TRAY:"inbox_tray",INBOX_TRAY_ACTIVE_NOW_LONG_PRESS_PAGE:"inbox_tray_active_now_long_press_page",INBOX_TREP:"inbox_trep",INBOX_FILTER_ALL:"inbox_filter_all",INBOX_FILTER_UNREAD:"inbox_filter_unread",INBOX_FILTER_GROUPS:"inbox_filter_groups",INBOX_FILTER_OUTBOUND:"inbox_filter_outbound",INBOX_FILTER_MARKETPLACE_UNRESPONDED:"inbox_filter_marketplace_unresponded",INBOX_FILTER_MARKETPLACE_RESPONDED:"inbox_filter_marketplace_responded",INBOX_FILTER_MARKETPLACE_HIGHLY_RATED:"inbox_filter_marketplace_highly_rated",INBOX_FILTER_MARKETPLACE_VERY_RESPONSIVE:"inbox_filter_marketplace_very_responsive",LEFT_NAV_COMMUNITIES:"left_nav_communities",LEFT_NAV_STANDALONE_COMMUNITIES:"left_nav_standalone_communities",LEFT_NAV_FB_GROUPS:"left_nav_fb_groups",COMMUNITIES_GROUPS_EDIT_SHEET:"communities_groups_edit_sheet",FIND_CONTACTS_PAGE:"find_contacts_page",CONTACTS_ACCESS_PROMPT:"contacts_access_prompt",STORY_COMPOSER_RMC_CAROUSEL:"story_composer_rmc_carousel",STORY_COMPOSER_CREATION_MODE:"story_composer_creation_mode",STORY_CREATION_CAMERA_VIEW:"story_creation_camera_view",READY_MADE_CONTENT_MIMICRY:"ready_made_content_mimicry",STORY_RING:"story_ring",STORY_CARD:"story_card",COMBINED_VIEWER:"combined_viewer",PROFILE:"profile",THREAD_LIST:"thread_list",ACTIONS_VIEW_STORY:"actions_view_story",PYMK_VIEW_INFO:"pymk_view_info",PYMK_CONTAINER:"pymk_container",CONTACTS_AND_PYMM_CONTAINER:"contacts_and_pymm_container",FIND_FRIENDS:"find_friends",PYMM_CONTAINER:"pymm_container",PYMM_VIEW:"pymm_view",START_CHAT_FILTER_ALL:"start_chat_filter_all",START_CHAT_FILTER_FRIENDS:"start_chat_filter_friends",START_CHAT_FILTER_SUUGESTED:"start_chat_filter_suggested",PYMK_CONTAINER_FRIENDS_TAB:"pymk_container_friends_tab",PYMK_CONTAINER_HIGHLGHTS_TAB:"pymk_container_highlights_tab",PYMK_CONTAINER_INBOX:"pymk_container_inbox",PYMK_CONTAINER_INBOX_ALL_COUNT:"pymk_container_inbox_all_count",PYMK_CONTAINER_JEWEL:"pymk_container_messenger_jewel",PYMK_CONTAINER_LEFT_NAV:"pymk_container_left_nav",PYMK_CONTAINER_SEARCH:"pymk_container_search",PYMK_CONTAINER_STORY_VIEWER:"pymk_container_story_viewer",MSGR_AI_DIGEST_INDEX_CARD:"msgr_ai_digest_index_card",MSGR_AI_DIGEST_SUMMARY_CARD:"msgr_ai_digest_summary_card",FRIENDS_GROUP_MEMBERS_SECTION:"friends_group_members_section",GROUP_MEMBERS_RESPOND_SHEET:"group_members_respond_sheet",IMMERSIVE_PROFILE_VIEW_HEADER:"immersive_profile_view_header",IMMERSIVE_PROFILE_RESPOND_SHEET:"immersive_profile_respond_sheet",IMMERSIVE_PROFILE_UNFRIEND_RESPOND_SHEET:"immersive_profile_unfriend_respond_sheet",THREAD_VIEW_ADD_MEMBER_ADMIN_TEXT:"thread_view_add_member_admin_text",THREAD_VIEW_DETAILS_HEADER:"thread_view_details_header",THREAD_VIEW_DETAILS_UNFRIEND_RESPOND_SHEET:"thread_view_details_unfriend_respond_sheet",THREAD_VIEW_HEADER:"thread_view_header",THREAD_VIEW_TITLE:"thread_view_title",THREAD_VIEW_RESPOND_SHEET:"thread_view_respond_sheet",THREAD_VIEW_UNFRIEND_RESPOND_SHEET:"thread_view_unfriend_respond_sheet",UNCONNECTED_GROUP_MEMBERS_SECTION:"unconnected_group_members_section",URL_PREVIEW:"url_preview",THREAD_VIEW_DETAILS_RESPOND_SHEET:"thread_view_details_respond_sheet",THREAD_VIEW_XMA_LINK:"thread_view_xma_link",THREAD_VIEW_XMA_REPLY:"thread_view_xma_reply",THREAD_VIEW_XMA_SHARE:"thread_view_xma_share",THREAD_VIEW_SENDER_TILE:"thread_view_sender_tile",THREAD_VIEW_BANNER:"thread_view_banner",IMMERSIVE_PROFILE_VIEW_ABOUT_SECTION:"immersive_profile_view_about_section",IMMERSIVE_PROFILE_VIEW_CHAT_ACTIONS_SECTION:"immersive_profile_view_chat_actions_section",IMMERSIVE_PROFILE_VIEW_COMMON_CHATS_SECTION:"immersive_profile_view_common_chats_section",IMMERSIVE_PROFILE_VIEW_MUTUAL_FRIENDS_SECTION:"immersive_profile_view_mutual_friends_section",IMMERSIVE_PROFILE_VIEW_PRIVACY_SECTION:"immersive_profile_view_privacy_section",FRIEND_REQUEST_PUSH_NOTIFICATION:"friend_request_push_notification",STORY_PUSH_NOTIFICATION:"story_push_notification",NIX_CONTACT_IMPORT_PUSH_NOTIFICATION:"nix_contact_import_push_notification",NIX_MESSAGE_PUSH_NOTIFICATION:"nix_message_push_notification",FRIEND_REQUESTS_CONTAINER:"friend_requests_container",FRIEND_REQUESTS_VIEW:"friend_requests_view",STORY_MUSIC_EDITOR:"story_music_editor",UNIVERSAL_SEARCH_NULL_STATE:"universal_search_null_state",UNIVERSAL_SEARCH_QUERY_STATE:"universal_search_query_state",NOTE_CREATION_HEADER:"note_creation_header",NOTE_CREATION_CENTER:"note_creation_center",MUSIC_SELECTOR:"music_selector",GAME_SELECTOR:"game_selector",COMBINED_VIEWER_HEADER:"combined_viewer_header",NOTE_CLICKABLE_CONTENT:"note_clickable_content",COMBINED_VIEWER_CONTENT:"combined_viewer_content",COMBINED_VIEWER_FOOTER:"combined_viewer_footer",PARTICIPATION_VIEWER:"participation_viewer",STORY_CREATION_HOMEBASE_HEADER:"story_creation_homebase_header",CONTENT_CREATION_ALBUM_LIST:"content_creation_album_list",STORY_CREATION_HOMEBASE_MODES:"story_creation_homebase_modes",STORY_CREATION_HOMEBASE_ALBUM_PHOTOS:"story_creation_homebase_album_photos",STORY_CREATION_COMPOSER_TOOLBAR:"story_creation_composer_toolbar",STORY_CREATION_COMPOSER_BRUSH_EDITOR:"story_creation_composer_brush_editor",STORY_CREATION_COMPOSER_TEXT_TOOL:"story_creation_composer_text_tool",STORY_CREATION_COMPOSER_STICKER_SELECTOR:"story_creation_composer_sticker_selector",STORY_CREATION_COMPOSER_SETTINGS:"story_creation_composer_settings",STORY_CREATION_COMPOSER_MUSIC_SELECTOR:"story_creation_composer_music_selector",STORY_CREATION_COMPOSER_VIDEO_TOOL:"story_creation_composer_video_tool",STORY_CREATION_COMPOSER_APP_SWITCH_DIALOG:"story_creation_composer_app_switch_dialog",STORY_CREATION_COMPOSER_FULL_APP_SWITCH_DIALOG:"story_creation_composer_full_app_switch_dialog",STORY_CREATION_COMPOSER_LIGHTWEIGHT_APP_SWITCH_DIALOG:"story_creation_composer_lightweight_app_switch_dialog",STORY_CREATION_COMPOSER_LIGHTWEIGHT_APP_SWITCH_INELIGIBLE:"story_creation_composer_lightweight_app_switch_ineligible",NA:"NA",QP:"qp",COMMUNITIES_IN_COMMON_SHEET:"communities_in_common_sheet",FRIENDS_IN_COMMON_SHEET:"friends_in_common_sheet",GROUPCHATS_IN_COMMON_SHEET:"groupchats_in_common_sheet",FRIENDS_IN_COMMON_SEE_ALL:"friends_in_common_see_all",SIDEBAR_ONE_ON_ONE_CHATS:"sidebar_one_on_one_chats",SIDEBAR_GROUP_CHATS:"sidebar_group_chats",SIDEBAR_COMMUNITY_CHATS:"sidebar_community_chats",SIDEBAR_BROADCAST_CHANNELS:"sidebar_broadcast_channels",GROUP_MEMBERS_FILTER_ALL:"group_members_filter_all",GROUP_MEMBERS_FILTER_ADMINS:"group_members_filter_admins",GROUP_MEMBERS_FILTER_HOSTS:"group_members_filter_hosts",READ_RECEIPT:"read_receipt",BIRTHDAY_SPARK_MESSAGE_COMPOSER:"birthday_spark_message_composer",BIRTHDAY_SPARK_CUSTOM_MESSAGES:"birthday_spark_custom_messages",JEWEL_FRIEND_REQUEST_RESPOND_SHEET:"jewel_friend_request_respond_sheet",PEOPLE_FILTER_ACTIVE:"people_filter_active",PEOPLE_FILTER_ALL:"people_filter_all",PEOPLE_FILTER_FRIEND_REQUESTS:"people_filter_friend_requests",PEOPLE_FILTER_CURRENT_CITY:"people_filter_current_city",PEOPLE_FILTER_SCHOOL:"people_filter_school",PEOPLE_FILTER_HOMETOWN:"people_filter_hometown",PEOPLE_FILTER_WORK:"people_filter_work",PEOPLE_TAB_STORIES_TRAY:"people_tab_stories_tray",META_GALLERY_MID_CARD:"meta_gallery_mid_card",META_IG_CROSS_POST_SELF_POG:"meta_ig_cross_post_self_pog",SEE_MORE:"see_more",ONLINE_NOW:"online_now",ACTIVE_NOW_UPSELL_BANNER:"active_now_upsell_banner",ACTIVE_NOW_UPSELL_THREAD_HEADER:"active_now_upsell_thread_header",ACTIVE_NOW_UPSELL_THREAD_DETAILS:"active_now_upsell_thread_details",ACTIVE_NOW_UPSELL_GROUP_MEMBERLIST:"active_now_upsell_group_memberlist",ACTIVE_NOW_SETTINGS_SHEET:"active_now_settings_sheet"}),l=e;i.default=l}),66);
__d("MessengerClientEventTargetType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({ASSET:"asset",BANNER:"banner",BUTTON:"button",BROADCAST_CHANNEL:"broadcast_channel",CAMERA:"camera",COMMUNITY:"community",EVENT:"event",FOLDER:"folder",GROUP:"group",JEWEL_NOTIFICATION:"jewel_notification",PUSH_NOTIFICATION:"push_notification",MESSAGE_THREAD:"message_thread",NOTE:"note",NOTE_CUSTOMIZATION:"note_customization",POLL:"poll",POST:"post",PROMPT:"prompt",PROMPT_RESPONSE:"prompt_response",STORY:"story",TAB:"tab",USER:"user",MUSIC:"music",STICKER:"sticker",AVATAR_STICKER:"avatar_sticker",EMOJI:"emoji",REEL:"reel",LINK:"link",PHOTO:"photo",VIDEO:"video",ALBUM:"album",GIF:"gif",GAME:"game",MOODS:"moods",LOCATION:"location",AI_GENERATED_STICKER:"ai_generated_sticker",ADD_YOURS:"add_yours",FACE_PILE:"face_pile",CONTEXT_MENU:"context_menu",PARTICIPATION_VIEWER:"participation_viewer",UPLOAD_STATUS:"upload_status",READY_MADE_CONTENT:"ready_made_content",INBOX_FILTER:"inbox_filter",THREAD_LIST_CONTAINER:"thread_list_container",MEDIA:"media",REELS_RECAP:"reels_recap",START_CHAT_FILTER:"start_chat_filter",AI_BOT:"ai_bot",RECAP_SETTING_PAGE:"recap_setting_page",PEOPLE_FILTER:"people_filter",INBOX_TRAY_BOTTOM_SHEET:"inbox_tray_bottom_sheet",ACTIVE_NOW_UPSELL_CONTAINER:"active_now_upsell_container",LOCATION_STICKER:"location_sticker",TIME_STICKER:"time_sticker",DATE_STICKER:"date_sticker",BATTERY_STICKER:"battery_sticker",WEATHER_STICKER:"weather_sticker",USER_NOTE:"user_note",USER_STORY:"user_story",USER_NOTE_STORY:"user_note_story",FRIEND_REQUEST_VIEW:"friend_request_view",IMMERSIVE_PROFILE_VIEW:"immersive_profile_view",JEWEL_PAGE:"jewel_page",MSGR_SETTINGS_PAGE:"msgr_settings_page",INVITE_A_FRIEND_PAGE:"invite_a_friend_page",PYMK_VIEW:"pymk_view",STORY_COMPOSER_EDITOR_PAGE:"story_composer_editor",STORY_COMPOSER_HOMEBASE_PAGE:"story_composer_homebase_page",FB_GROUPS_CONTAINER:"fb_groups_container",INBOX_TRAY_CONTAINER:"inbox_tray_container",PYMK_CONTAINER:"pymk_container",REELS_CONTAINER:"reels_container",STANDALONE_COMMUNITIES_CONTAINER:"standalone_communities_container",FRIEND_REQUESTS_CONTAINER:"friend_requests_container",STORY_TRAY_CONTAINER:"story_tray_container",CHAT_WITH_FRIENDS_CONTAINER:"chat_with_friends_container",PARTICIPATION_VIEWER_CONTAINER:"participation_viewer_container",FRIENDS_LIST_CONTAINER:"friends_list_container",NON_FRIENDS_LIST_CONTAINER:"non_friends_list_container",INVITED_LIST_CONTAINER:"invited_group_members_container",ACTIVE_NOW_LIST_CONTAINER:"active_now_list_container",PYMM_CONTAINER:"pymm_container",COMMUNITIES_GROUPS_EDIT_SHEET:"communities_groups_edit_sheet",FRIEND_REQUEST_RESPONSE_SHEET:"friend_request_response_sheet",UNFRIEND_REQUEST_RESPONSE_SHEET:"unfriend_request_response_sheet",PYMK_VIEW_BOTTOM_SHEET:"pymk_view_bottom_sheet",COMMUNITIES_IN_COMMON_SHEET:"communities_in_common_sheet",FRIENDS_IN_COMMON_SHEET:"friends_in_common_sheet",GROUPCHATS_IN_COMMON_SHEET:"groupchats_in_common_sheet",OPEN_FB_POPUP:"open_fb_popup",UPDATE_FB_POPUP:"update_fb_popup",DOWNLOAD_FB_POPUP:"download_fb_popup",LOG_IN_POPUP:"log_in_popup",OTHER_USER_POPUP:"other_user_popup",STORY_SHARED_POPUP:"story_shared_popup",USER_BIRTHDAY_SPARK:"user_birthday_spark",POG_EDUCATIONAL_TEXT:"pog_educational_text",POG_UNREAD_TEXT:"pog_unread_text",POG_VOICE_CALL_BADGE:"pog_voice_call_badge",POG_VIDEO_CALL_BADGE:"pog_video_call_badge",POG_CALL_SUGGESTION_BADGE:"pog_call_suggestion_badge",POG_MISSED_CALL_BADGE:"pog_missed_call_badge",GROUPS_POG:"groups_pog"}),l=e;i.default=l}),66);
__d("MessengerClientEventType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({ONE_PX_IMPRESSION:"one_px_impression",VPVD_IMPRESSION:"vpvd_impression",SINGLE_CLICK:"single_click",LONG_PRESS:"long_press",SYSTEM:"system",SCROLL:"scroll"}),l=e;i.default=l}),66);
__d("MessengerSettingsActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("120"),s=o("FalcoLoggerInternal").create("messenger_settings_action",e),u=s;l.default=u}),98);
__d("logMessengerSettingsFalcoEvent",["MessengerSettingsActionFalcoEvent"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.majorSurface,n=e.minorSurface,o=n===void 0?"NA":n,a=e.target,i=a===void 0?"button":a,l=e.eventType,s=l===void 0?"single_click":l;r("MessengerSettingsActionFalcoEvent").log(function(){return{event_type:s,surface:{entry_point:void 0,major_surface:t,minor_surface:o},target:{type:i}}})}l.default=e}),98);
__d("useMWEditUsernameDialog",["JSResourceForInteraction","LSFactory","LSFetchAccountSyncedFieldsStoredProcedure","emptyFunction","promiseDone","react","react-compiler-runtime","useAsyncReStore","useMWXLazyDialog"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useRef,d=r("JSResourceForInteraction")("MWEditUsernameDialog.react").__setRef("useMWEditUsernameDialog");function m(){var e=o("react-compiler-runtime").c(5),t=r("useAsyncReStore")(),n=r("useMWXLazyDialog")(d),a=n[0],i=c(!1),l,s;e[0]!==t?(l=function(){i.current!==!0&&(i.current=!0,r("promiseDone")(t,p))},s=[t,i],e[0]=t,e[1]=l,e[2]=s):(l=e[1],s=e[2]),u(l,s);var m;return e[3]!==a?(m=function(t,n){a({entryPoint:n,initialUsername:t},r("emptyFunction"))},e[3]=a,e[4]=m):m=e[4],m}function p(e){r("promiseDone")(e.runInTransaction(_,"readwrite",void 0,void 0,i.id+":44"))}function _(e){return r("LSFetchAccountSyncedFieldsStoredProcedure")(r("LSFactory")(e))}l.default=m}),98);
__d("MWInboxSettingEditUsernameMenuItem.react",["fbt","MWPActor.react","MWXIconMenuItemText","MWXMenuItem.react","ReQL","ReQLSuspense","logMessengerSettingsFalcoEvent","react","react-compiler-runtime","useMWEditUsernameDialog","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=r("react"));function d(){var e=o("react-compiler-runtime").c(12),t=(u||(u=r("useReStore")))(),n=o("MWPActor.react").useActor(),a;e[0]!==n||e[1]!==t.tables.contacts?(a=function(){return o("ReQL").fromTableAscending(t.tables.contacts).getKeyRange(n)},e[0]=n,e[1]=t.tables.contacts,e[2]=a):a=e[2];var l;e[3]!==n||e[4]!==t?(l=[t,n],e[3]=n,e[4]=t,e[5]=l):l=e[5];var d=o("ReQLSuspense").useFirst(a,l,i.id+":29"),m=r("useMWEditUsernameDialog")();if(d==null)return null;var p;e[6]!==d.username||e[7]!==m?(p=function(){r("logMessengerSettingsFalcoEvent")({majorSurface:"msgr_settings"}),m(d.username,"msgr_settings")},e[6]=d.username,e[7]=m,e[8]=p):p=e[8];var _;e[9]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Edit username"),e[9]=_):_=e[9];var f;return e[10]!==p?(f=c.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemText"),onClick:p,primaryText:_}),e[10]=p,e[11]=f):f=e[11],f}l.default=d}),226);
__d("useCometHomeChatSettingsQuery$Parameters",["useCometHomeChatSettingsQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("useCometHomeChatSettingsQuery_facebookRelayOperation"),metadata:{},name:"useCometHomeChatSettingsQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("MWInboxSettingsDialog.entrypoint",["JSResourceForInteraction","useCometHomeChatSettingsQuery$Parameters"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{chatSettingsQueryReference:{parameters:n("useCometHomeChatSettingsQuery$Parameters"),variables:{}}}}},root:r("JSResourceForInteraction")("MWInboxSettingsDialogEntrypoint.react").__setRef("MWInboxSettingsDialog.entrypoint")};l.default=e}),98);
__d("MWXIconMenuItemAccessibility",["MWXSvgIcon","SVGIcon","cr:22530","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22530")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemCommentLeftRight",["MWXSvgIcon","SVGIcon","cr:22631","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22631")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemDownload",["MWXSvgIcon","SVGIcon","cr:22648","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22648")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemInfoCircle",["MWXSvgIcon","SVGIcon","cr:22708","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22708")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemMessageDots",["MWXSvgIcon","SVGIcon","cr:22733","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22733")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemQuestionCircle",["MWXSvgIcon","SVGIcon","cr:22784","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22784")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemSettings",["MWXSvgIcon","SVGIcon","cr:22808","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22808")),r("gkx")("23219"));l.default=e}),98);
__d("MWXIconMenuItemTextAlignLeft",["MWXSvgIcon","SVGIcon","cr:22835","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=o("MWXSvgIcon").mwxSvgMenuItemIcon(o("SVGIcon").svgIcon(n("cr:22835")),r("gkx")("23219"));l.default=e}),98);
__d("VenusFlytrapLogging",["QPLUserFlow","qex","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map;function s(e,t){t===void 0&&(t=!1),r("QPLUserFlow").start(r("qpl")._(67975436,"2916"),{annotations:{int:{is_legacy:t||r("qex")._("4899")?0:1},string:{entry_point:e}}})}function u(){r("QPLUserFlow").endCancel(r("qpl")._(67975436,"2916")),e.clear()}function c(){r("QPLUserFlow").endSuccess(r("qpl")._(67975436,"2916"),{}),e.clear()}function d(){r("QPLUserFlow").endFailure(r("qpl")._(67975436,"2916"),"bug_report_failed"),e.clear()}function m(t){var n,o=(n=e.get(t.stepPoint))!=null?n:0;r("QPLUserFlow").addPoint(r("qpl")._(67975436,"2916"),o===0?t.stepPoint:t.stepPoint+"_"+o,{data:p(t)}),e.set(t.stepPoint,o+1)}function p(e){switch(e.stepPoint){case"set_problem_type":{var t=e.data.problemType;return{string:{problem_type:t}}}case"set_has_complete_logs":{var n=e.data.hasCompleteLogs;return{int:{has_complete_logs:n?1:0}}}case"add_attachment":{var r=e.data.numberOfAttachments;return{int:{number_of_attachments:r}}}default:return}}l.venusFlytrapLoggingStart=s,l.venusFlytrapLoggingEndCancel=u,l.venusFlytrapLoggingEndSuccess=c,l.venusFlytrapLoggingEndFailure=d,l.venusFlytrapLoggingAddPoint=m}),98);
__d("defaultMessengerVenusFlytrapConfig",["gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("gkx")("8863"),s={isTriggeredByShortcut:!1,stepAreaPreselectionMode:"no-preselection-typeahead-always",stepCompleteLogsMode:"page",stepProblemTypeMode:"skip",stepScreenCaptureMode:"default",stepSubmissionMode:e?"page":"toast"};l.default=s}),98);
__d("useMessengerVenusFlytrapDialog",["JSResourceForInteraction","MWXDialogLoadingState.react","defaultMessengerVenusFlytrapConfig","react","react-compiler-runtime","useMWXLazyDialog"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useRef,c=r("JSResourceForInteraction")("FacebookVenusFlytrapProblemTypeDialog.react").__setRef("useMessengerVenusFlytrapDialog"),d=r("JSResourceForInteraction")("FacebookVenusFlytrapPrivacyDisclaimerDialog.react").__setRef("useMessengerVenusFlytrapDialog");function m(e){var t=o("react-compiler-runtime").c(5),n;t[0]!==e?(n=babelHelpers.extends({},r("defaultMessengerVenusFlytrapConfig"),e),t[0]=e,t[1]=n):n=t[1];var a=n,i=u(!1),l=r("useMWXLazyDialog")(a.stepProblemTypeMode==="skip"?d:c,p),s=l[0],m;return t[2]!==a||t[3]!==s?(m=function(t,n){i.current||(s(babelHelpers.extends({},a,t,{bugnubApp:"messenger",preSelectedProducts:[]}),function(){i.current=!1,n==null||n()},!0),i.current=!0)},t[2]=a,t[3]=s,t[4]=m):m=t[4],m}function p(e){return s.jsx(r("MWXDialogLoadingState.react"),{onClose:e})}p.displayName=p.name+" [from "+i.id+"]",l.default=m}),98);
__d("MWInboxSettingsMenu.react",["fbt","CurrentEnvironment","CurrentUser","FDSMenuSeparator.react","FDSSeparatorMenuItem.react","I64","JSResourceForInteraction","LSDataUseConsentState","LSIntEnum","MWChatEncryptedBackupsChatHistoryDialog.entrypoint","MWChatSidebarSettingsPrivacyMenu.react","MWFacebookUserWithoutMessengerAccess","MWInboxAccessibilitySettingsDialog.entrypoint","MWInboxRestrictedAccountsRouteBuilder","MWInboxSettingEditUsernameMenuItem.react","MWInboxSettingsDialog.entrypoint","MWPBumpEntityKey","MWSeparatorContainer.react","MWXIconMenuItemAccessibility","MWXIconMenuItemBox","MWXIconMenuItemCautionTriangle","MWXIconMenuItemCommentLeftRight","MWXIconMenuItemDownload","MWXIconMenuItemInfoCircle","MWXIconMenuItemLeave","MWXIconMenuItemMessageCross","MWXIconMenuItemMessageDots","MWXIconMenuItemQuestionCircle","MWXIconMenuItemSettings","MWXIconMenuItemTextAlignLeft","MWXMenu.react","MWXMenuItem.react","MessageRequestsLog","MessengerMSplitFlag","MetaConfig","ODS","Promise","ReQL","ReQLSuspense","VenusFlytrapLogging","VenusFlytrapLoggingEntrypoint","XMessengerHelpCenterHomeControllerRouteBuilder","cr:4007","cr:4021","cr:494","cr:7484","gkx","openMessengerLogOut","promiseDone","qex","react","useMWXEntryPointDialog","useMWXLazyDialog","useMessengerVenusFlytrapDialog","useReStore"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m,p,_,f=_||(_=o("react"));function g(e){return h}function h(){return(p||(p=n("Promise"))).resolve()}var y=(e=n("cr:494"))!=null?e:g;function C(e){var t=e.onClose,a=e.showHidden,l=e.showMessageRequests,p=e.showRestrictedAccounts,_=(u||(u=r("useReStore")))(),g=o("ReQLSuspense").useFirst(function(){return o("ReQL").fromTableAscending(_.tables.epd_cookie_settings)},[_],i.id+":90"),h=r("MetaConfig")._("37"),C=r("useMWXEntryPointDialog")(r("MWInboxSettingsDialog.entrypoint"),{}),b=C[0],v=r("useMWXEntryPointDialog")(r("MWChatEncryptedBackupsChatHistoryDialog.entrypoint"),{}),S=v[0],R=r("useMWXEntryPointDialog")(r("MWInboxAccessibilitySettingsDialog.entrypoint"),{}),L=R[0],E=r("useMessengerVenusFlytrapDialog")(),k=r("useMWXLazyDialog")(r("JSResourceForInteraction")("MWInboxBugReportDialog.react").__setRef("MWInboxSettingsMenu.react")),I=k[0],T=f.jsx(r("MWXMenuItem.react"),{href:"https://www.facebook.com/help/cookies",icon:r("MWXIconMenuItemTextAlignLeft"),onClick:function(){return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","cookie_policy")},primaryText:s._(/*BTDS*/"Cookie Policy"),target:"_blank",testid:void 0}),D=r("gkx")("24080"),x=f.jsx(r("MWXMenuItem.react"),{href:"https://accountscenter.facebook.com/info_and_permissions/cookie_settings",icon:r("MWXIconMenuItemSettings"),primaryText:s._(/*BTDS*/"Cookie settings"),target:"_blank",testid:void 0}),$=D&&g!=null&&!(c||(c=o("I64"))).equal(g.fbTrackersOnOtherCompanies,(d||(d=o("LSIntEnum"))).ofNumber(r("LSDataUseConsentState").UNSET))&&!(c||(c=o("I64"))).equal(g.otherCompanyTrackersOnFoa,(d||(d=o("LSIntEnum"))).ofNumber(r("LSDataUseConsentState").UNSET))&&!r("MessengerMSplitFlag").is_msplit_account?x:T,P=y(!0),N;h?N=f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemLeave"),onClick:function(){return r("promiseDone")(P().then(function(){return r("openMessengerLogOut")()})),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","logout")},primaryText:s._(/*BTDS*/"Log out"),testid:void 0}):N=null;var M=o("MWFacebookUserWithoutMessengerAccess").useIsFacebookUserWithoutMessengerAccess(),w=f.jsx(r("MWXMenuItem.react"),{href:h?o("MWInboxRestrictedAccountsRouteBuilder").buildURLWithoutThread():void 0,icon:r("MWXIconMenuItemMessageCross"),onClick:function(){return h||p(),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","show_restricted_accounts")},primaryText:s._(/*BTDS*/"Restricted accounts"),testid:void 0}),A=o("CurrentUser").isMessengerOnlyUser()||o("CurrentUser").isDeactivatedAllowedOnMessenger()?f.jsx(r("MWXMenuItem.react"),{href:"https://www.messenger.com/dyi",icon:r("MWXIconMenuItemDownload"),primaryText:s._(/*BTDS*/"Export your information"),target:"_blank"}):null,F=n("cr:4007")==null?void 0:n("cr:4007")();return f.jsxs(r("MWXMenu.react"),{"aria-label":s._(/*BTDS*/"Inbox settings menu"),id:"mw-inbox-settings-menu",testid:void 0,truncate:!0,withArrow:!0,children:[n("cr:4021")&&F!=null&&F>0?f.jsx(n("cr:4021"),{value:F}):null,F!=null&&F>0?f.jsx(r("FDSSeparatorMenuItem.react"),{}):null,f.jsxs(r("MWSeparatorContainer.react"),{separator:f.jsx(r("FDSMenuSeparator.react"),{}),children:[f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemSettings"),onClick:function(){return b({},function(){}),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","preferences")},primaryText:s._(/*BTDS*/"Preferences"),testid:void 0}),h&&r("gkx")("772")?f.jsx(r("MWInboxSettingEditUsernameMenuItem.react"),{}):null,h?w:f.jsxs("div",{children:[f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemMessageDots"),onClick:function(){return o("MessageRequestsLog").logMessageRequestsView(0,-1),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","message_requests"),l()},primaryText:r("qex")._("4751")?s._(/*BTDS*/"Spam"):s._(/*BTDS*/"Message requests"),testid:void 0}),f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemBox"),onClick:function(){return a(),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","report_problem")},primaryText:s._(/*BTDS*/"Archived chats"),testid:void 0}),w]}),f.jsxs(f.Fragment,{children:[r("MWChatSidebarSettingsPrivacyMenu.react")&&f.jsx(r("MWChatSidebarSettingsPrivacyMenu.react"),{}),!h&&r("gkx")("11645")&&f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemCommentLeftRight"),onClick:function(){return S({}),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","chat_history")},primaryText:s._(/*BTDS*/"Chat history"),testid:void 0}),h&&f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemAccessibility"),onClick:function(){return L({},function(){})},primaryText:s._(/*BTDS*/"Accessibility"),testid:void 0})]}),n("cr:7484")&&f.jsx(n("cr:7484"),{}),f.jsxs("div",{children:[f.jsx(r("MWXMenuItem.react"),{href:r("XMessengerHelpCenterHomeControllerRouteBuilder").buildUri({}).toString(),icon:r("MWXIconMenuItemQuestionCircle"),onClick:function(){return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","help")},primaryText:s._(/*BTDS*/"Help"),target:"_blank",testid:void 0}),r("CurrentEnvironment").messengerdotcom?f.jsx(r("MWXMenuItem.react"),{icon:r("MWXIconMenuItemCautionTriangle"),onClick:function(){return E!=null?(o("VenusFlytrapLogging").venusFlytrapLoggingStart(r("VenusFlytrapLoggingEntrypoint").TOP_NAVIGATION_SETTINGS),E()):(o("VenusFlytrapLogging").venusFlytrapLoggingStart(r("VenusFlytrapLoggingEntrypoint").TOP_NAVIGATION_SETTINGS),I({initialProduct:"chat"},function(){})),o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","report_problem")},primaryText:s._(/*BTDS*/"Report a problem"),testid:void 0}):null]}),h?f.jsxs(f.Fragment,{children:[f.jsx(r("MWXMenuItem.react"),{href:"https://www.facebook.com/policies",icon:r("MWXIconMenuItemTextAlignLeft"),onClick:function(){return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","terms")},primaryText:s._(/*BTDS*/"Terms"),target:"_blank",testid:void 0}),f.jsx(r("MWXMenuItem.react"),{href:"https://www.facebook.com/privacy/policy?entry_point=messenger_settings",icon:r("MWXIconMenuItemTextAlignLeft"),onClick:function(){return o("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","privacy_policy")},primaryText:s._(/*BTDS*/"Privacy Policy"),target:"_blank",testid:void 0}),$,A,o("CurrentUser").isMessengerOnlyUser()?f.jsx(r("MWXMenuItem.react"),{href:"https://www.facebook.com/help/messenger-app/ipad/458908261952384?helpref=platform_switcher&rdrhc",icon:r("MWXIconMenuItemInfoCircle"),onClick:function(){(m||(m=o("ODS"))).bumpEntityKey(3185,"inbox_settings","delete_account")},primaryText:s._(/*BTDS*/"Delete your account"),target:"_blank"}):null]}):null,M&&N==null?null:f.jsx("div",{children:N})]})]})}C.displayName=C.name+" [from "+i.id+"]",l.default=C}),226);
__d("MWMessageSearchEBRestoreUpsell.react",["fbt","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreUpsellTrigger.react","MWXLink.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(1),t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=u.jsx(r("MWEBRestoreUpsellTrigger.react"),{markerPrefix:"RESTORE_UNIVERSAL_MESSAGE_SEARCH",qplSource:r("MWChatEncryptedBackupsQPLSource.enum").UNIVERSAL_MESSAGE_SEARCH,children:d}),e[0]=t):t=e[0],t}function d(e,t){return u.jsxs(r("MWXText.react"),{align:"center",ref:t,type:"meta3",children:[s._(/*BTDS*/"Messages are missing. Restore your chat history to search more messages.")," ",u.jsx(r("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:u.jsx(r("MWXLink.react"),{onClick:e,children:s._(/*BTDS*/"Restore now")})})]})}d.displayName=d.name+" [from "+i.id+"]",l.default=c}),226);
__d("MWPinnedMessagesDialogNUXFactory.react",["JSResourceForInteraction","MWInboxPersistedUIState","declareNUXRequireable","react","react-compiler-runtime","useMWXLazyDialog","useSharedNUX"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useCallback,d=u.useMemo,m=r("JSResourceForInteraction")("MWPinnedMessagesDialogNUX.react").__setRef("MWPinnedMessagesDialogNUXFactory.react");function p(e){function t(t){var n=o("react-compiler-runtime").c(15),a=t.children,i=t.dialogProps,l=r("useSharedNUX")(e),s=l[0],u=l[1],c=o("MWInboxPersistedUIState").usePersistedUIState(void 0,"__MWSimpleNux."+e+"__"),d=c[1],p;n[0]!==u||n[1]!==d?(p=function(){d(void 0),u.onDismiss()},n[0]=u,n[1]=d,n[2]=p):p=n[2];var _=p,f;n[3]!==i.pinMessageHandler||n[4]!==_?(f={onDismiss:_,pinMessageHandler:i.pinMessageHandler},n[3]=i.pinMessageHandler,n[4]=_,n[5]=f):f=n[5];var g=f,h=r("useMWXLazyDialog")(m),y=h[0],C;n[6]!==g||n[7]!==y?(C=function(){return y(g)},n[6]=g,n[7]=y,n[8]=C):C=n[8];var b=C;if(s){var v;return n[9]!==a||n[10]!==b?(v=a(b),n[9]=a,n[10]=b,n[11]=v):v=n[11],v}var S;return n[12]!==a||n[13]!==i.pinMessageHandler?(S=a(i.pinMessageHandler),n[12]=a,n[13]=i.pinMessageHandler,n[14]=S):S=n[14],S}return t}var _=r("declareNUXRequireable")(p);l.default=_}),98);
__d("MWReadReceiptsMenuItem.react",["fbt","FDSMenuItemCheckbox.react","I64","LSFactory","LSIntEnum","LSOptimisticallyUpdateMessagingPrivacySettingsStoredProcedure","LSReadReceiptSettingState","MWXMenuItemWithSubmenu.react","MWXText.react","ReadReceiptControlSettingChangedFalcoEvent","promiseDone","react","react-compiler-runtime","useAsyncReStore","useDebouncedOnChange","useMWIsReadReceiptsDisabledForUser"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d=e||(e=o("react")),m=e.useCallback,p=250;function _(){var e=o("react-compiler-runtime").c(14),t=r("useAsyncReStore")(),n=r("useMWIsReadReceiptsDisabledForUser")(),a;e[0]!==t?(a=function(n){r("promiseDone")(t,function(e){var t=n?(u||(u=o("LSIntEnum"))).ofNumber(r("LSReadReceiptSettingState").DISABLED):(u||(u=o("LSIntEnum"))).ofNumber(r("LSReadReceiptSettingState").ENABLED);r("ReadReceiptControlSettingChangedFalcoEvent").log(function(){return{is_account_level:!0,setting_enabled:!(c||(c=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("LSReadReceiptSettingState").DISABLED))}}),r("promiseDone")(e.runInTransaction(function(e){return r("LSOptimisticallyUpdateMessagingPrivacySettingsStoredProcedure")(r("LSFactory")(e),{readReceiptsDisabled:t})},"readwrite",void 0,void 0,i.id+":50"))})},e[0]=t,e[1]=a):a=e[1];var l=a,m=r("useDebouncedOnChange")(n,l,p),_=m[0],f=m[1],g=!_,h;e[2]!==f||e[3]!==_?(h=function(){return f(!_)},e[2]=f,e[3]=_,e[4]=h):h=e[4];var y;e[5]===Symbol.for("react.memo_cache_sentinel")?(y=s._(/*BTDS*/"Show read receipts"),e[5]=y):y=e[5];var C;e[6]!==_?(C=_?s._(/*BTDS*/"People won't be able to see when you've read their messages, and you won't be able to see when they've read yours."):s._(/*BTDS*/"People will be able to see when you've read their messages."),e[6]=_,e[7]=C):C=e[7];var b;e[8]!==C?(b=d.jsx(r("MWXText.react"),{color:"secondary",type:"body4",children:C}),e[8]=C,e[9]=b):b=e[9];var v;return e[10]!==g||e[11]!==h||e[12]!==b?(v=d.jsx(r("FDSMenuItemCheckbox.react"),{asSwitch:!0,isSelected:g,onClick:h,preventClosingMenuOnSelect:!0,primaryText:y,secondaryText:b}),e[10]=g,e[11]=h,e[12]=b,e[13]=v):v=e[13],v}function f(){var e=o("react-compiler-runtime").c(6),t=r("useMWIsReadReceiptsDisabledForUser")(),n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=s._(/*BTDS*/"Read receipts"),e[0]=n):n=e[0];var a;e[1]!==t?(a=t?s._(/*BTDS*/"Off"):s._(/*BTDS*/"On"),e[1]=t,e[2]=a):a=e[2];var i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i={header:{title:s._(/*BTDS*/"Read receipts")},items:[d.jsx(_,{},"read-receipts")]},e[3]=i):i=e[3];var l;return e[4]!==a?(l=d.jsx(r("MWXMenuItemWithSubmenu.react"),{primaryText:n,secondaryText:a,submenu:i}),e[4]=a,e[5]=l):l=e[5],l}l.default=f}),226);
__d("MWV2NegativeFeedbackMenuItem.react",["MWXMenuItem.react","react","react-compiler-runtime","useGenAiNegativeFeedback"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(3),n=e.message,a=r("useGenAiNegativeFeedback")(n),i=a[0],l=a[1],u;return t[0]!==i||t[1]!==l?(u=s.jsx(r("MWXMenuItem.react"),{"aria-label":l,onClick:i,primaryText:l,testid:void 0}),t[0]=i,t[1]=l,t[2]=u):u=t[2],u}l.default=u}),98);
__d("MWV2PositiveFeedbackMenuItem.react",["MWXMenuItem.react","react","react-compiler-runtime","useGenAiPositiveFeedback"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(3),n=e.message,a=r("useGenAiPositiveFeedback")(n),i=a[0],l=a[1],u;return t[0]!==i||t[1]!==l?(u=s.jsx(r("MWXMenuItem.react"),{"aria-label":l,onClick:i,primaryText:l,testid:void 0}),t[0]=i,t[1]=l,t[2]=u):u=t[2],u}l.default=u}),98);
__d("MessengerAccessibilityFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 29c6.075 0 11-4.925 11-11S24.075 7 18 7 7 11.925 7 18s4.925 11 11 11zm0-15c-.941 0-1.75-.652-1.75-2.07 0-1.158.737-1.93 1.75-1.93s1.75.772 1.75 1.93c0 1.418-.809 2.07-1.75 2.07zm6.5 1.797a.797.797 0 0 0-.797-.797H12.297a.797.797 0 0 0-.1 1.587l2.563.32a1 1 0 0 1 .863.828l.255 1.53c.08.483.041.978-.114 1.442l-1.343 4.032a.958.958 0 0 0 1.809.631l1.535-4.207a.25.25 0 0 1 .47 0l1.535 4.207a.958.958 0 0 0 1.81-.631l-1.344-4.032a3.001 3.001 0 0 1-.114-1.442l.255-1.53a1 1 0 0 1 .863-.828l2.562-.32a.797.797 0 0 0 .698-.79z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MessengerFriendsFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{d:"M7.25 12.305C7.25 16.207 9.446 18 12 18s4.75-1.793 4.75-5.695C16.75 9.123 14.75 7 12 7s-4.75 2.123-4.75 5.305zM15.082 21.607c.39-.423.262-1.13-.296-1.269A11.576 11.576 0 0 0 12 20c-4.835 0-9 2.985-9 6.665C3 27.405 3.37 28 4.06 28h7.81c.66 0 1.13-.675 1.13-1.335 0-1.97.83-3.697 2.082-5.058zM19.25 12.305C19.25 16.207 21.446 18 24 18s4.75-1.793 4.75-5.695C28.75 9.123 26.75 7 24 7s-4.75 2.123-4.75 5.305zM33 26.665c0 .74-.37 1.335-1.06 1.335H16.06c-.69 0-1.06-.595-1.06-1.335C15 22.985 19.165 20 24 20s9 2.985 9 6.665z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MessengerHouseKeyholeFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M16.162 7.624a3 3 0 0 1 3.676 0l9.642 7.473a1.342 1.342 0 0 1-.822 2.403H27.25a.25.25 0 0 0-.25.25v8.75a2 2 0 0 1-2 2H11a2 2 0 0 1-2-2v-8.75a.25.25 0 0 0-.25-.25H7.342a1.342 1.342 0 0 1-.822-2.403l9.642-7.473zm3.532 10.852c-.203.14-.314.387-.242.622l1.514 4.932a.75.75 0 0 1-.718.97h-4.497a.75.75 0 0 1-.717-.97l1.514-4.932c.072-.235-.04-.483-.242-.622a3 3 0 1 1 3.388 0z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MessengerQuestionCircleFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 29c6.075 0 11-4.925 11-11S24.075 7 18 7 7 11.925 7 18s4.925 11 11 11zm-1.311-15.93c-.314.192-.585.482-.832.892a1 1 0 0 1-1.713-1.032c.365-.606.844-1.164 1.502-1.566.663-.406 1.446-.614 2.354-.614 2.396 0 4.5 1.565 4.5 4 0 1.865-1.227 2.827-2.065 3.483l-.067.053c-.913.717-1.368 1.13-1.368 1.964a1 1 0 1 1-2 0c0-1.865 1.227-2.827 2.065-3.483l.067-.053c.913-.717 1.368-1.13 1.368-1.964 0-1.043-.896-2-2.5-2-.592 0-1.003.132-1.311.32zM19.25 24a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MessengerSettingsFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M19.842 7.526A1.5 1.5 0 0 0 18.419 6.5h-.838a1.5 1.5 0 0 0-1.423 1.026l-.352 1.056c-.157.472-.541.827-1.006 1.003a8.93 8.93 0 0 0-.487.202c-.453.204-.976.225-1.42.002l-.997-.498a1.5 1.5 0 0 0-1.732.281l-.592.592a1.5 1.5 0 0 0-.28 1.732l.497.996c.223.445.202.968-.002 1.421-.072.16-.139.323-.202.487-.176.465-.531.849-1.003 1.006l-1.056.352A1.5 1.5 0 0 0 6.5 17.581v.838a1.5 1.5 0 0 0 1.026 1.423l1.056.352c.472.157.827.541 1.003 1.006.063.164.13.327.202.487.204.453.225.976.002 1.42l-.498.997a1.5 1.5 0 0 0 .281 1.732l.593.592a1.5 1.5 0 0 0 1.73.28l.998-.497c.444-.223.967-.202 1.42.002.16.072.323.139.487.202.465.176.849.531 1.006 1.003l.352 1.056a1.5 1.5 0 0 0 1.423 1.026h.838a1.5 1.5 0 0 0 1.423-1.026l.352-1.056c.157-.472.541-.827 1.006-1.003.164-.063.327-.13.486-.202.454-.204.977-.225 1.421-.002l.997.498a1.5 1.5 0 0 0 1.732-.281l.592-.592a1.5 1.5 0 0 0 .28-1.732l-.497-.996c-.223-.445-.202-.968.002-1.421.072-.16.139-.323.202-.487.176-.465.531-.849 1.003-1.006l1.056-.352a1.5 1.5 0 0 0 1.026-1.423v-.838a1.5 1.5 0 0 0-1.026-1.423l-1.056-.352c-.472-.157-.827-.541-1.003-1.006a8.991 8.991 0 0 0-.202-.487c-.204-.453-.225-.976-.002-1.42l.498-.997a1.5 1.5 0 0 0-.281-1.732l-.593-.592a1.5 1.5 0 0 0-1.73-.28l-.998.497c-.444.223-.967.202-1.42-.002a8.938 8.938 0 0 0-.487-.202c-.465-.176-.849-.531-1.006-1.003l-.352-1.056zM18 23.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("MessengerTextAlignLeftFilled.svg.react",["XPlatReactSVG","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs(o("XPlatReactSVG").Svg,babelHelpers.extends({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:e.title},e,{children:[e.children!=null&&s.jsx(o("XPlatReactSVG").Defs,{children:e.children}),s.jsx(o("XPlatReactSVG").Path,{d:"M8 10a1 1 0 0 0-1 1v.5a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V11a1 1 0 0 0-1-1H8zM7 17.75a1 1 0 0 1 1-1h20a1 1 0 0 1 1 1v.5a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1v-.5zM7 24.5a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.5a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1v-.5z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._isSVG=!0;var c=u;l.default=c}),98);
__d("PAKEDecryptSecretSprocStatusEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:0,WRONG_KEYS:-1,FAILURE:-2});i.default=e}),66);
__d("PAKEGetActiveSessionSprocStatusEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:0,NO_SESSION:-1,FAILURE:-2});i.default=e}),66);
__d("PAKEMessageTypeEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({AWAITING_CLIENT:0,PAKE_MESSAGE_1:1,PAKE_MESSAGE_2_AND_SECRET:2,SESSION_EXPIRED_ERROR:3,MAX_ATTEMPTS_ERROR:4,GENERIC_ERROR:5,MESSAGE_SENT_ERROR:6,PREVIOUS_MESSAGE_MISSING_ERROR:7,INVALID_PREVIOUS_MESSAGE_ERROR:8,ENCRYPTION_ERROR:9,DECRYPTION_ERROR:10,CPACE_STEP_2_ERROR:11,FETCH_SECRETS_ERROR:12,CPACE_STEP_1_ERROR:13,CPACE_STEP_3_ERROR:14,PAKE_HANDSHAKE_SUCCESS:15,SERIALIZATION_ERROR:16,NO_ACTIVE_SESSION:17,MULTIPLE_ACTIVE_SESSIONS_ERROR:18,PROCESS_SECRETS_ERROR:19,TIMEOUT_ERROR:20,FLOW_ABANDONED_ERROR:21,DESERIALIZE_SECRETS_ERROR:22,CODE_REQUESTED:23,PQ_PAKE_MESSAGE_2:24,PQ_PAKE_MESSAGE_3:25,PQ_PAKE_SECRETS:26});i.default=e}),66);
__d("PakeInitiatorSprocCalls",["LSDecryptPakeSecretStoredProcedure","LSFactory","LSGetActiveSessionStoredProcedure","LSIntEnum","LSSendPakeMessageOneStoredProcedure","LSSendPakeMessageStoredProcedure","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.clientType,a=t.initiatorId,l=t.messagePayload,s=t.sessionId,u=t.storage;r("promiseDone")(u.runInTransaction(function(t){return r("LSSendPakeMessageOneStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),initiatorId:a,messagePayload:l,sessionId:s})},"readwrite",void 0,void 0,i.id+":45"))}function u(t){var n=t.clientType,a=t.initiatorId,l=t.storage;return l.runInTransaction(function(t){return r("LSGetActiveSessionStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),initiatorId:a})},"readwrite",void 0,void 0,i.id+":71")}function c(t){var n=t.clientType,a=t.encryptionKey,l=t.sessionId,s=t.storage;return s.runInTransaction(function(t){return r("LSDecryptPakeSecretStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),encryptionKey:a,sessionId:l})},"readwrite",void 0,void 0,i.id+":92")}function d(t){var n=t.clientType,a=t.messagePayload,l=t.messageType,s=t.senderId,u=t.sessionId,c=t.storage;return c.runInTransaction(function(t){return r("LSSendPakeMessageStoredProcedure")(r("LSFactory")(t),{clientType:(e||(e=o("LSIntEnum"))).ofNumber(n),messagePayload:a,messageType:e.ofNumber(l),senderId:s,sessionId:u})},"readwrite",void 0,void 0,i.id+":116")}l.sendPakeMessageOne=s,l.joinPakeSession=u,l.decryptPakeSecret=c,l.sendPakeMessage=d}),98);
__d("PakeQplLogging",["MWEBODSCategory","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","ODS","QPLEvent","QPLUserFlow"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){r("QPLUserFlow").getActiveFlowIDs().includes((e||(e=o("QPLEvent"))).getMarkerId(t))||((s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,r("MWEBODSEntityKey.enum").START),r("QPLUserFlow").start(t,{annotations:{string:babelHelpers.extends({},n)}}))}function c(e){var t=e.annotations,n=e.errorName,a=e.event,i=e.isUserError;r("QPLUserFlow").endFailure(a,n,{annotations:t});var l=i===!0?r("MWEBODSEntityKey.enum").SUCCESS:r("MWEBODSEntityKey.enum").FAIL;(s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,l)}function d(e,t){r("QPLUserFlow").endSuccess(e,{annotations:t}),(s||(s=o("ODS"))).bumpEntityKey(r("MWEBODSCategory"),r("MWEBODSEntityName.enum").MW_EB_OTC_AUTH,r("MWEBODSEntityKey.enum").SUCCESS)}l.startPakeQPLFlow=u,l.endPakeQPLFlowFailure=c,l.endPakeQPLFlowSuccess=d}),98);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9747954008656745"}),null);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql",["VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"begin_login_request",variableName:"input"}],concreteType:"VestaBeginLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_begin_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2_sig",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:t},params:{id:n("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderBeginLoginMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9611648865601020"}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql",["VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"finish_login_request",variableName:"input"}],concreteType:"VestaFinishLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_login_payload",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_success",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:t},params:{id:n("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderFinishLoginMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9285801411531503"}),null);
__d("VestaServerGraphQLLoginProviderInitQuery.graphql",["VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{alias:null,args:[{kind:"Variable",name:"vesta_init_request",variableName:"request"}],concreteType:"VestaInitIqResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_login_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderInitQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VestaServerGraphQLLoginProviderInitQuery",selections:t},params:{id:n("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderInitQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("VestaServerGraphQLLoginProvider",["E2EEBackupUtil","RelayHooks","RelayModern","VestaServerGraphQLLoginProviderBeginLoginMutation.graphql","VestaServerGraphQLLoginProviderFinishLoginMutation.graphql","VestaServerGraphQLLoginProviderInitQuery.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;async function c(t,r){var a=r.environment,i=await o("RelayHooks").fetchQuery(a,e!==void 0?e:e=n("VestaServerGraphQLLoginProviderInitQuery.graphql"),{request:{fbid:t.clientId,product_use_case:t.productUseCase,vesta_client_api_version:6}}).toPromise(),l=i==null?void 0:i.fbid_based_auth_layer_vesta_login_init,s=l==null?void 0:l.base64url_encoded_island_rsa_pub,u=l==null?void 0:l.base64url_encoded_island_rsa_pub_signature,c=l==null?void 0:l.base64url_encoded_opaque_pub,d=l==null?void 0:l.base64url_encoded_opaque_pub_signature,m=l==null?void 0:l.base64url_encoded_island_ed25519_pub,p=l==null?void 0:l.base64url_encoded_island_ed25519_pub_signature,_=l==null?void 0:l.is_registered,f=l==null?void 0:l.attempts_remaining;if(s!=null&&u!=null&&c!=null&&d!=null&&m!=null&&p!=null&&_!=null){var g;return{islandRsaPub:(g=o("E2EEBackupUtil")).decodeBase64Url(s),islandRsaPubSig:g.decodeBase64Url(u),opaquePub:g.decodeBase64Url(c),opaquePubSig:g.decodeBase64Url(d),islandEd25519Pub:g.decodeBase64Url(m),islandEd25519PubSig:g.decodeBase64Url(p),isRegistered:_,loginAttemptsRemaining:f}}throw new Error("GraphQL Response is Null")}function d(e,t){var r=t.environment,a=s!==void 0?s:s=n("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql"),i={input:{fbid:e.clientId,product_use_case:e.productUseCase,base64url_encoded_opaque_l1:o("E2EEBackupUtil").encodeBase64Url(e.opaqueL1)}};return new Promise(function(e,t){o("RelayModern").commitMutation(r,{mutation:a,variables:i,onCompleted:function(r){var n=r.fbid_based_auth_layer_vesta_begin_login,a=n==null?void 0:n.base64url_encoded_opaque_l2,i=n==null?void 0:n.base64url_encoded_opaque_l2_sig;if(a!=null&&i!=null){e({opaqueL2:o("E2EEBackupUtil").decodeBase64Url(a),opaqueL2Sig:o("E2EEBackupUtil").decodeBase64Url(i)});return}t(new Error("GraphQL Response is Null"))},onError:function(n){t(n)}})})}function m(e,t){var r=t.environment,a=t.updater;return new Promise(function(t,i){o("RelayModern").commitMutation(r,{mutation:u!==void 0?u:u=n("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql"),variables:{input:{fbid:e.clientId,product_use_case:e.productUseCase,base64url_encoded_opaque_l3:o("E2EEBackupUtil").encodeBase64Url(e.opaqueL3)}},onCompleted:function(n){var e=n.fbid_based_auth_layer_vesta_finish_login,r=e==null?void 0:e.base64url_encoded_login_payload,a=e==null?void 0:e.login_success,l=e==null?void 0:e.attempts_remaining;if(a!=null){t({loginSuccess:a,loginPayload:r==null?r:o("E2EEBackupUtil").decodeBase64Url(r),attemptsRemaining:l});return}i(new Error("GraphQL Response is Null"))},onError:function(t){i(t)},updater:a})})}l.initLogin=c,l.beginLogin=d,l.finishLogin=m}),98);
__d("WebStorageManagerEstimatesFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("2144"),s=o("FalcoLoggerInternal").create("web_storage_manager_estimates",e),u=s;l.default=u}),98);
__d("YpMessengerFamilyCenterCoreClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("4644"),s=o("FalcoLoggerInternal").create("yp_messenger_family_center_core_client_event",e),u=s;l.default=u}),98);
__d("YpMessengerFamilyCenterSetupClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("4648"),s=o("FalcoLoggerInternal").create("yp_messenger_family_center_setup_client_event",e),u=s;l.default=u}),98);
__d("YpMessengerTimeLimitClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("6453"),s=o("FalcoLoggerInternal").create("yp_messenger_time_limit_client_event",e),u=s;l.default=u}),98);
__d("deserializeSecretsAndAddDevice",["EBLogger","EBSMAPI","MWEncryptedBackupsInitializeRestoreDeferred","MWPakeQPLEvents","PAKEMessageTypeEnum","PakeQplLogging","QPLUserFlow"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.db,n=e.initiatorId,a=e.onAddDeviceFailure,i=e.onAddDeviceFinish,l=e.secrets;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_START");var s=await r("EBSMAPI").otcAddDevice({initiatorId:n,secrets:l});if(s.success){var u;r("QPLUserFlow").addPoint((u=o("MWPakeQPLEvents")).pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_END"),i(),r("QPLUserFlow").addPoint(u.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_START"),o("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:t,onFailure:function(){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1}},errorName:"MEB_INITIALIZE_RESTORE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1})}}),r("QPLUserFlow").addPoint(u.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_END"),o("PakeQplLogging").endPakeQPLFlowSuccess(u.pakeInitiatorQplEvent)}else if(s.error.status==="OTC_ADD_DEVICE_SPROC_FAILURE")o("EBLogger").EBLogger().mustfix("PAKE: deserializeSecretsAndAddDevice sproc failed"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}},errorName:"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();else if(s.error.status==="OTC_ADD_DEVICE_SYSTEM_ERROR")o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}},errorName:"MEB_FINISH_ADD_PEER_DEVICE_FAILURE",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();else if(s.error.status==="OTC_ADD_DEVICE_UNEXPECTED_RECOVERY_CODE_STATUS"){var c=s.error.errorMessage;c!=null&&o("EBLogger").EBLogger().mustfix(c)}else if(s.error.status==="OTC_ADD_DEVICE_SPROC_ERROR"){var d=s.error.errorMessage;d!=null&&o("EBLogger").EBLogger().mustfix(d),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR},string:{exceptionMessage:d!=null?d:"<null>"}},errorName:"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_EXCEPTION",event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a()}return function(){}}l.default=e}),98);
__d("establishPakeHandshakeAsInitiator",["Base64Utils","FBLogger","I64","MWEncryptedBackupsDeviceRegistrationId","MWPakeQPLEvents","PAKECleanupSessionReasonEnum","PAKEDecryptSecretSprocStatusEnum","PAKEGetActiveSessionSprocStatusEnum","PAKEMessageTypeEnum","PakeCpaceUtils","PakeCpaceWasm","PakeQplLogging","QPLUserFlow","ReQL","clearTimeout","promiseDone","requireDeferred","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("CleanupPakeSession").__setRef("establishPakeHandshakeAsInitiator"),u=r("requireDeferred")("PakeInitiatorSprocCalls").__setRef("establishPakeHandshakeAsInitiator"),c=(e||(e=o("I64"))).of_int32(-1),d=3e3,m="PAKE_INITIATOR_FAILURE";async function p(t){var n=t.clientType,a=t.onGeneralFailure,i=t.onMaxAttemptsReached,l=t.onNoSessionExists,p=t.onSessionExpired,_=t.onSuccessfulSecretDecryption,f=t.onWrongOtc,g=t.otc,h=t.pakeCpaceModule,y=t.storage,C=t.timeout,b=function(){},v=function(){E&&r("clearTimeout")(E)},S=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(S==="")return o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),{pakeClient:null,stopTimeout:v,unsubFromMessagesTable:b};var R=h!=null?h:await o("PakeCpaceWasm").PakeCPaceWasm(),L=R.createCPaceClient(S),E=null,k=null,I=!1,T=o("ReQL").fromTableAscending(y.tables.pake_messages),D=function(){E&&r("clearTimeout")(E),E=r("setTimeout")(function(){a(),b(),s.onReady(function(e){r("promiseDone")(e({cleanupReason:r("PAKECleanupSessionReasonEnum").TIMEOUT,clientType:n,deviceId:S,storage:y}))}),r("FBLogger")("wmi_eb").mustfix("PAKE handshake failed by timeout")},C)},x=function(){k&&r("clearTimeout")(k),k=r("setTimeout")(function(){r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_RETRY_JOIN_SESSION"),I=!0,O()},d)},$=function(t){var e=t.messageType,o=t.sessionId;a(),u.onReady(function(t){r("promiseDone")(t.sendPakeMessage({clientType:n,messageType:e,senderId:S,sessionId:o,storage:y}))})},P=function(a){var t=a.messagePayload,i=a.responderId,l=a.sessionId;if(r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_THREE_START"),t==null){r("FBLogger")("wmi_eb").mustfix("PAKE: When executing step 3 of CPace Handshake messagePayload was null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1});return}if(i==null){r("FBLogger")("wmi_eb").mustfix("PAKE: When executing step 3 of CPace Handshake responderId was null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1});return}var s=o("Base64Utils").toArrayBuffer(t),c;try{var d=R.clientFinalize(L,new Uint8Array(s));c=d.clientKey1}catch(e){throw $({messageType:r("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR,sessionId:l}),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: Error executing CPace step 3")}r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_START"),u.onReady(function(t){r("promiseDone")(t.decryptPakeSecret({clientType:n,encryptionKey:o("PakeCpaceUtils").typedArrayToBuffer(c),sessionId:l,storage:y}),function(a){var i=a[0],s=a[1];switch(v(),(e||(e=o("I64"))).to_int32(s)){case r("PAKEDecryptSecretSprocStatusEnum").SUCCESS:if(i==null)throw o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: decryptedSecret is null despite SPROC success");r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_END"),r("promiseDone")(t.sendPakeMessage({clientType:n,messageType:r("PAKEMessageTypeEnum").PAKE_HANDSHAKE_SUCCESS,senderId:S,sessionId:l,storage:y})),_({decryptedSecret:i,initiatorId:S});break;case r("PAKEDecryptSecretSprocStatusEnum").WRONG_KEYS:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!0}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!0}),f();break;case r("PAKEDecryptSecretSprocStatusEnum").FAILURE:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),$({messageType:r("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:l});break}},function(e){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},string:{exceptionMessage:e}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),$({messageType:r("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:l})})})},N=function(t){var e=t.annotations,n=t.fbLoggerMessage,a=t.isUserError,i=t.messageType,l=t.onFinish,s=t.unsubFromTable;v(),s(),l(),n!=null&&r("FBLogger")("wmi_eb").mustfix(n,i),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:e,errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:a})},M=function(n){var t=n.onPakeStepOneSuccess;b=T.subscribe(function(n,i){if(!(i.operation!=="put"&&i.operation!=="add")){var l=i.value,s=(e||(e=o("I64"))).to_int32(l.messageType);switch(s){case r("PAKEMessageTypeEnum").PAKE_MESSAGE_1:r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_PAKE_MESSAGE_ONE_END"),b(),t();break;case r("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR:case r("PAKEMessageTypeEnum").PREVIOUS_MESSAGE_MISSING_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:s}},fbLoggerMessage:"PAKE: Failed to send PAKE message one due to invalid state",isUserError:!1,messageType:s,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").MESSAGE_SENT_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:s}},fbLoggerMessage:"PAKE: Failed to send PAKE message one",isUserError:!1,messageType:s,onFinish:function(){return a()},unsubFromTable:function(){b()}});default:break}}})},w=function(n){var t=n.sessionId;b=T.subscribe(function(n,l){if(!(l.operation!=="put"&&l.operation!=="add")){var s=l.value,u=(e||(e=o("I64"))).to_int32(s.messageType);switch(u){case r("PAKEMessageTypeEnum").PAKE_MESSAGE_2_AND_SECRET:b(),P({messagePayload:s.messagePayload,responderId:s.responderId,sessionId:t});break;case r("PAKEMessageTypeEnum").MAX_ATTEMPTS_ERROR:return N({annotations:{bool:{isUserError:!0},int:{errorCode:u}},isUserError:!0,messageType:u,onFinish:function(){return i()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").SESSION_EXPIRED_ERROR:return N({annotations:{bool:{isUserError:!0},int:{errorCode:u}},isUserError:!0,messageType:u,onFinish:function(){return p()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").GENERIC_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Something went wrong in the responder device",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").FETCH_SECRETS_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Responder device failed to fetch secrets.",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});case r("PAKEMessageTypeEnum").FLOW_ABANDONED_ERROR:return N({annotations:{bool:{isUserError:!1},int:{errorCode:u}},fbLoggerMessage:"PAKE: Responder device flow was abandoned.",isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}});default:return N({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},fbLoggerMessage:"PAKE: Unexpected Message Type when listening for pake step two success "+u,isUserError:!1,messageType:u,onFinish:function(){return a()},unsubFromTable:function(){b()}})}}})},A=function(i){var t=i.onJoinSessionSuccess;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_GET_ACTIVE_SESSION_START"),u.onReady(function(i){r("promiseDone")(i.joinPakeSession({clientType:n,initiatorId:S,storage:y}),function(n){var i=n[0],s=n[1],u=n[2],d=s!=null?s:c;switch((e||(e=o("I64"))).to_int32(i)){case r("PAKEGetActiveSessionSprocStatusEnum").SUCCESS:if(u==null||d===c){r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, responderId or joinedSessionId were unexpectedly null"),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),a();return}t(u,d),r("QPLUserFlow").addAnnotations(o("MWPakeQPLEvents").pakeInitiatorQplEvent,{string:{session_id:(e||(e=o("I64"))).to_string(d)}});break;case r("PAKEGetActiveSessionSprocStatusEnum").NO_SESSION:if(I===!1){x();return}o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!0},int:{errorCode:r("PAKEMessageTypeEnum").NO_ACTIVE_SESSION}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!0}),l(),v();break;case r("PAKEGetActiveSessionSprocStatusEnum").FAILURE:o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, sproc failed"),a(),v();break}},function(){o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").GENERIC_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfix("PAKE: When joining session, sproc failed"),a(),v()})})},F=function(t){var e=t.responderId,a=t.sessionId,i;r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_ONE_START");try{i=R.clientBegin(L,g,e)}catch(e){throw $({messageType:r("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR,sessionId:a}),o("PakeQplLogging").endPakeQPLFlowFailure({annotations:{bool:{isUserError:!1},int:{errorCode:r("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR}},errorName:m,event:o("MWPakeQPLEvents").pakeInitiatorQplEvent,isUserError:!1}),r("FBLogger")("wmi_eb").mustfixThrow("PAKE: Error executing CPace step 1")}r("QPLUserFlow").addPoint(o("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_MESSAGE_ONE_START"),u.onReady(function(e){e.sendPakeMessageOne({clientType:n,initiatorId:S,messagePayload:o("PakeCpaceUtils").typedArrayToBuffer(i),sessionId:a,storage:y})}),M({onPakeStepOneSuccess:function(){w({sessionId:a})}})},O=function(){return D(),o("PakeQplLogging").startPakeQPLFlow(o("MWPakeQPLEvents").pakeInitiatorQplEvent),A({onJoinSessionSuccess:function(t,n){F({responderId:t,sessionId:n})}}),{pakeClient:L,stopTimeout:v,unsubFromMessagesTable:b}};return O()}l.default=p}),98);
__d("mwEBSetBackupState",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.setBackupState,n=e.state;switch(n){case 1:break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case-1:t(-1);break;case 0:break}}i.default=e}),66);
__d("mwEBUpdateBackupsTable",["LSFactory","LSUpdateBackupsTableStoredProcedure","LSVec"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.backupIds,n=e.deviceIds,o=e.encryptionManagementDelegatorId,a=e.hasOtcEligibleDevices,l=e.isSuccess,s=e.isUserOptedOut,u=e.storage,c=e.virtualDevices;return u.runInTransaction(function(e){return r("LSUpdateBackupsTableStoredProcedure")(r("LSFactory")(e),{backupIds:t,backupMetadata:r("LSVec").ofArray([]),deviceIds:n,encryptionManagementDelegatorId:o,hasOtcEligibleDevices:a,isSuccess:l,isUserOptedOut:s,virtualDevices:c})},"readwrite",void 0,void 0,i.id+":48")}l.default=e}),98);
__d("mwProcessBackupIds",["I64","LSAuthorityLevel","LSIntEnum","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","QPLEvent","QPLUserFlow","WebSession"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c="-1";function d(e){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,"EB_STATE_"+e+"."),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent})}function m(t){var n=t.clientStateData,a=t.encryptedBackupData,i=a==null?void 0:a.backupId;return i==null?(d("NO_BACKUPS_PRESENT"),2):(e||(e=o("I64"))).to_string(i)===c?(o("MWChatEncryptedBackupsLogging").endFailure({errorName:"FETCH_ERROR",event:o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent}),-1):n==null||!(e||(e=o("I64"))).equal(n.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))?(d("DEVICE_NOT_ONBOARDED"),4):(e||(e=o("I64"))).equal(n.backupId,i)?(d("DEVICE_ONBOARDED"),3):(d("DEVICE_NOT_ONBOARDED_BACKUP_ID_MISMATCH"),4)}function p(t){var n=t.clientStateData,a=t.encryptedBackupData;if(a==null)return 0;var i=o("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();return r("QPLUserFlow").getActiveFlowIDs().includes((u||(u=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent))||r("QPLUserFlow").start(o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:i,processBackupIdsVersion:"JS",sessionTabId:o("WebSession").getId()}}}),(e||(e=o("I64"))).equal(a.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").OPTIMISTIC))?(d("FETCH_IN_PROGRESS"),1):(e||(e=o("I64"))).equal(a.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))?m({clientStateData:n,encryptedBackupData:a}):(o("MWChatEncryptedBackupsLogging").endFailure({errorName:"FETCH_ERROR_WRONG_AUTHORITY_LEVEL",event:o("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent}),-1)}l.default=p}),98);
__d("useMWChatDisplayEncryptedBackupsRestoreToast",["I64","LSEncryptedBackupsClientRestoreState","LSIntEnum","ReQL","ReQLSuspense","react","react-compiler-runtime","useMAWEncryptedBackupsRestoreToast","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=d.useEffect,p=d.useState;function _(){var t=o("react-compiler-runtime").c(10),n=(e||(e=r("useReStore")))(),a;t[0]!==n.tables.encrypted_backups_client_restore_status?(a=function(){return o("ReQL").fromTableAscending(n.tables.encrypted_backups_client_restore_status)},t[0]=n.tables.encrypted_backups_client_restore_status,t[1]=a):a=t[1];var l;t[2]!==n?(l=[n],t[2]=n,t[3]=l):l=t[3];var s=o("ReQLSuspense").useArray(a,l,i.id+":27"),u=r("useMAWEncryptedBackupsRestoreToast")(),c=u.showInProgressToast,d=u.showSuccessToast,_=p(!1),g=_[0],h=_[1],y,C;t[4]!==g||t[5]!==s||t[6]!==c||t[7]!==d?(y=function(){var e=s.some(f);g&&!e?(h(!1),d()):!g&&e&&(h(!0),c())},C=[g,s,c,d],t[4]=g,t[5]=s,t[6]=c,t[7]=d,t[8]=y,t[9]=C):(y=t[8],C=t[9]),m(y,C)}function f(e){var t=e.restoreStatus;return t!=null&&(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsClientRestoreState").RESTORE_IN_PROGRESS))}l.default=_}),98);
__d("useMWChatEncryptedBackupsAutoRestoreEffect",["EBSMGatingUI","MWChatEncryptedBackupsAddDeviceWithEBKeys","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBODSEntityName.enum","MWEBUseLocalStorage","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsInitializeRestoreDeferred","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsSharedState","ReQL","ReQLSuspense","WALogger","gkx","promiseDone","react","react-compiler-runtime","useLabyrinthLogging","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=d.useEffect,p=d.useRef;function _(t){var n=o("react-compiler-runtime").c(13),a=t.backupState,l=t.clientData,s=t.epochData,c=t.isSubscribedToData,d=t.setIsSubscribedToData,_=r("MWChatEncryptedBackupsQPLSource.enum").AUTO_RESTORE,g=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),h=g.startFlow,y=p(!1),C=(u||(u=r("useReStore")))(),b,v;n[0]!==c||n[1]!==C?(b=function(){return c?o("ReQL").fromTableAscending(C.tables.experiences_shared_state):o("ReQL").empty()},v=[c,C],n[0]=c,n[1]=C,n[2]=b,n[3]=v):(b=n[2],v=n[3]);var S=o("ReQLSuspense").useArray(b,v,i.id+":68"),R,L;n[4]!==a||n[5]!==l||n[6]!==s||n[7]!==d||n[8]!==S||n[9]!==h||n[10]!==C?(R=function(){if(!(y.current||a===1||a===0)){if(a===3){var t=l==null?void 0:l.deviceId,n=o("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:C,sharedStateTable:S,stateKey:"auto_restored"}),i=o("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:C,sharedStateTable:S,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}),u=o("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:C,sharedStateTable:S,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_ONBOARDED_SUCCESSFULLY}),c=n||i||u,m=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(!c&&m!==""&&l!=null&&s!=null&&t!=null){o("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT),h({additionalAnnotations:{device_type:"auto_restore"},event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH,source:_});var p=o("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();if(h({additionalAnnotations:{eb_session_identifier:p,restore_upsell_first_impression_time:p},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:_}),r("gkx")("10572"))o("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:C,onFailure:f,onSuccess:function(){r("promiseDone")(o("MWEncryptedBackupsSharedState").upsertEBSharedStateEntry({db:C,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY})),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM(),without_add_device:!0},string:{restore_type:"auto_restore"}},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wmi][eb] initialize auto-restore success"])))}});else{var g={backupId:l.backupId,db:C,newDeviceRegistrationId:m,previousDeviceId:t};o("MWChatEncryptedBackupsAddDeviceWithEBKeys").addDeviceWithEBKeys(g)}}}y.current=!0,d(!1)}},L=[a,l,s,S,_,h,C,d],n[4]=a,n[5]=l,n[6]=s,n[7]=d,n[8]=S,n[9]=h,n[10]=C,n[11]=R,n[12]=L):(R=n[11],L=n[12]),m(R,L)}function f(){o("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM(),without_add_device:!0}},errorName:"FAILED_TO_RESTORE_ENCRYPTED_BACKUP",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},errorName:"FAILED_TO_RESTORE_ENCRYPTED_BACKUP",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wmi][eb] initialize auto-restore failed"])))}l.default=_}),98);
__d("useMWChatEncryptedBackupsAutoRestore",["I64","LSAuthorityLevel","LSIntEnum","MWEBEntrypointsKillswitch.enum","ReQL","ReQLSuspense","react","react-compiler-runtime","useMWChatEncryptedBackupsAutoRestoreEffect","useMWEBBackupState","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(c||(c=o("react"))).useState;function m(){var t=o("react-compiler-runtime").c(14),n=d(!0),a=n[0],l=n[1],s=(e||(e=r("useReStore")))(),u,c;t[0]!==a||t[1]!==s?(u=function(){return a?o("ReQL").fromTableAscending(s.tables.secure_encrypted_backups_epochs):o("ReQL").empty()},c=[a,s],t[0]=a,t[1]=s,t[2]=u,t[3]=c):(u=t[2],c=t[3]);var m=o("ReQLSuspense").useFirst(u,c,i.id+":27"),_,f;t[4]!==a||t[5]!==s?(_=function(){return a?o("ReQL").fromTableAscending(s.tables.secure_encrypted_backups_client_state).filter(p):o("ReQL").empty()},f=[a,s],t[4]=a,t[5]=s,t[6]=_,t[7]=f):(_=t[6],f=t[7]);var g=o("ReQLSuspense").useFirst(_,f,i.id+":34"),h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h={entrypoint:r("MWEBEntrypointsKillswitch.enum").AUTO_RESTORE},t[8]=h):h=t[8];var y=r("useMWEBBackupState")(h),C;t[9]!==y||t[10]!==g||t[11]!==m||t[12]!==a?(C={backupState:y,clientData:g,epochData:m,isSubscribedToData:a,setIsSubscribedToData:l},t[9]=y,t[10]=g,t[11]=m,t[12]=a,t[13]=C):C=t[13],r("useMWChatEncryptedBackupsAutoRestoreEffect")(C)}function p(e){var t=e.authorityLevel;return(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))}l.default=m}),98);
__d("useMWEBListenForChangesToBackupStateXDevice",["I64","ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=c.useEffect,m=c.useRef;function p(t){var n=o("react-compiler-runtime").c(8),a=(e||(e=r("useReStore")))(),l;n[0]!==a.tables.encrypted_backups_status_trigger?(l=function(){return o("ReQL").fromTableAscending(a.tables.encrypted_backups_status_trigger)},n[0]=a.tables.encrypted_backups_status_trigger,n[1]=l):l=n[1];var u;n[2]!==a?(u=[a],n[2]=a,n[3]=u):u=n[3];var c=o("ReQLSuspense").useFirst(l,u,i.id+":27"),p=m(null),_,f;n[4]!==c||n[5]!==t?(_=function(){c!=null&&p.current!==c.pk&&!(s||(s=o("I64"))).equal(c.pk,(s||(s=o("I64"))).of_float(0))&&(p.current=c.pk,t())},f=[c,t],n[4]=c,n[5]=t,n[6]=_,n[7]=f):(_=n[6],f=n[7]),d(_,f)}l.default=p}),98);
__d("useMWEBPropagateEbStateChangesThroughRelay",["CometRelay","MWEBPropagateEbStateUtils","ReQL","ReQLSuspense","react-compiler-runtime","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=o("react-compiler-runtime").c(8),a=t.listenForChangesToBackupState,l=t.onStateChange,s=(e||(e=r("useReStore")))(),u=o("CometRelay").useRelayEnvironment(),c,d;n[0]!==s||n[1]!==a?(c=function(){return a?o("ReQL").fromTableAscending(s.tables.encrypted_backups):o("ReQL").empty()},d=[s,a],n[0]=s,n[1]=a,n[2]=c,n[3]=d):(c=n[2],d=n[3]);var m=o("ReQLSuspense").useFirst(c,d,i.id+":36"),p,_;n[4]!==s||n[5]!==a?(p=function(){return a?o("ReQL").fromTableAscending(s.tables.secure_encrypted_backups_client_state):o("ReQL").empty()},_=[s,a],n[4]=s,n[5]=a,n[6]=p,n[7]=_):(p=n[6],_=n[7]);var f=o("ReQLSuspense").useFirst(p,_,i.id+":43"),g=o("MWEBPropagateEbStateUtils").useBackupStateUpdate(u,l),h=o("MWEBPropagateEbStateUtils").useHasArmadilloError();o("MWEBPropagateEbStateUtils").useEbStatePropagationEffect(m,f,u,h,g)}l.default=s}),98);
__d("useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25220416984279164"}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2Query.graphql",["useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEncryptedBackupsFetchBackupIdsV2Query",selections:[{args:null,kind:"FragmentSpread",name:"EBFetchBackupIdsSharedFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEncryptedBackupsFetchBackupIdsV2Query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[e],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null},e],storageKey:null}]},params:{id:n("useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation"),metadata:{},name:"useMWEncryptedBackupsFetchBackupIdsV2Query",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2",["CometRelay","EBFetchBackupIdsShared","EBSMAPI","MAWWaitForBackendSetup","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsProcessBackupDataUtils","ODS","QPLEvent","QPLUserFlow","WebSession","promiseDone","react","react-compiler-runtime","useAsyncReStore","useMWEBListenForChangesToBackupStateXDevice","useMWEBPropagateEbStateChangesThroughRelay","useMWEncryptedBackupsFetchBackupIdsV2Query.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=s||(s=o("react")),m=d.useEffect,p=d.useRef,_=d.useState;function f(e){var t=o("react-compiler-runtime").c(10),n=r("useAsyncReStore")(),a=p(!0),i=p(!1),l=_(!1),s=l[0],d=l[1],f=o("CometRelay").useRefetchableFragment(o("EBFetchBackupIdsShared").fetchBackupIdsRefetchableFragment,e),g=f[0],h=f[1],y;t[0]!==g||t[1]!==h?(y=function(){(u||(u=o("ODS"))).bumpEntityKey(7319,"useMWEncryptedBackupsFetchBackupIdsV2.destination","mainthread.gql.refetch.mainthread");var e=o("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();r("QPLUserFlow").getActiveFlowIDs().includes((c||(c=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))||r("QPLUserFlow").start(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:e,fetchBackupIdsVersion:"GQL",sessionTabId:o("WebSession").getId()}}}),h({},{fetchPolicy:"network-only",onComplete:function(t){if(i.current=!1,r("QPLUserFlow").getActiveFlowIDs().includes((c||(c=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent)))if(t!=null)o("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{error:t.message,error_stack:t.stack}},errorName:"fetch_backup_ids_error",event:o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent});else{var e,n,a;o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{isUserOptedOut:(e=g.xfb_backup)==null?void 0:e.is_user_opted_out},string:{backup_id:(n=(a=g.xfb_backup)==null?void 0:a.id)!=null?n:"null"}},event:o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent})}}})},t[0]=g,t[1]=h,t[2]=y):y=t[2];var C=y;r("useMWEBListenForChangesToBackupStateXDevice")(C);var b;t[3]!==s||t[4]!==C?(b={listenForChangesToBackupState:s,onStateChange:C},t[3]=s,t[4]=C,t[5]=b):b=t[5],r("useMWEBPropagateEbStateChangesThroughRelay")(b);var v,S;t[6]!==g||t[7]!==n?(v=function(){i.current!==!0&&(i.current=!0,o("MAWWaitForBackendSetup").isBackendSetupSuccessful()?((u||(u=o("ODS"))).bumpEntityKey(7319,"useMWEncryptedBackupsFetchBackupIdsV2.destination","worker"),r("promiseDone")(r("EBSMAPI").fetchBackupIds("useMWEncryptedBackupsFetchBackupIdsV2").then(function(){d(!0),g.xfb_backup!=null&&g.xfb_backup.id!=null&&a.current===!0&&(a.current=!1)}))):((u||(u=o("ODS"))).bumpEntityKey(7319,"useMWEncryptedBackupsFetchBackupIdsV2.destination","mainthread.gql.isBackendSetupSuccessful="+o("MAWWaitForBackendSetup").isBackendSetupSuccessful().toString()),o("MWEncryptedBackupsProcessBackupDataUtils").processBackupData({data:g,dbPromise:n,isInitalLoad:a,setListenForChangesToBackupState:d})))},S=[g,n],t[6]=g,t[7]=n,t[8]=v,t[9]=S):(v=t[8],S=t[9]),m(v,S)}function g(){var t=o("CometRelay").useLazyLoadQuery(e!==void 0?e:e=n("useMWEncryptedBackupsFetchBackupIdsV2Query.graphql"),{},{fetchPolicy:"network-only"});f(t)}l.default=g}),98);