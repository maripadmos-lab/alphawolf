;/*FB_PKG_DELIM*/

__d("EncryptedBackupUploadFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("5728"),s=o("FalcoLoggerInternal").create("encrypted_backup_upload_failure",e),u=s;l.default=u}),98);
__d("LSDataTraceFlush",["ArmadilloDataTraceType","I64","LSDataTraceType","LSIntEnum","ODS","ReQL","clearTimeout","gkx","promiseDone","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(e||(e=o("I64"))).of_string("120000"),d=e.of_string("600000"),m=new Set(["encrypted_backups_upload","encrypted_backups_media_backup"]);function p(t,n,r){var a=t.length;if(a===0)return[(e||(e=o("I64"))).neg_one,e.neg_one,void 0,void 0,void 0];var i=t.find(function(e){return e.errorMessage!=null}),l=i==null?void 0:i.errorMessage,s=t[t.length-1|0],u=(e||(e=o("I64"))).of_float(Date.now()),d=s.timestampMs,m=e.compare(e.sub(u,r),c)>=0;return!n&&m?[(e||(e=o("I64"))).sub(u,r),s.checkPointId,d,l,"trace expired"]:[e.sub(d,r),s.checkPointId,d,l,l]}function _(t){return t.reduce(function(t,n,r){var a,i=(e||(e=o("I64"))).to_string(n.checkPointId),l=n.timestampMs,s=e.to_string((a=n.syncChannel)!=null?a:(e||(e=o("I64"))).neg_one),u=n.tags,c=u!=null?","+u:"";if(r===0)t.pointsList="".concat("(",i,",",s,c,")");else{var d=String((e||(e=o("I64"))).to_int32(e.sub(l,t.lastCheckPointTimestamp)));t.pointsList=t.pointsList.concat("-",d,"-(",i,",",s,c,")")}return t.lastCheckPointTimestamp=l,t},{lastCheckPointTimestamp:(e||(e=o("I64"))).zero,pointsList:""}).pointsList}var f=e.of_string("2");function g(t){var n=t.traceType,a=(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").TASK))?"send":(e||(e=o("I64"))).equal(n,o("ArmadilloDataTraceType").armadilloMessageSend)?"armadillo send":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD))?"encrypted_backups_upload":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE))?"encrypted_backups_restore":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_MEDIA_BACKUP))?"encrypted_backups_media_backup":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").SAP_VESTA_LOGIN))?"sap_vesta_login":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").SAP_VESTA_REGISTRATION))?"sap_vesta_registration":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_MEDIA_RESTORE))?"encrypted_backups_media_restore":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_INIT))?"shadow_encrypted_backups_init":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_ADD_DEVICE))?"shadow_encrypted_backups_add_device":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_UPLOAD))?"shadow_encrypted_backups_upload":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_RESTORE))?"shadow_encrypted_backups_restore":(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_DELETE_BACKUP))?"shadow_encrypted_backups_delete_backup":t.contextTwo;return a}function h(t,n){var r=n.traceId,a=n.shouldFlush,i=g(n),l=n.traceType,s=(e||(e=o("I64"))).equal(l,o("ArmadilloDataTraceType").armadilloMessageSend)?"tam_message_send":n.contextOne,u=(e||(e=o("I64"))).equal(n.traceType,f)?void 0:n.predefinedId,c=n.initTimestampMs;return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.data_trace_addon.index("traceIdAddonId")).getKeyRange(r)).then(function(e){var t=p(e,a,c),n=t[0],r=t[1],o=t[3],i=t[4],l=e.length,s=_(e)}).then(function(){return t.data_trace_meta.delete(r)})}function y(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.data_trace_meta).getKeyRange(t)).then(function(t){return t!=null?h(e,t):Promise.resolve()})}var C={contents:void 0};function b(t){return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.data_trace_meta.index("shouldFlushInitTimestampMsTraceId")).getKeyRange(!1).bounds({lt:o("ReQL").key((e||(e=o("I64"))).sub(e.of_float(Date.now()),c))})).then(function(t){if(r("gkx")("23914")){var n=(e||(e=o("I64"))).of_float(Date.now());return t.filter(function(t){var r=g(t);if(r!=null&&m.has(r)){var a=(e||(e=o("I64"))).compare(e.sub(n,t.initTimestampMs),d)>=0;return a}return!0})}return t})}async function v(e){var t=await b(e.tables);if(t.length!==0)return e.runInTransaction(function(e){return b(e).then(function(t){return Promise.all(t.map(function(t){return h(e,t)}))})},"readwrite",void 0,void 0,i.id+":287")}function S(){var e=C.contents;if(e!=null){r("clearTimeout")(e);return}}function R(e){return r("promiseDone")(v(e),function(){S();var t=r("setTimeout")(function(){R(e)},6e4);C.contents=t},function(){S(),(u||(u=o("ODS"))).bumpEntityKey(3185,"mw_trace","error")}),S}var L=y,E=R,k={flush:L,flushExpiredDataTraces:E};l.default=k}),98);
__d("XPlatReactVoprf.shared",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.VoprfWasmError=e}),66);
__d("mapVoprfWasmError",["XPlatReactVoprf.shared"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){switch(e){case-1:return new u;case 1:return new c;case 2:return new d;case 3:return new m;case 4:return new p;default:return new _}}var u=(function(e){function t(t){var n;return t===void 0&&(t="Unknown error encountered by VOPRF WASM"),n=e.call(this,t)||this,n.name="VoprfUnknownError",n}return babelHelpers.inheritsLoose(t,e),t})((e=o("XPlatReactVoprf.shared")).VoprfWasmError),c=(function(e){function t(t){var n;return t===void 0&&(t="Incorrect buffer length encountered by VOPRF WASM"),n=e.call(this,t)||this,n.name="VoprfBufferLengthError",n}return babelHelpers.inheritsLoose(t,e),t})(e.VoprfWasmError),d=(function(e){function t(t){var n;return t===void 0&&(t="Error while performing curve operation by VOPRF WASM"),n=e.call(this,t)||this,n.name="VoprfCurveOperationError",n}return babelHelpers.inheritsLoose(t,e),t})(e.VoprfWasmError),m=(function(e){function t(t){var n;return t===void 0&&(t="Error while performing hash operation by VOPRF WASM"),n=e.call(this,t)||this,n.name="VoprfHashOperationError",n}return babelHelpers.inheritsLoose(t,e),t})(e.VoprfWasmError),p=(function(e){function t(t){var n;return t===void 0&&(t="Error while performing proof operation by VOPRF WASM"),n=e.call(this,t)||this,n.name="VoprfProofError",n}return babelHelpers.inheritsLoose(t,e),t})(e.VoprfWasmError),_=(function(e){function t(t){var n;return t===void 0&&(t="Unknown error code received from WASM binary"),n=e.call(this,t)||this,n.name="UnknownErrorCode",n}return babelHelpers.inheritsLoose(t,e),t})(e.VoprfWasmError);l.mapVoprfWasmError=s,l.VoprfUnknownError=u,l.VoprfBufferLengthError=c,l.VoprfCurveOperationError=d,l.VoprfHashOperationError=m,l.VoprfProofError=p,l.UnknownErrorCode=_}),98);
__d("LSVoprfWasmBuilder",["FBLogger","err","getErrorSafe","mapVoprfWasmError"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return function(t){var n=t.locateFile!=null?{locateFile:t.locateFile}:{instantiateWasm:async function(n,o){try{var e=await t.getWasmModule(),a=await WebAssembly.instantiate(e,n);return o(a),{}}catch(e){var i=r("getErrorSafe")(e);return r("FBLogger")("LSVoprfWasmBuilder").mustfix("instantiateWasm failed with error: %s",i.toString()),!1}}};return s(n,e)}}function s(e,t){return new Promise(function(n,a){t(e).then(function(e){var t,i=e._sodiumInit();i!==0&&a(r("err")("Failed to initialize Sodium!")),n({createCurveRistretto:function(){var t;try{return t=e._curve_create(),e._curve_init_ristretto(t),t}catch(n){throw t!=null&&e._curve_free(t),n}},freeCurve:function(n){e._curve_free(n)},createVoprfExpTwohashdh:function(n){var t;try{return t=e._voprf_create(),e._voprf_init_exp_twohashdh(t,n),t}catch(n){throw t!=null&&e._voprf_free(t),n}},freeVoprf:function(n){e._voprf_free(n)},getCurveBytes:function(n){return e._get_curve_element_bytes(n.curvePtr)},getCurveScalarBytes:function(n){return e._get_curve_scalar_bytes(n.curvePtr)},blind:function(n,r){var t,a,i;try{var l=e._get_curve_element_bytes(n.curvePtr),s=e._get_curve_scalar_bytes(n.curvePtr);t=e._malloc(l),a=e._malloc(s),i=c(e,r);var d=e._blind(n.voprfPtr,t,l,a,s,i,r.length);if(d!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(d);var m=u(e,t,l),p=u(e,a,s);return{blindedElement:m,blindingFactor:p}}finally{[t,a,i].forEach(function(t){t!=null&&e._free(t)})}},verifiableUnblind:function(n,r,a,i,l,s,d,m){var t,p,_,f,g,h,y;try{t=r?c(e,r):null,p=a?c(e,a):null,_=c(e,s),f=c(e,i),g=c(e,l),h=c(e,d);var C=e._get_curve_element_bytes(n.curvePtr);y=e._malloc(C);var b=e._verifiable_unblind(n.voprfPtr,y,C,t,r?r.length:0,p,a?a.length:0,f,i.length,g,l.length,_,s.length,h,d.length,+m);if(b!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(b);var v=u(e,y,C);return{unblindedElement:v}}finally{[t,p,_,f,g,h,y].forEach(function(t){t!=null&&e._free(t)})}},clientFinalize:function(n,r,a){var t,i,l;try{t=c(e,r),i=c(e,a);var s=e._get_voprf_final_evaluation_bytes(n.voprfPtr);l=e._malloc(s);var d=e._voprf_client_finalize(n.voprfPtr,l,s,t,r.length,i,a.length);if(d!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(d);var m=u(e,l,s);return{finalEvaluation:m}}finally{[t,i,l].forEach(function(t){t!=null&&e._free(t)})}},setup:function(n){var t,r;try{var a=e._get_curve_scalar_bytes(n.curvePtr),i=e._get_curve_element_bytes(n.curvePtr);t=e._malloc(a),r=e._malloc(i);var l=e._voprf_setup(n.voprfPtr,r,i,t,a);if(l!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(l);var s=u(e,r,i),c=u(e,t,a);return{sk:s,pk:c}}finally{[t,r].forEach(function(t){t!=null&&e._free(t)})}},evaluate:function(n,r,a,i){var t,l,s,d,m;try{var p=e._get_curve_element_bytes(n.curvePtr);t=e._malloc(p);var _=i?e._get_curve_scalar_bytes(n.curvePtr):0;l=_>0?e._malloc(_):null;var f=i?e._get_curve_scalar_bytes(n.curvePtr):0;s=f>0?e._malloc(f):null,d=c(e,a),m=c(e,r);var g=e._voprf_evaluate(n.voprfPtr,t,p,l,_,s,f,m,r.length,d,a.length,+i);if(g!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(g);var h=l!==null?u(e,l,_):null,y=s!==null?u(e,s,f):null,C=u(e,t,p);return{proofC:h,proofS:y,evaluatedElement:C}}finally{[t,l,s,d,m].forEach(function(t){t!=null&&e._free(t)})}},serverFinalize:function(n,r,a){var t,i,l;try{t=c(e,r),i=c(e,a);var s=e._get_voprf_final_evaluation_bytes(n.voprfPtr);l=e._malloc(s);var d=e._voprf_server_finalize(n.voprfPtr,l,s,t,r.length,i,a.length);if(d!==0)throw o("mapVoprfWasmError").mapVoprfWasmError(d);var m=u(e,l,s);return{finalEvaluation:m}}finally{[t,i,l].forEach(function(t){t!=null&&e._free(t)})}},wasmMemory:(t=e.wasmMemory)!=null?t:void 0})}).catch(function(e){throw r("err")("Failed to initialize wasm module, "+e)})})}function u(e,t,n){for(var r=new Uint8Array(n),o=0;o<n;++o)r[o]=e.getValue(o+t,"i8");return r}function c(e,t){var n=t.length,r=e._malloc(n);return e.writeArrayToMemory(t,r),r}l.default=e}),98);
__d("LSVoprfWasm",["LSVoprfWasmBuilder","bx","ls_voprf_utils_v2"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("30933")),s=function(){return e},u=r("LSVoprfWasmBuilder")(r("ls_voprf_utils_v2"));l.locateFile=s,l.LSVoprfWasm=u}),98);